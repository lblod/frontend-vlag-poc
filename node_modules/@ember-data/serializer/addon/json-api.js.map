{"version":3,"file":"json-api.js","sources":["../src/json-api.js"],"sourcesContent":["/**\n * @module @ember-data/serializer/json-api\n */\nimport { assert, warn } from '@ember/debug';\nimport { dasherize } from '@ember/string';\n\nimport { pluralize, singularize } from 'ember-inflector';\n\nimport { DEBUG } from '@ember-data/env';\n\nimport JSONSerializer from './json';\n\n/**\n * <blockquote style=\"margin: 1em; padding: .1em 1em .1em 1em; border-left: solid 1em #E34C32; background: #e0e0e0;\">\n  <p>\n    ⚠️ <strong>This is LEGACY documentation</strong> for a feature that is no longer encouraged to be used.\n    If starting a new app or thinking of implementing a new adapter, consider writing a\n    <a href=\"/ember-data/release/classes/%3CInterface%3E%20Handler\">Handler</a> instead to be used with the <a href=\"https://github.com/emberjs/data/tree/main/packages/request#readme\">RequestManager</a>\n  </p>\n  </blockquote>\n\n  In EmberData a Serializer is used to serialize and deserialize\n  records when they are transferred in and out of an external source.\n  This process involves normalizing property names, transforming\n  attribute values and serializing relationships.\n\n  `JSONAPISerializer` supports the http://jsonapi.org/ spec and is the\n  serializer recommended by Ember Data.\n\n  This serializer normalizes a JSON API payload that looks like:\n\n  ```app/models/player.js\n  import Model, { attr, belongsTo } from '@ember-data/model';\n\n  export default class Player extends Model {\n    @attr('string') name;\n    @attr('string') skill;\n    @attr('number') gamesPlayed;\n    @belongsTo('club') club;\n  }\n  ```\n\n  ```app/models/club.js\n  import Model, { attr, hasMany } from '@ember-data/model';\n\n  export default class Club extends Model {\n    @attr('string') name;\n    @attr('string') location;\n    @hasMany('player') players;\n  }\n  ```\n\n  ```js\n    {\n      \"data\": [\n        {\n          \"attributes\": {\n            \"name\": \"Benfica\",\n            \"location\": \"Portugal\"\n          },\n          \"id\": \"1\",\n          \"relationships\": {\n            \"players\": {\n              \"data\": [\n                {\n                  \"id\": \"3\",\n                  \"type\": \"players\"\n                }\n              ]\n            }\n          },\n          \"type\": \"clubs\"\n        }\n      ],\n      \"included\": [\n        {\n          \"attributes\": {\n            \"name\": \"Eusebio Silva Ferreira\",\n            \"skill\": \"Rocket shot\",\n            \"games-played\": 431\n          },\n          \"id\": \"3\",\n          \"relationships\": {\n            \"club\": {\n              \"data\": {\n                \"id\": \"1\",\n                \"type\": \"clubs\"\n              }\n            }\n          },\n          \"type\": \"players\"\n        }\n      ]\n    }\n  ```\n\n  to the format that the Ember Data store expects.\n\n  ### Customizing meta\n\n  Since a JSON API Document can have meta defined in multiple locations you can\n  use the specific serializer hooks if you need to customize the meta.\n\n  One scenario would be to camelCase the meta keys of your payload. The example\n  below shows how this could be done using `normalizeArrayResponse` and\n  `extractRelationship`.\n\n  ```app/serializers/application.js\n  import JSONAPISerializer from '@ember-data/serializer/json-api';\n\n  export default class ApplicationSerializer extends JSONAPISerializer {\n    normalizeArrayResponse(store, primaryModelClass, payload, id, requestType) {\n      let normalizedDocument = super.normalizeArrayResponse(...arguments);\n\n      // Customize document meta\n      normalizedDocument.meta = camelCaseKeys(normalizedDocument.meta);\n\n      return normalizedDocument;\n    }\n\n    extractRelationship(relationshipHash) {\n      let normalizedRelationship = super.extractRelationship(...arguments);\n\n      // Customize relationship meta\n      normalizedRelationship.meta = camelCaseKeys(normalizedRelationship.meta);\n\n      return normalizedRelationship;\n    }\n  }\n  ```\n\n  @main @ember-data/serializer/json-api\n  @since 1.13.0\n  @class JSONAPISerializer\n  @public\n  @extends JSONSerializer\n*/\nconst JSONAPISerializer = JSONSerializer.extend({\n  /**\n    @method _normalizeDocumentHelper\n    @param {Object} documentHash\n    @return {Object}\n    @private\n  */\n  _normalizeDocumentHelper(documentHash) {\n    if (Array.isArray(documentHash.data)) {\n      let ret = new Array(documentHash.data.length);\n\n      for (let i = 0; i < documentHash.data.length; i++) {\n        let data = documentHash.data[i];\n        ret[i] = this._normalizeResourceHelper(data);\n      }\n\n      documentHash.data = ret;\n    } else if (documentHash.data && typeof documentHash.data === 'object') {\n      documentHash.data = this._normalizeResourceHelper(documentHash.data);\n    }\n\n    if (Array.isArray(documentHash.included)) {\n      let ret = new Array();\n      for (let i = 0; i < documentHash.included.length; i++) {\n        let included = documentHash.included[i];\n        let normalized = this._normalizeResourceHelper(included);\n        if (normalized !== null) {\n          // can be null when unknown type is encountered\n          ret.push(normalized);\n        }\n      }\n\n      documentHash.included = ret;\n    }\n\n    return documentHash;\n  },\n\n  /**\n    @method _normalizeRelationshipDataHelper\n    @param {Object} relationshipDataHash\n    @return {Object}\n    @private\n  */\n  _normalizeRelationshipDataHelper(relationshipDataHash) {\n    relationshipDataHash.type = this.modelNameFromPayloadKey(relationshipDataHash.type);\n\n    return relationshipDataHash;\n  },\n\n  /**\n    @method _normalizeResourceHelper\n    @param {Object} resourceHash\n    @return {Object}\n    @private\n  */\n  _normalizeResourceHelper(resourceHash) {\n    assert(this.warnMessageForUndefinedType(), resourceHash.type);\n\n    let modelName, usedLookup;\n\n    modelName = this.modelNameFromPayloadKey(resourceHash.type);\n    usedLookup = 'modelNameFromPayloadKey';\n\n    if (!this.store.getSchemaDefinitionService().doesTypeExist(modelName)) {\n      warn(this.warnMessageNoModelForType(modelName, resourceHash.type, usedLookup), false, {\n        id: 'ds.serializer.model-for-type-missing',\n      });\n      return null;\n    }\n\n    let modelClass = this.store.modelFor(modelName);\n    let serializer = this.store.serializerFor(modelName);\n    let { data } = serializer.normalize(modelClass, resourceHash);\n    return data;\n  },\n\n  /**\n    Normalize some data and push it into the store.\n\n    @method pushPayload\n    @public\n    @param {Store} store\n    @param {Object} payload\n  */\n  pushPayload(store, payload) {\n    let normalizedPayload = this._normalizeDocumentHelper(payload);\n    store.push(normalizedPayload);\n  },\n\n  /**\n    @method _normalizeResponse\n    @param {Store} store\n    @param {Model} primaryModelClass\n    @param {Object} payload\n    @param {String|Number} id\n    @param {String} requestType\n    @param {Boolean} isSingle\n    @return {Object} JSON-API Document\n    @private\n  */\n  _normalizeResponse(store, primaryModelClass, payload, id, requestType, isSingle) {\n    let normalizedPayload = this._normalizeDocumentHelper(payload);\n    return normalizedPayload;\n  },\n\n  normalizeQueryRecordResponse() {\n    let normalized = this._super(...arguments);\n\n    assert(\n      'Expected the primary data returned by the serializer for a `queryRecord` response to be a single object but instead it was an array.',\n      !Array.isArray(normalized.data)\n    );\n\n    return normalized;\n  },\n\n  extractAttributes(modelClass, resourceHash) {\n    let attributes = {};\n\n    if (resourceHash.attributes) {\n      modelClass.eachAttribute((key) => {\n        let attributeKey = this.keyForAttribute(key, 'deserialize');\n        if (resourceHash.attributes[attributeKey] !== undefined) {\n          attributes[key] = resourceHash.attributes[attributeKey];\n        }\n        if (DEBUG) {\n          if (resourceHash.attributes[attributeKey] === undefined && resourceHash.attributes[key] !== undefined) {\n            assert(\n              `Your payload for '${modelClass.modelName}' contains '${key}', but your serializer is setup to look for '${attributeKey}'. This is most likely because Ember Data's JSON API serializer dasherizes attribute keys by default. You should subclass JSONAPISerializer and implement 'keyForAttribute(key) { return key; }' to prevent Ember Data from customizing your attribute keys.`,\n              false\n            );\n          }\n        }\n      });\n    }\n\n    return attributes;\n  },\n\n  /**\n     Returns a relationship formatted as a JSON-API \"relationship object\".\n\n     http://jsonapi.org/format/#document-resource-object-relationships\n\n     @method extractRelationship\n    @public\n     @param {Object} relationshipHash\n     @return {Object}\n  */\n  extractRelationship(relationshipHash) {\n    if (Array.isArray(relationshipHash.data)) {\n      let ret = new Array(relationshipHash.data.length);\n\n      for (let i = 0; i < relationshipHash.data.length; i++) {\n        let data = relationshipHash.data[i];\n        ret[i] = this._normalizeRelationshipDataHelper(data);\n      }\n\n      relationshipHash.data = ret;\n    } else if (relationshipHash.data && typeof relationshipHash.data === 'object') {\n      relationshipHash.data = this._normalizeRelationshipDataHelper(relationshipHash.data);\n    }\n\n    return relationshipHash;\n  },\n\n  /**\n     Returns the resource's relationships formatted as a JSON-API \"relationships object\".\n\n     http://jsonapi.org/format/#document-resource-object-relationships\n\n     @method extractRelationships\n    @public\n     @param {Object} modelClass\n     @param {Object} resourceHash\n     @return {Object}\n  */\n  extractRelationships(modelClass, resourceHash) {\n    let relationships = {};\n\n    if (resourceHash.relationships) {\n      modelClass.eachRelationship((key, relationshipMeta) => {\n        let relationshipKey = this.keyForRelationship(key, relationshipMeta.kind, 'deserialize');\n        if (resourceHash.relationships[relationshipKey] !== undefined) {\n          let relationshipHash = resourceHash.relationships[relationshipKey];\n          relationships[key] = this.extractRelationship(relationshipHash);\n        }\n        if (DEBUG) {\n          if (\n            resourceHash.relationships[relationshipKey] === undefined &&\n            resourceHash.relationships[key] !== undefined\n          ) {\n            assert(\n              `Your payload for '${modelClass.modelName}' contains '${key}', but your serializer is setup to look for '${relationshipKey}'. This is most likely because Ember Data's JSON API serializer dasherizes relationship keys by default. You should subclass JSONAPISerializer and implement 'keyForRelationship(key) { return key; }' to prevent Ember Data from customizing your relationship keys.`,\n              false\n            );\n          }\n        }\n      });\n    }\n\n    return relationships;\n  },\n\n  /**\n    @method _extractType\n    @param {Model} modelClass\n    @param {Object} resourceHash\n    @return {String}\n    @private\n  */\n  _extractType(modelClass, resourceHash) {\n    return this.modelNameFromPayloadKey(resourceHash.type);\n  },\n\n  /**\n    Dasherizes and singularizes the model name in the payload to match\n    the format Ember Data uses internally for the model name.\n\n    For example the key `posts` would be converted to `post` and the\n    key `studentAssesments` would be converted to `student-assesment`.\n\n    @method modelNameFromPayloadKey\n    @public\n    @param {String} key\n    @return {String} the model's modelName\n  */\n  modelNameFromPayloadKey(key) {\n    return singularize(dasherize(key));\n  },\n\n  /**\n    Converts the model name to a pluralized version of the model name.\n\n    For example `post` would be converted to `posts` and\n    `student-assesment` would be converted to `student-assesments`.\n\n    @method payloadKeyFromModelName\n    @public\n    @param {String} modelName\n    @return {String}\n  */\n  payloadKeyFromModelName(modelName) {\n    return pluralize(modelName);\n  },\n\n  normalize(modelClass, resourceHash) {\n    if (resourceHash.attributes) {\n      this.normalizeUsingDeclaredMapping(modelClass, resourceHash.attributes);\n    }\n\n    if (resourceHash.relationships) {\n      this.normalizeUsingDeclaredMapping(modelClass, resourceHash.relationships);\n    }\n\n    let data = {\n      id: this.extractId(modelClass, resourceHash),\n      type: this._extractType(modelClass, resourceHash),\n      attributes: this.extractAttributes(modelClass, resourceHash),\n      relationships: this.extractRelationships(modelClass, resourceHash),\n    };\n\n    this.applyTransforms(modelClass, data.attributes);\n\n    return { data };\n  },\n\n  /**\n    `keyForAttribute` can be used to define rules for how to convert an\n    attribute name in your model to a key in your JSON.\n    By default `JSONAPISerializer` follows the format used on the examples of\n    http://jsonapi.org/format and uses dashes as the word separator in the JSON\n    attribute keys.\n\n    This behaviour can be easily customized by extending this method.\n\n    Example\n\n    ```app/serializers/application.js\n    import JSONAPISerializer from '@ember-data/serializer/json-api';\n    import { dasherize } from '<app-name>/utils/string-utils';\n\n    export default class ApplicationSerializer extends JSONAPISerializer {\n      keyForAttribute(attr, method) {\n        return dasherize(attr).toUpperCase();\n      }\n    }\n    ```\n\n    @method keyForAttribute\n    @public\n    @param {String} key\n    @param {String} method\n    @return {String} normalized key\n  */\n  keyForAttribute(key, method) {\n    return dasherize(key);\n  },\n\n  /**\n   `keyForRelationship` can be used to define a custom key when\n   serializing and deserializing relationship properties.\n   By default `JSONAPISerializer` follows the format used on the examples of\n   http://jsonapi.org/format and uses dashes as word separators in\n   relationship properties.\n\n   This behaviour can be easily customized by extending this method.\n\n   Example\n\n    ```app/serializers/post.js\n    import JSONAPISerializer from '@ember-data/serializer/json-api';\n    import { underscore } from '<app-name>/utils/string-utils';\n\n    export default class ApplicationSerializer extends JSONAPISerializer {\n      keyForRelationship(key, relationship, method) {\n        return underscore(key);\n      }\n    }\n    ```\n   @method keyForRelationship\n    @public\n   @param {String} key\n   @param {String} typeClass\n   @param {String} method\n   @return {String} normalized key\n  */\n  keyForRelationship(key, typeClass, method) {\n    return dasherize(key);\n  },\n\n  /**\n    Called when a record is saved in order to convert the\n    record into JSON.\n\n    For example, consider this model:\n\n    ```app/models/comment.js\n    import Model, { attr, belongsTo } from '@ember-data/model';\n\n    export default class CommentModel extends Model {\n      @attr title;\n      @attr body;\n\n      @belongsTo('user', { async: false, inverse: null })\n      author;\n    }\n    ```\n\n    The default serialization would create a JSON-API resource object like:\n\n    ```javascript\n    {\n      \"data\": {\n        \"type\": \"comments\",\n        \"attributes\": {\n          \"title\": \"Rails is unagi\",\n          \"body\": \"Rails? Omakase? O_O\",\n        },\n        \"relationships\": {\n          \"author\": {\n            \"data\": {\n              \"id\": \"12\",\n              \"type\": \"users\"\n            }\n          }\n        }\n      }\n    }\n    ```\n\n    By default, attributes are passed through as-is, unless\n    you specified an attribute type (`attr('date')`). If\n    you specify a transform, the JavaScript value will be\n    serialized when inserted into the attributes hash.\n\n    Belongs-to relationships are converted into JSON-API\n    resource identifier objects.\n\n    ## IDs\n\n    `serialize` takes an options hash with a single option:\n    `includeId`. If this option is `true`, `serialize` will,\n    by default include the ID in the JSON object it builds.\n\n    The JSONAPIAdapter passes in `includeId: true` when serializing a record\n    for `createRecord` or `updateRecord`.\n\n    ## Customization\n\n    Your server may expect data in a different format than the\n    built-in serialization format.\n\n    In that case, you can implement `serialize` yourself and\n    return data formatted to match your API's expectations, or override\n    the invoked adapter method and do the serialization in the adapter directly\n    by using the provided snapshot.\n\n    If your API's format differs greatly from the JSON:API spec, you should\n    consider authoring your own adapter and serializer instead of extending\n    this class.\n\n    ```app/serializers/post.js\n    import JSONAPISerializer from '@ember-data/serializer/json-api';\n\n    export default class PostSerializer extends JSONAPISerializer {\n      serialize(snapshot, options) {\n        let json = {\n          POST_TTL: snapshot.attr('title'),\n          POST_BDY: snapshot.attr('body'),\n          POST_CMS: snapshot.hasMany('comments', { ids: true })\n        };\n\n        if (options.includeId) {\n          json.POST_ID_ = snapshot.id;\n        }\n\n        return json;\n      }\n    }\n    ```\n\n    ## Customizing an App-Wide Serializer\n\n    If you want to define a serializer for your entire\n    application, you'll probably want to use `eachAttribute`\n    and `eachRelationship` on the record.\n\n    ```app/serializers/application.js\n    import JSONAPISerializer from '@ember-data/serializer/json-api';\n    import { underscore, singularize } from '<app-name>/utils/string-utils';\n\n    export default class ApplicationSerializer extends JSONAPISerializer {\n      serialize(snapshot, options) {\n        let json = {};\n\n        snapshot.eachAttribute((name) => {\n          json[serverAttributeName(name)] = snapshot.attr(name);\n        });\n\n        snapshot.eachRelationship((name, relationship) => {\n          if (relationship.kind === 'hasMany') {\n            json[serverHasManyName(name)] = snapshot.hasMany(name, { ids: true });\n          }\n        });\n\n        if (options.includeId) {\n          json.ID_ = snapshot.id;\n        }\n\n        return json;\n      }\n    }\n\n    function serverAttributeName(attribute) {\n      return underscore(attribute).toUpperCase();\n    }\n\n    function serverHasManyName(name) {\n      return serverAttributeName(singularize(name)) + '_IDS';\n    }\n    ```\n\n    This serializer will generate JSON that looks like this:\n\n    ```javascript\n    {\n      \"TITLE\": \"Rails is omakase\",\n      \"BODY\": \"Yep. Omakase.\",\n      \"COMMENT_IDS\": [ \"1\", \"2\", \"3\" ]\n    }\n    ```\n\n    ## Tweaking the Default Formatting\n\n    If you just want to do some small tweaks on the default JSON:API formatted response,\n    you can call `super.serialize` first and make the tweaks\n    on the returned object.\n\n    ```app/serializers/post.js\n    import JSONAPISerializer from '@ember-data/serializer/json-api';\n\n    export default class PostSerializer extends JSONAPISerializer {\n      serialize(snapshot, options) {\n        let json = super.serialize(...arguments);\n\n        json.data.attributes.subject = json.data.attributes.title;\n        delete json.data.attributes.title;\n\n        return json;\n      }\n    }\n    ```\n\n    @method serialize\n    @public\n    @param {Snapshot} snapshot\n    @param {Object} options\n    @return {Object} json\n  */\n  serialize(snapshot, options) {\n    let data = this._super(...arguments);\n    data.type = this.payloadKeyFromModelName(snapshot.modelName);\n\n    return { data };\n  },\n\n  serializeAttribute(snapshot, json, key, attribute) {\n    let type = attribute.type;\n\n    if (this._canSerialize(key)) {\n      json.attributes = json.attributes || {};\n\n      let value = snapshot.attr(key);\n      if (type) {\n        let transform = this.transformFor(type);\n        value = transform.serialize(value, attribute.options);\n      }\n\n      let schema = this.store.modelFor(snapshot.modelName);\n      let payloadKey = this._getMappedKey(key, schema);\n\n      if (payloadKey === key) {\n        payloadKey = this.keyForAttribute(key, 'serialize');\n      }\n\n      json.attributes[payloadKey] = value;\n    }\n  },\n\n  serializeBelongsTo(snapshot, json, relationship) {\n    let key = relationship.key;\n\n    if (this._canSerialize(key)) {\n      let belongsTo = snapshot.belongsTo(key);\n      let belongsToIsNotNew = belongsTo && !belongsTo.isNew;\n\n      if (belongsTo === null || belongsToIsNotNew) {\n        json.relationships = json.relationships || {};\n\n        let schema = this.store.modelFor(snapshot.modelName);\n        let payloadKey = this._getMappedKey(key, schema);\n        if (payloadKey === key) {\n          payloadKey = this.keyForRelationship(key, 'belongsTo', 'serialize');\n        }\n\n        let data = null;\n        if (belongsTo) {\n          let payloadType = this.payloadKeyFromModelName(belongsTo.modelName);\n\n          data = {\n            type: payloadType,\n            id: belongsTo.id,\n          };\n        }\n\n        json.relationships[payloadKey] = { data };\n      }\n    }\n  },\n\n  serializeHasMany(snapshot, json, relationship) {\n    let key = relationship.key;\n\n    if (this.shouldSerializeHasMany(snapshot, key, relationship)) {\n      let hasMany = snapshot.hasMany(key);\n      if (hasMany !== undefined) {\n        json.relationships = json.relationships || {};\n\n        let schema = this.store.modelFor(snapshot.modelName);\n        let payloadKey = this._getMappedKey(key, schema);\n        if (payloadKey === key && this.keyForRelationship) {\n          payloadKey = this.keyForRelationship(key, 'hasMany', 'serialize');\n        }\n\n        // only serialize has many relationships that are not new\n        let nonNewHasMany = hasMany.filter((item) => item.record && !item.record.isNew);\n        let data = new Array(nonNewHasMany.length);\n\n        for (let i = 0; i < nonNewHasMany.length; i++) {\n          let item = hasMany[i];\n          let payloadType = this.payloadKeyFromModelName(item.modelName);\n\n          data[i] = {\n            type: payloadType,\n            id: item.id,\n          };\n        }\n\n        json.relationships[payloadKey] = { data };\n      }\n    }\n  },\n});\n\nif (DEBUG) {\n  JSONAPISerializer.reopen({\n    init(...args) {\n      this._super(...args);\n\n      assert(\n        `You've used the EmbeddedRecordsMixin in ${this.toString()} which is not fully compatible with the JSON:API specification. Please confirm that this works for your specific API and add \\`this.isEmbeddedRecordsMixinCompatible = true\\` to your serializer.`,\n        !this.isEmbeddedRecordsMixin || this.isEmbeddedRecordsMixinCompatible === true\n      );\n\n      let constructor = this.constructor;\n      warn(\n        `You've defined 'extractMeta' in ${constructor.toString()} which is not used for serializers extending JSONAPISerializer. Read more at https://api.emberjs.com/ember-data/release/classes/JSONAPISerializer on how to customize meta when using JSON API.`,\n        this.extractMeta === JSONSerializer.prototype.extractMeta,\n        {\n          id: 'ds.serializer.json-api.extractMeta',\n        }\n      );\n    },\n    warnMessageForUndefinedType() {\n      return (\n        'Encountered a resource object with an undefined type (resolved resource using ' +\n        this.constructor.toString() +\n        ')'\n      );\n    },\n    warnMessageNoModelForType(modelName, originalType, usedLookup) {\n      return `Encountered a resource object with type \"${originalType}\", but no model was found for model name \"${modelName}\" (resolved model name using '${this.constructor.toString()}.${usedLookup}(\"${originalType}\")').`;\n    },\n  });\n}\n\nexport default JSONAPISerializer;\n"],"names":["JSONAPISerializer","JSONSerializer","extend","_normalizeDocumentHelper","documentHash","Array","isArray","data","ret","length","i","_normalizeResourceHelper","included","normalized","push","_normalizeRelationshipDataHelper","relationshipDataHash","type","modelNameFromPayloadKey","resourceHash","assert","warnMessageForUndefinedType","modelName","usedLookup","store","getSchemaDefinitionService","doesTypeExist","warn","warnMessageNoModelForType","id","modelClass","modelFor","serializer","serializerFor","normalize","pushPayload","payload","normalizedPayload","_normalizeResponse","primaryModelClass","requestType","isSingle","normalizeQueryRecordResponse","_super","arguments","extractAttributes","attributes","eachAttribute","key","attributeKey","keyForAttribute","undefined","macroCondition","getOwnConfig","env","DEBUG","extractRelationship","relationshipHash","extractRelationships","relationships","eachRelationship","relationshipMeta","relationshipKey","keyForRelationship","kind","_extractType","singularize","dasherize","payloadKeyFromModelName","pluralize","normalizeUsingDeclaredMapping","extractId","applyTransforms","method","typeClass","serialize","snapshot","options","serializeAttribute","json","attribute","_canSerialize","value","attr","transform","transformFor","schema","payloadKey","_getMappedKey","serializeBelongsTo","relationship","belongsTo","belongsToIsNotNew","isNew","payloadType","serializeHasMany","shouldSerializeHasMany","hasMany","nonNewHasMany","filter","item","record","reopen","init","args","toString","isEmbeddedRecordsMixin","isEmbeddedRecordsMixinCompatible","constructor","extractMeta","prototype","originalType"],"mappings":";;;;;;AAYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMA,iBAAiB,GAAGC,cAAc,CAACC,MAAM,CAAC;AAC9C;AACF;AACA;AACA;AACA;AACA;EACEC,wBAAwBA,CAACC,YAAY,EAAE;IACrC,IAAIC,KAAK,CAACC,OAAO,CAACF,YAAY,CAACG,IAAI,CAAC,EAAE;MACpC,IAAIC,GAAG,GAAG,IAAIH,KAAK,CAACD,YAAY,CAACG,IAAI,CAACE,MAAM,CAAC,CAAA;AAE7C,MAAA,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGN,YAAY,CAACG,IAAI,CAACE,MAAM,EAAEC,CAAC,EAAE,EAAE;AACjD,QAAA,IAAIH,IAAI,GAAGH,YAAY,CAACG,IAAI,CAACG,CAAC,CAAC,CAAA;QAC/BF,GAAG,CAACE,CAAC,CAAC,GAAG,IAAI,CAACC,wBAAwB,CAACJ,IAAI,CAAC,CAAA;AAC9C,OAAA;MAEAH,YAAY,CAACG,IAAI,GAAGC,GAAG,CAAA;AACzB,KAAC,MAAM,IAAIJ,YAAY,CAACG,IAAI,I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AACA;AACA;AACA;AAME2C,EAAAA,eAAeA,CAACF,GAAG,EAAEyB,MAAM,EAAE;IAC3B,OAAON,SAAS,CAACnB,GAAG,CAAC,CAAA;GACtB;AAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAKEe,EAAAA,kBAAkBA,CAACf,GAAG,EAAE0B,SAAS,EAAED,MAAM,EAAE;IACzC,OAAON,SAAS,CAACnB,GAAG,CAAC,CAAA;GACtB;AAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAuCE2B,EAAAA,SAASA,CAACC,QAAQ,EAAEC,OAAO,EAAE;IAC3B,IAAItE,IAAI,GAAG,IAAI,CAACoC,MAAM,CAAC,GAAGC,SAAS,CAAC,CAAA;IACpCrC,IAAI,CAACU,IAAI,GAAG,IAAI,CAACmD,uBAAuB,CAACQ,QAAQ,CAACtD,SAAS,CAAC,CAAA;IAE5D,OAAO;AAAEf,MAA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"}