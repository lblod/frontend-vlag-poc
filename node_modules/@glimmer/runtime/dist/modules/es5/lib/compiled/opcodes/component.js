import { DEBUG } from '@glimmer/env';
import { isConstRef, valueForRef } from '@glimmer/reference';
import { assert, assign, debugToString, dict, EMPTY_STRING_ARRAY, unwrapTemplate } from '@glimmer/util';
import { $t0, $t1 } from '@glimmer/vm';
import { registerDestructor } from '@glimmer/destroyable';
import { managerHasCapability } from '@glimmer/manager';
import { resolveComponent } from '../../component/resolve';
import { hasCustomDebugRenderTreeLifecycle } from '../../component/interfaces';
import { APPEND_OPCODES } from '../../opcodes';
import createClassListRef from '../../references/class-list';
import { ARGS, CONSTANTS } from '../../symbols';
import { EMPTY_ARGS } from '../../vm/arguments';
import { UpdateDynamicAttributeOpcode } from './dom';
import { isCurriedType, isCurriedValue, resolveCurriedValue } from '../../curried-value';
APPEND_OPCODES.add(78
/* PushComponentDefinition */
, function (vm, _ref) {
  var handle = _ref.op1;
  var definition = vm[CONSTANTS].getValue(handle);
  false && assert(!!definition, "Missing component for " + handle);
  var manager = definition.manager,
      capabilities = definition.capabilities;
  var instance = {
    definition: definition,
    manager: manager,
    capabilities: capabilities,
    state: null,
    handle: null,
    table: null,
    lookup: null
  };
  vm.stack.push(instance);
});
APPEND_OPCODES.add(80
/* ResolveDynamicComponent */
, function (vm, _ref2) {
  var _isStrict = _ref2.op1;
  var stack = vm.stack;
  var component = valueForRef(stack.pop());
  var constants = vm[CONSTANTS];
  var owner = vm.getOwner();
  var isStrict = constants.getValue(_isStrict);
  vm.loadValue($t1, null); // Clear the temp register

  var definition;

  if (typeof component === 'string') {
    if (DEBUG && isStrict) {
      throw new Error("Attempted to resolve a dynamic component with a string definition, `" + component + "` in a strict mode template. In strict mode, using strings to resolve component definitions is prohibited. You can instead import the component definition and use it directly.");
    }

    var resolvedDefinition = resolveComponent(vm.runtime.resolver, constants, component, owner);
    definition = resolvedDefinition;
  } else if (isCurriedValue(component)) {
    definition = component;
  } else {
    definition = constants.component(component, owner);
  }

  stack.push(definition);
});
APPEND_OPCODES.add(81
/* ResolveCurriedComponent */
, function (vm) {
  var stack = vm.stack;
  var ref = stack.pop();
  var value = valueForRef(ref);
  var constants = vm[CONSTANTS];
  var definition;

  if (DEBUG && !(typeof value === 'function' || typeof value === 'object' && value !== null)) {
    throw new Error("Expected a component definition, but received " + value + ". You may have accidentally done <" + ref.debugLabel + ">, where \"" + ref.debugLabel + "\" was a string instead of a curried component definition. You must either use the component definition directly, or use the {{component}} helper to create a curried component definition when invoking dynamically.");
  }

  if (isCurriedValue(value)) {
    definition = value;
  } else {
    definition = constants.component(value, vm.getOwner(), true);

    if (DEBUG && definition === null) {
      throw new Error("Expected a dynamic component definition, but received an object or function that did not have a component manager associated with it. The dynamic invocation was `<" + ref.debugLabel + ">` or `{{" + ref.debugLabel + "}}`, and the incorrect definition is the value at the path `" + ref.debugLabel + "`, which was: " + debugToString(value));
    }
  }

  stack.push(definition);
});
APPEND_OPCODES.add(79
/* PushDynamicComponentInstance */
, function (vm) {
  var stack = vm.stack;
  var definition = stack.pop();
  var capabilities, manager;

  if (isCurriedValue(definition)) {
    manager = capabilities = null;
  } else {
    manager = definition.manager;
    capabilities = definition.capabilities;
  }

  stack.push({
    definition: definition,
    capabilities: capabilities,
    manager: manager,
    state: null,
    handle: null,
    table: null
  });
});
APPEND_OPCODES.add(82
/* PushArgs */
, function (vm, _ref3) {
  var _names = _ref3.op1,
      _blockNames = _ref3.op2,
      flags = _ref3.op3;
  var stack = vm.stack;
  var names = vm[CONSTANTS].getArray(_names);
  var positionalCount = flags >> 4;
  var atNames = flags & 8;
  var blockNames = flags & 7 ? vm[CONSTANTS].getArray(_blockNames) : EMPTY_STRING_ARRAY;
  vm[ARGS].setup(stack, names, blockNames, positionalCount, !!atNames);
  stack.push(vm[ARGS]);
});
APPEND_OPCODES.add(83
/* PushEmptyArgs */
, function (vm) {
  var stack = vm.stack;
  stack.push(vm[ARGS].empty(stack));
});
APPEND_OPCODES.add(86
/* CaptureArgs */
, function (vm) {
  var stack = vm.stack;
  var args = stack.pop();
  var capturedArgs = args.capture();
  stack.push(capturedArgs);
});
APPEND_OPCODES.add(85
/* PrepareArgs */
, function (vm, _ref4) {
  var _state = _ref4.op1;
  var stack = vm.stack;
  var instance = vm.fetchValue(_state);
  var args = stack.pop();
  var definition = instance.definition;

  if (isCurriedType(definition, 0
  /* Component */
  )) {
    false && assert(!definition.manager, "If the component definition was curried, we don't yet have a manager");
    var constants = vm[CONSTANTS];

    var _resolveCurriedValue = resolveCurriedValue(definition),
        resolvedDefinition = _resolveCurriedValue.definition,
        owner = _resolveCurriedValue.owner,
        resolved = _resolveCurriedValue.resolved,
        positional = _resolveCurriedValue.positional,
        named = _resolveCurriedValue.named;

    if (resolved === true) {
      definition = resolvedDefinition;
    } else if (typeof resolvedDefinition === 'string') {
      var resolvedValue = vm.runtime.resolver.lookupComponent(resolvedDefinition, owner);
      definition = constants.resolvedComponent(resolvedValue, resolvedDefinition);
    } else {
      definition = constants.component(resolvedDefinition, owner);
    }

    if (named !== undefined) {
      args.named.merge(assign.apply(void 0, [{}].concat(named)));
    }

    if (positional !== undefined) {
      args.realloc(positional.length);
      args.positional.prepend(positional);
    }

    var _definition = definition,
        _manager = _definition.manager;
    false && assert(instance.manager === null, 'component instance manager should not be populated yet');
    false && assert(instance.capabilities === null, 'component instance manager should not be populated yet');
    instance.definition = definition;
    instance.manager = _manager;
    instance.capabilities = definition.capabilities; // Save off the owner that this component was curried with. Later on,
    // we'll fetch the value of this register and set it as the owner on the
    // new root scope.

    vm.loadValue($t1, owner);
  }

  var _definition2 = definition,
      manager = _definition2.manager,
      state = _definition2.state;
  var capabilities = instance.capabilities;

  if (!managerHasCapability(manager, capabilities, 4
  /* PrepareArgs */
  )) {
    stack.push(args);
    return;
  }

  var blocks = args.blocks.values;
  var blockNames = args.blocks.names;
  var preparedArgs = manager.prepareArgs(state, args);

  if (preparedArgs) {
    args.clear();

    for (var i = 0; i < blocks.length; i++) {
      stack.push(blocks[i]);
    }

    var _positional = preparedArgs.positional,
        _named = preparedArgs.named;
    var positionalCount = _positional.length;

    for (var _i = 0; _i < positionalCount; _i++) {
      stack.push(_positional[_i]);
    }

    var names = Object.keys(_named);

    for (var _i2 = 0; _i2 < names.length; _i2++) {
      stack.push(_named[names[_i2]]);
    }

    args.setup(stack, names, blockNames, positionalCount, false);
  }

  stack.push(args);
});
APPEND_OPCODES.add(87
/* CreateComponent */
, function (vm, _ref5) {
  var flags = _ref5.op1,
      _state = _ref5.op2;
  var instance = vm.fetchValue(_state);
  var definition = instance.definition,
      manager = instance.manager,
      capabilities = instance.capabilities;

  if (!managerHasCapability(manager, capabilities, 512
  /* CreateInstance */
  )) {
    // TODO: Closure and Main components are always invoked dynamically, so this
    // opcode may run even if this capability is not enabled. In the future we
    // should handle this in a better way.
    return;
  }

  var dynamicScope = null;

  if (managerHasCapability(manager, capabilities, 64
  /* DynamicScope */
  )) {
    dynamicScope = vm.dynamicScope();
  }

  var hasDefaultBlock = flags & 1;
  var args = null;

  if (managerHasCapability(manager, capabilities, 8
  /* CreateArgs */
  )) {
    args = vm.stack.peek();
  }

  var self = null;

  if (managerHasCapability(manager, capabilities, 128
  /* CreateCaller */
  )) {
    self = vm.getSelf();
  }

  var state = manager.create(vm.getOwner(), definition.state, args, vm.env, dynamicScope, self, !!hasDefaultBlock); // We want to reuse the `state` POJO here, because we know that the opcodes
  // only transition at exactly one place.

  instance.state = state;

  if (managerHasCapability(manager, capabilities, 256
  /* UpdateHook */
  )) {
    vm.updateWith(new UpdateComponentOpcode(state, manager, dynamicScope));
  }
});
APPEND_OPCODES.add(88
/* RegisterComponentDestructor */
, function (vm, _ref6) {
  var _state = _ref6.op1;

  var _vm$fetchValue = vm.fetchValue(_state),
      manager = _vm$fetchValue.manager,
      state = _vm$fetchValue.state,
      capabilities = _vm$fetchValue.capabilities;

  var d = manager.getDestroyable(state);

  if (DEBUG && !managerHasCapability(manager, capabilities, 2048
  /* WillDestroy */
  ) && d !== null && typeof 'willDestroy' in d) {
    throw new Error('BUG: Destructor has willDestroy, but the willDestroy capability was not enabled for this component. Pre-destruction hooks must be explicitly opted into');
  }

  if (d) vm.associateDestroyable(d);
});
APPEND_OPCODES.add(97
/* BeginComponentTransaction */
, function (vm, _ref7) {
  var _state = _ref7.op1;

  var _a;

  var name;

  if (DEBUG) {
    var _vm$fetchValue2 = vm.fetchValue(_state),
        definition = _vm$fetchValue2.definition,
        manager = _vm$fetchValue2.manager;

    name = (_a = definition.resolvedName) !== null && _a !== void 0 ? _a : manager.getDebugName(definition.state);
  }

  vm.beginCacheGroup(name);
  vm.elements().pushSimpleBlock();
});
APPEND_OPCODES.add(89
/* PutComponentOperations */
, function (vm) {
  vm.loadValue($t0, new ComponentElementOperations());
});
APPEND_OPCODES.add(53
/* ComponentAttr */
, function (vm, _ref8) {
  var _name = _ref8.op1,
      _trusting = _ref8.op2,
      _namespace = _ref8.op3;
  var name = vm[CONSTANTS].getValue(_name);
  var trusting = vm[CONSTANTS].getValue(_trusting);
  var reference = vm.stack.pop();
  var namespace = _namespace ? vm[CONSTANTS].getValue(_namespace) : null;
  vm.fetchValue($t0).setAttribute(name, reference, trusting, namespace);
});
APPEND_OPCODES.add(105
/* StaticComponentAttr */
, function (vm, _ref9) {
  var _name = _ref9.op1,
      _value = _ref9.op2,
      _namespace = _ref9.op3;
  var name = vm[CONSTANTS].getValue(_name);
  var value = vm[CONSTANTS].getValue(_value);
  var namespace = _namespace ? vm[CONSTANTS].getValue(_namespace) : null;
  vm.fetchValue($t0).setStaticAttribute(name, value, namespace);
});
export var ComponentElementOperations = /*#__PURE__*/function () {
  function ComponentElementOperations() {
    this.attributes = dict();
    this.classes = [];
    this.modifiers = [];
  }

  var _proto = ComponentElementOperations.prototype;

  _proto.setAttribute = function setAttribute(name, value, trusting, namespace) {
    var deferred = {
      value: value,
      namespace: namespace,
      trusting: trusting
    };

    if (name === 'class') {
      this.classes.push(value);
    }

    this.attributes[name] = deferred;
  };

  _proto.setStaticAttribute = function setStaticAttribute(name, value, namespace) {
    var deferred = {
      value: value,
      namespace: namespace
    };

    if (name === 'class') {
      this.classes.push(value);
    }

    this.attributes[name] = deferred;
  };

  _proto.addModifier = function addModifier(modifier) {
    this.modifiers.push(modifier);
  };

  _proto.flush = function flush(vm) {
    var type;
    var attributes = this.attributes;

    for (var name in this.attributes) {
      if (name === 'type') {
        type = attributes[name];
        continue;
      }

      var attr = this.attributes[name];

      if (name === 'class') {
        setDeferredAttr(vm, 'class', mergeClasses(this.classes), attr.namespace, attr.trusting);
      } else {
        setDeferredAttr(vm, name, attr.value, attr.namespace, attr.trusting);
      }
    }

    if (type !== undefined) {
      setDeferredAttr(vm, 'type', type.value, type.namespace, type.trusting);
    }

    return this.modifiers;
  };

  return ComponentElementOperations;
}();

function mergeClasses(classes) {
  if (classes.length === 0) {
    return '';
  }

  if (classes.length === 1) {
    return classes[0];
  }

  if (allStringClasses(classes)) {
    return classes.join(' ');
  }

  return createClassListRef(classes);
}

function allStringClasses(classes) {
  for (var i = 0; i < classes.length; i++) {
    if (typeof classes[i] !== 'string') {
      return false;
    }
  }

  return true;
}

function setDeferredAttr(vm, name, value, namespace, trusting) {
  if (trusting === void 0) {
    trusting = false;
  }

  if (typeof value === 'string') {
    vm.elements().setStaticAttribute(name, value, namespace);
  } else {
    var attribute = vm.elements().setDynamicAttribute(name, valueForRef(value), trusting, namespace);

    if (!isConstRef(value)) {
      vm.updateWith(new UpdateDynamicAttributeOpcode(value, attribute, vm.env));
    }
  }
}

APPEND_OPCODES.add(99
/* DidCreateElement */
, function (vm, _ref10) {
  var _state = _ref10.op1;

  var _vm$fetchValue3 = vm.fetchValue(_state),
      definition = _vm$fetchValue3.definition,
      state = _vm$fetchValue3.state;

  var manager = definition.manager;
  var operations = vm.fetchValue($t0);
  manager.didCreateElement(state, vm.elements().constructing, operations);
});
APPEND_OPCODES.add(90
/* GetComponentSelf */
, function (vm, _ref11) {
  var _state = _ref11.op1,
      _names = _ref11.op2;

  var _a;

  var instance = vm.fetchValue(_state);
  var definition = instance.definition,
      state = instance.state;
  var manager = definition.manager;
  var selfRef = manager.getSelf(state);

  if (vm.env.debugRenderTree !== undefined) {
    var _instance = vm.fetchValue(_state);

    var _definition3 = _instance.definition,
        _manager2 = _instance.manager;
    var args;

    if (vm.stack.peek() === vm[ARGS]) {
      args = vm[ARGS].capture();
    } else {
      var names = vm[CONSTANTS].getArray(_names);
      vm[ARGS].setup(vm.stack, names, [], 0, true);
      args = vm[ARGS].capture();
    }

    var moduleName;
    var compilable = _definition3.compilable;

    if (compilable === null) {
      false && assert(managerHasCapability(_manager2, _instance.capabilities, 1
      /* DynamicLayout */
      ), 'BUG: No template was found for this component, and the component did not have the dynamic layout capability');
      compilable = _manager2.getDynamicLayout(state, vm.runtime.resolver);

      if (compilable !== null) {
        moduleName = compilable.moduleName;
      } else {
        moduleName = '__default__.hbs';
      }
    } else {
      moduleName = compilable.moduleName;
    } // For tearing down the debugRenderTree


    vm.associateDestroyable(_instance);

    if (hasCustomDebugRenderTreeLifecycle(_manager2)) {
      var nodes = _manager2.getDebugCustomRenderTree(_instance.definition.state, _instance.state, args, moduleName);

      nodes.forEach(function (node) {
        var bucket = node.bucket;
        vm.env.debugRenderTree.create(bucket, node);
        registerDestructor(_instance, function () {
          var _a;

          (_a = vm.env.debugRenderTree) === null || _a === void 0 ? void 0 : _a.willDestroy(bucket);
        });
        vm.updateWith(new DebugRenderTreeUpdateOpcode(bucket));
      });
    } else {
      var name = (_a = _definition3.resolvedName) !== null && _a !== void 0 ? _a : _manager2.getDebugName(_definition3.state);
      vm.env.debugRenderTree.create(_instance, {
        type: 'component',
        name: name,
        args: args,
        template: moduleName,
        instance: valueForRef(selfRef)
      });
      vm.associateDestroyable(_instance);
      registerDestructor(_instance, function () {
        var _a;

        (_a = vm.env.debugRenderTree) === null || _a === void 0 ? void 0 : _a.willDestroy(_instance);
      });
      vm.updateWith(new DebugRenderTreeUpdateOpcode(_instance));
    }
  }

  vm.stack.push(selfRef);
});
APPEND_OPCODES.add(91
/* GetComponentTagName */
, function (vm, _ref12) {
  var _state = _ref12.op1;

  var _vm$fetchValue4 = vm.fetchValue(_state),
      definition = _vm$fetchValue4.definition,
      state = _vm$fetchValue4.state;

  var manager = definition.manager;
  var tagName = manager.getTagName(state); // User provided value from JS, so we don't bother to encode

  vm.stack.push(tagName);
}); // Dynamic Invocation Only

APPEND_OPCODES.add(92
/* GetComponentLayout */
, function (vm, _ref13) {
  var _state = _ref13.op1;
  var instance = vm.fetchValue(_state);
  var manager = instance.manager,
      definition = instance.definition;
  var stack = vm.stack;
  var compilable = definition.compilable;

  if (compilable === null) {
    var capabilities = instance.capabilities;
    false && assert(managerHasCapability(manager, capabilities, 1
    /* DynamicLayout */
    ), 'BUG: No template was found for this component, and the component did not have the dynamic layout capability');
    compilable = manager.getDynamicLayout(instance.state, vm.runtime.resolver);

    if (compilable === null) {
      if (managerHasCapability(manager, capabilities, 1024
      /* Wrapped */
      )) {
        compilable = unwrapTemplate(vm[CONSTANTS].defaultTemplate).asWrappedLayout();
      } else {
        compilable = unwrapTemplate(vm[CONSTANTS].defaultTemplate).asLayout();
      }
    }
  }

  var handle = compilable.compile(vm.context);
  stack.push(compilable.symbolTable);
  stack.push(handle);
});
APPEND_OPCODES.add(75
/* Main */
, function (vm, _ref14) {
  var register = _ref14.op1;
  var definition = vm.stack.pop();
  var invocation = vm.stack.pop();
  var manager = definition.manager,
      capabilities = definition.capabilities;
  var state = {
    definition: definition,
    manager: manager,
    capabilities: capabilities,
    state: null,
    handle: invocation.handle,
    table: invocation.symbolTable,
    lookup: null
  };
  vm.loadValue(register, state);
});
APPEND_OPCODES.add(95
/* PopulateLayout */
, function (vm, _ref15) {
  var _state = _ref15.op1;
  var stack = vm.stack; // In DEBUG handles could be ErrHandle objects

  var handle = stack.pop();
  var table = stack.pop();
  var state = vm.fetchValue(_state);
  state.handle = handle;
  state.table = table;
});
APPEND_OPCODES.add(38
/* VirtualRootScope */
, function (vm, _ref16) {
  var _state = _ref16.op1;

  var _vm$fetchValue5 = vm.fetchValue(_state),
      table = _vm$fetchValue5.table,
      manager = _vm$fetchValue5.manager,
      capabilities = _vm$fetchValue5.capabilities,
      state = _vm$fetchValue5.state;

  var owner;

  if (managerHasCapability(manager, capabilities, 4096
  /* HasSubOwner */
  )) {
    owner = manager.getOwner(state);
    vm.loadValue($t1, null); // Clear the temp register
  } else {
    // Check the temp register to see if an owner was resolved from currying
    owner = vm.fetchValue($t1);

    if (owner === null) {
      // If an owner wasn't found, default to using the current owner. This
      // will happen for normal dynamic component invocation,
      // e.g. <SomeClassicEmberComponent/>
      owner = vm.getOwner();
    } else {
      // Else the owner was found, so clear the temp register. This will happen
      // if we are loading a curried component, e.g. <@someCurriedComponent/>
      vm.loadValue($t1, null);
    }
  }

  vm.pushRootScope(table.symbols.length + 1, owner);
});
APPEND_OPCODES.add(94
/* SetupForEval */
, function (vm, _ref17) {
  var _state = _ref17.op1;
  var state = vm.fetchValue(_state);

  if (state.table.hasEval) {
    var lookup = state.lookup = dict();
    vm.scope().bindEvalScope(lookup);
  }
});
APPEND_OPCODES.add(17
/* SetNamedVariables */
, function (vm, _ref18) {
  var _state = _ref18.op1;
  var state = vm.fetchValue(_state);
  var scope = vm.scope();
  var args = vm.stack.peek();
  var callerNames = args.named.atNames;

  for (var i = callerNames.length - 1; i >= 0; i--) {
    var atName = callerNames[i];
    var symbol = state.table.symbols.indexOf(callerNames[i]);
    var value = args.named.get(atName, true);
    if (symbol !== -1) scope.bindSymbol(symbol + 1, value);
    if (state.lookup) state.lookup[atName] = value;
  }
});

function bindBlock(symbolName, blockName, state, blocks, vm) {
  var symbol = state.table.symbols.indexOf(symbolName);
  var block = blocks.get(blockName);
  if (symbol !== -1) vm.scope().bindBlock(symbol + 1, block);
  if (state.lookup) state.lookup[symbolName] = block;
}

APPEND_OPCODES.add(18
/* SetBlocks */
, function (vm, _ref19) {
  var _state = _ref19.op1;
  var state = vm.fetchValue(_state);

  var _vm$stack$peek = vm.stack.peek(),
      blocks = _vm$stack$peek.blocks;

  for (var i = 0; i < blocks.names.length; i++) {
    bindBlock(blocks.symbolNames[i], blocks.names[i], state, blocks, vm);
  }
}); // Dynamic Invocation Only

APPEND_OPCODES.add(96
/* InvokeComponentLayout */
, function (vm, _ref20) {
  var _state = _ref20.op1;
  var state = vm.fetchValue(_state);
  vm.call(state.handle);
});
APPEND_OPCODES.add(100
/* DidRenderLayout */
, function (vm, _ref21) {
  var _state = _ref21.op1;
  var instance = vm.fetchValue(_state);
  var manager = instance.manager,
      state = instance.state,
      capabilities = instance.capabilities;
  var bounds = vm.elements().popBlock();

  if (vm.env.debugRenderTree !== undefined) {
    if (hasCustomDebugRenderTreeLifecycle(manager)) {
      var nodes = manager.getDebugCustomRenderTree(instance.definition.state, state, EMPTY_ARGS);
      nodes.reverse().forEach(function (node) {
        var bucket = node.bucket;
        vm.env.debugRenderTree.didRender(bucket, bounds);
        vm.updateWith(new DebugRenderTreeDidRenderOpcode(bucket, bounds));
      });
    } else {
      vm.env.debugRenderTree.didRender(instance, bounds);
      vm.updateWith(new DebugRenderTreeDidRenderOpcode(instance, bounds));
    }
  }

  if (managerHasCapability(manager, capabilities, 512
  /* CreateInstance */
  )) {
    var mgr = manager;
    mgr.didRenderLayout(state, bounds);
    vm.env.didCreate(instance);
    vm.updateWith(new DidUpdateLayoutOpcode(instance, bounds));
  }
});
APPEND_OPCODES.add(98
/* CommitComponentTransaction */
, function (vm) {
  vm.commitCacheGroup();
});
export var UpdateComponentOpcode = /*#__PURE__*/function () {
  function UpdateComponentOpcode(component, manager, dynamicScope) {
    this.component = component;
    this.manager = manager;
    this.dynamicScope = dynamicScope;
  }

  var _proto2 = UpdateComponentOpcode.prototype;

  _proto2.evaluate = function evaluate(_vm) {
    var component = this.component,
        manager = this.manager,
        dynamicScope = this.dynamicScope;
    manager.update(component, dynamicScope);
  };

  return UpdateComponentOpcode;
}();
export var DidUpdateLayoutOpcode = /*#__PURE__*/function () {
  function DidUpdateLayoutOpcode(component, bounds) {
    this.component = component;
    this.bounds = bounds;
  }

  var _proto3 = DidUpdateLayoutOpcode.prototype;

  _proto3.evaluate = function evaluate(vm) {
    var component = this.component,
        bounds = this.bounds;
    var manager = component.manager,
        state = component.state;
    manager.didUpdateLayout(state, bounds);
    vm.env.didUpdate(component);
  };

  return DidUpdateLayoutOpcode;
}();

var DebugRenderTreeUpdateOpcode = /*#__PURE__*/function () {
  function DebugRenderTreeUpdateOpcode(bucket) {
    this.bucket = bucket;
  }

  var _proto4 = DebugRenderTreeUpdateOpcode.prototype;

  _proto4.evaluate = function evaluate(vm) {
    var _a;

    (_a = vm.env.debugRenderTree) === null || _a === void 0 ? void 0 : _a.update(this.bucket);
  };

  return DebugRenderTreeUpdateOpcode;
}();

var DebugRenderTreeDidRenderOpcode = /*#__PURE__*/function () {
  function DebugRenderTreeDidRenderOpcode(bucket, bounds) {
    this.bucket = bucket;
    this.bounds = bounds;
  }

  var _proto5 = DebugRenderTreeDidRenderOpcode.prototype;

  _proto5.evaluate = function evaluate(vm) {
    var _a;

    (_a = vm.env.debugRenderTree) === null || _a === void 0 ? void 0 : _a.didRender(this.bucket, this.bounds);
  };

  return DebugRenderTreeDidRenderOpcode;
}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL3J1bnRpbWUvbGliL2NvbXBpbGVkL29wY29kZXMvY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQVVBLFNBQUEsS0FBQSxRQUFBLGNBQUE7QUE2QkEsU0FBQSxVQUFBLEVBQUEsV0FBQSxRQUFBLG9CQUFBO0FBQ0EsU0FBQSxNQUFBLEVBQUEsTUFBQSxFQUFBLGFBQUEsRUFBQSxJQUFBLEVBQUEsa0JBQUEsRUFBQSxjQUFBLFFBQUEsZUFBQTtBQVNBLFNBQUEsR0FBQSxFQUFBLEdBQUEsUUFBQSxhQUFBO0FBQ0EsU0FBQSxrQkFBQSxRQUFBLHNCQUFBO0FBQ0EsU0FBQSxvQkFBQSxRQUFBLGtCQUFBO0FBQ0EsU0FBQSxnQkFBQSxRQUFBLHlCQUFBO0FBQ0EsU0FBQSxpQ0FBQSxRQUFBLDRCQUFBO0FBQ0EsU0FBQSxjQUFBLFFBQUEsZUFBQTtBQUNBLE9BQUEsa0JBQUEsTUFBQSw2QkFBQTtBQUNBLFNBQUEsSUFBQSxFQUFBLFNBQUEsUUFBQSxlQUFBO0FBR0EsU0FBQSxVQUFBLFFBQUEsb0JBQUE7QUFVQSxTQUFBLDRCQUFBLFFBQUEsT0FBQTtBQUNBLFNBQUEsYUFBQSxFQUFBLGNBQUEsRUFBQSxtQkFBQSxRQUFBLHFCQUFBO0FBMENBLGNBQWMsQ0FBZCxHQUFBLENBQWtCO0FBQUE7QUFBbEIsRUFBK0MsVUFBQSxFQUFBLFFBQXdCO0FBQUEsTUFBWixNQUFZLFFBQWpCLEdBQWlCO0FBQ3JFLE1BQUksVUFBVSxHQUFHLEVBQUUsQ0FBRixTQUFFLENBQUYsQ0FBQSxRQUFBLENBQWpCLE1BQWlCLENBQWpCO0FBRHFFLFdBRXJFLE1BQU0sQ0FBQyxDQUFDLENBQUYsVUFBQSw2QkFGK0QsTUFFL0QsQ0FGK0Q7QUFBQSxNQUlqRSxPQUppRSxHQUlyRSxVQUpxRSxDQUlqRSxPQUppRTtBQUFBLE1BSXRELFlBSnNELEdBSXJFLFVBSnFFLENBSXRELFlBSnNEO0FBTXJFLE1BQUks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QS9CLE1BQXNCLENBQXRCO0FBQ0QsRzs7Ozs7SUFHSCw4QjtBQUNFLDBDQUFBLE1BQUEsRUFBQSxNQUFBLEVBQTBEO0FBQXRDLFNBQUEsTUFBQSxHQUFBLE1BQUE7QUFBd0IsU0FBQSxNQUFBLEdBQUEsTUFBQTtBQUFrQjs7OztVQUU5RCxRLEdBQUEsa0JBQVEsRUFBUixFQUF1Qjs7O0FBQ3JCLEtBQUEsRUFBQSxHQUFBLEVBQUUsQ0FBRixHQUFBLENBQUEsZUFBQSxNQUFBLElBQUEsSUFBc0IsRUFBQSxLQUFBLEtBQXRCLENBQUEsR0FBc0IsS0FBdEIsQ0FBQSxHQUFzQixFQUFBLENBQUEsU0FBQSxDQUFZLEtBQVosTUFBQSxFQUF5QixLQUEvQyxNQUFzQixDQUF0QjtBQUNELEciLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBjaGVjayxcbiAgQ2hlY2tGdW5jdGlvbixcbiAgQ2hlY2tIYW5kbGUsXG4gIENoZWNrSW5zdGFuY2VvZixcbiAgQ2hlY2tJbnRlcmZhY2UsXG4gIENoZWNrUHJvZ3JhbVN5bWJvbFRhYmxlLFxuICBDaGVja1N0cmluZyxcbiAgQ2hlY2tPcixcbn0gZnJvbSAnQGdsaW1tZXIvZGVidWcnO1xuaW1wb3J0IHsgREVCVUcgfSBmcm9tICdAZ2xpbW1lci9lbnYnO1xuaW1wb3J0IHtcbiAgQm91bmRzLFxuICBDb21wb25lbnREZWZpbml0aW9uLFxuICBJbnRlcm5hbENvbXBvbmVudENhcGFiaWxpdHksXG4gIENvbXBvbmVudERlZmluaXRpb25TdGF0ZSxcbiAgQ29tcG9uZW50SW5zdGFuY2VTdGF0ZSxcbiAgSW50ZXJuYWxDb21wb25lbnRNYW5hZ2VyLFxuICBEaWN0LFxuICBEeW5hbWljU2NvcGUsXG4gIEVsZW1lbnRPcGVyYXRpb25zLFxuICBPcCxcbiAgT3B0aW9uLFxuICBQcm9ncmFtU3ltYm9sVGFibGUsXG4gIFJlY2FzdCxcbiAgU2NvcGVTbG90LFxuICBWTUFyZ3VtZW50cyxcbiAgV2l0aER5bmFtaWNUYWdOYW1lLFxuICBXaXRoRWxlbWVudEhvb2ssXG4gIFdpdGhVcGRhdGVIb29rLFxuICBDYXB0dXJlZEFyZ3VtZW50cyxcbiAgQ29tcGlsYWJsZVByb2dyYW0sXG4gIENvbXBvbmVudEluc3RhbmNlLFxuICBNb2RpZmllckluc3RhbmNlLFxuICBDb21wb25lbnRJbnN0YW5jZVdpdGhDcmVhdGUsXG4gIE93bmVyLFxuICBDdXJyaWVkVHlwZSxcbiAgVXBkYXRpbmdPcGNvZGUsXG59IGZyb20gJ0BnbGltbWVyL2ludGVyZmFjZXMnO1xuaW1wb3J0IHsgaXNDb25zdFJlZiwgUmVmZXJlbmNlLCB2YWx1ZUZvclJlZiB9IGZyb20gJ0BnbGltbWVyL3JlZmVyZW5jZSc7XG5pbXBvcnQge1xuICBhc3NlcnQsXG4gIGFzc2lnbixcbiAgZGVidWdUb1N0cmluZyxcbiAgZGljdCxcbiAgRU1QVFlfU1RSSU5HX0FSUkFZLFxuICBleHBlY3QsXG4gIHVud3JhcFRlbXBsYXRlLFxufSBmcm9tICdAZ2xpbW1lci91dGlsJztcbmltcG9ydCB7ICR0MCwgJHQxIH0gZnJvbSAnQGdsaW1tZXIvdm0nO1xuaW1wb3J0IHsgcmVnaXN0ZXJEZXN0cnVjdG9yIH0gZnJvbSAnQGdsaW1tZXIvZGVzdHJveWFibGUnO1xuaW1wb3J0IHsgbWFuYWdlckhhc0NhcGFiaWxpdHkgfSBmcm9tICdAZ2xpbW1lci9tYW5hZ2VyJztcbmltcG9ydCB7IHJlc29sdmVDb21wb25lbnQgfSBmcm9tICcuLi8uLi9jb21wb25lbnQvcmVzb2x2ZSc7XG5pbXBvcnQgeyBoYXNDdXN0b21EZWJ1Z1JlbmRlclRyZWVMaWZlY3ljbGUgfSBmcm9tICcuLi8uLi9jb21wb25lbnQvaW50ZXJmYWNlcyc7XG5pbXBvcnQgeyBBUFBFTkRfT1BDT0RFUyB9IGZyb20gJy4uLy4uL29wY29kZXMnO1xuaW1wb3J0IGNyZWF0ZUNsYXNzTGlzdFJlZiBmcm9tICcuLi8uLi9yZWZlcmVuY2VzL2NsYXNzLWxpc3QnO1xuaW1wb3J0IHsgQVJHUywgQ09OU1RBTlRTIH0gZnJvbSAnLi4vLi4vc3ltYm9scyc7XG5pbXBvcnQgeyBVcGRhdGluZ1ZNIH0gZnJvbSAnLi4vLi4vdm0nO1xuaW1wb3J0IHsgSW50ZXJuYWxWTSB9IGZyb20gJy4uLy4uL3ZtL2FwcGVuZCc7XG5pbXBvcnQgeyBCbG9ja0FyZ3VtZW50c0ltcGwsIEVNUFRZX0FSR1MsIFZNQXJndW1lbnRzSW1wbCB9IGZyb20gJy4uLy4uL3ZtL2FyZ3VtZW50cyc7XG5pbXBvcnQge1xuICBDaGVja0FyZ3VtZW50cyxcbiAgQ2hlY2tDb21wb25lbnREZWZpbml0aW9uLFxuICBDaGVja0NvbXBvbmVudEluc3RhbmNlLFxuICBDaGVja0ZpbmlzaGVkQ29tcG9uZW50SW5zdGFuY2UsXG4gIENoZWNrSW52b2NhdGlvbixcbiAgQ2hlY2tSZWZlcmVuY2UsXG4gIENoZWNrQ3VycmllZENvbXBvbmVudERlZmluaXRpb24sXG59IGZyb20gJy4vLWRlYnVnLXN0cmlwJztcbmltcG9ydCB7IFVwZGF0ZUR5bmFtaWNBdHRyaWJ1dGVPcGNvZGUgfSBmcm9tICcuL2RvbSc7XG5pbXBvcnQge1xuICBDdXJyaWVkVmFsdWUsXG4gIGlzQ3VycmllZFR5cGUsXG4gIGlzQ3VycmllZFZhbHVlLFxuICByZXNvbHZlQ3VycmllZFZhbHVlLFxufSBmcm9tICcuLi8uLi9jdXJyaWVkLXZhbHVlJztcblxuLyoqXG4gKiBUaGUgVk0gY3JlYXRlcyBhIG5ldyBDb21wb25lbnRJbnN0YW5jZSBkYXRhIHN0cnVjdHVyZSBmb3IgZXZlcnkgY29tcG9uZW50XG4gKiBpbnZvY2F0aW9uIGl0IGVuY291bnRlcnMuXG4gKlxuICogU2ltaWxhciB0byBob3cgYSBDb21wb25lbnREZWZpbml0aW9uIGNvbnRhaW5zIHN0YXRlIGFib3V0IGFsbCBjb21wb25lbnRzIG9mIGFcbiAqIHBhcnRpY3VsYXIgdHlwZSwgYSBDb21wb25lbnRJbnN0YW5jZSBjb250YWlucyBzdGF0ZSBzcGVjaWZpYyB0byBhIHBhcnRpY3VsYXJcbiAqIGluc3RhbmNlIG9mIGEgY29tcG9uZW50IHR5cGUuIEl0IGFsc28gY29udGFpbnMgYSBwb2ludGVyIGJhY2sgdG8gaXRzXG4gKiBjb21wb25lbnQgdHlwZSdzIENvbXBvbmVudERlZmluaXRpb24uXG4gKi9cblxuZXhwb3J0IGludGVyZmFjZSBJbml0aWFsQ29tcG9uZW50SW5zdGFuY2Uge1xuICBkZWZpbml0aW9uOiBDb21wb25lbnREZWZpbml0aW9uO1xuICBtYW5hZ2VyOiBPcHRpb248SW50ZXJuYWxDb21wb25lbnRNYW5hZ2VyPjtcbiAgY2FwYWJpbGl0aWVzOiBPcHRpb248SW50ZXJuYWxDb21wb25lbnRDYXBhYmlsaXR5PjtcbiAgc3RhdGU6IG51bGw7XG4gIGhhbmRsZTogT3B0aW9uPG51bWJlcj47XG4gIHRhYmxlOiBPcHRpb248UHJvZ3JhbVN5bWJvbFRhYmxlPjtcbiAgbG9va3VwOiBPcHRpb248RGljdDxTY29wZVNsb3Q+Pjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQb3B1bGF0ZWRDb21wb25lbnRJbnN0YW5jZSB7XG4gIGRlZmluaXRpb246IENvbXBvbmVudERlZmluaXRpb247XG4gIG1hbmFnZXI6IEludGVybmFsQ29tcG9uZW50TWFuYWdlcjtcbiAgY2FwYWJpbGl0aWVzOiBJbnRlcm5hbENvbXBvbmVudENhcGFiaWxpdHk7XG4gIHN0YXRlOiBudWxsO1xuICBoYW5kbGU6IG51bWJlcjtcbiAgdGFibGU6IE9wdGlvbjxQcm9ncmFtU3ltYm9sVGFibGU+O1xuICBsb29rdXA6IE9wdGlvbjxEaWN0PFNjb3BlU2xvdD4+O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFBhcnRpYWxDb21wb25lbnREZWZpbml0aW9uIHtcbiAgc3RhdGU6IE9wdGlvbjxDb21wb25lbnREZWZpbml0aW9uU3RhdGU+O1xuICBtYW5hZ2VyOiBJbnRlcm5hbENvbXBvbmVudE1hbmFnZXI7XG59XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5QdXNoQ29tcG9uZW50RGVmaW5pdGlvbiwgKHZtLCB7IG9wMTogaGFuZGxlIH0pID0+IHtcbiAgbGV0IGRlZmluaXRpb24gPSB2bVtDT05TVEFOVFNdLmdldFZhbHVlPENvbXBvbmVudERlZmluaXRpb24+KGhhbmRsZSk7XG4gIGFzc2VydCghIWRlZmluaXRpb24sIGBNaXNzaW5nIGNvbXBvbmVudCBmb3IgJHtoYW5kbGV9YCk7XG5cbiAgbGV0IHsgbWFuYWdlciwgY2FwYWJpbGl0aWVzIH0gPSBkZWZpbml0aW9uO1xuXG4gIGxldCBpbnN0YW5jZTogSW5pdGlhbENvbXBvbmVudEluc3RhbmNlID0ge1xuICAgIGRlZmluaXRpb24sXG4gICAgbWFuYWdlcixcbiAgICBjYXBhYmlsaXRpZXMsXG4gICAgc3RhdGU6IG51bGwsXG4gICAgaGFuZGxlOiBudWxsLFxuICAgIHRhYmxlOiBudWxsLFxuICAgIGxvb2t1cDogbnVsbCxcbiAgfTtcblxuICB2bS5zdGFjay5wdXNoKGluc3RhbmNlKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuUmVzb2x2ZUR5bmFtaWNDb21wb25lbnQsICh2bSwgeyBvcDE6IF9pc1N0cmljdCB9KSA9PiB7XG4gIGxldCBzdGFjayA9IHZtLnN0YWNrO1xuICBsZXQgY29tcG9uZW50ID0gY2hlY2soXG4gICAgdmFsdWVGb3JSZWYoY2hlY2soc3RhY2sucG9wKCksIENoZWNrUmVmZXJlbmNlKSksXG4gICAgQ2hlY2tPcihDaGVja1N0cmluZywgQ2hlY2tDdXJyaWVkQ29tcG9uZW50RGVmaW5pdGlvbilcbiAgKTtcbiAgbGV0IGNvbnN0YW50cyA9IHZtW0NPTlNUQU5UU107XG4gIGxldCBvd25lciA9IHZtLmdldE93bmVyKCk7XG4gIGxldCBpc1N0cmljdCA9IGNvbnN0YW50cy5nZXRWYWx1ZTxib29sZWFuPihfaXNTdHJpY3QpO1xuXG4gIHZtLmxvYWRWYWx1ZSgkdDEsIG51bGwpOyAvLyBDbGVhciB0aGUgdGVtcCByZWdpc3RlclxuXG4gIGxldCBkZWZpbml0aW9uOiBDb21wb25lbnREZWZpbml0aW9uIHwgQ3VycmllZFZhbHVlO1xuXG4gIGlmICh0eXBlb2YgY29tcG9uZW50ID09PSAnc3RyaW5nJykge1xuICAgIGlmIChERUJVRyAmJiBpc1N0cmljdCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBgQXR0ZW1wdGVkIHRvIHJlc29sdmUgYSBkeW5hbWljIGNvbXBvbmVudCB3aXRoIGEgc3RyaW5nIGRlZmluaXRpb24sIFxcYCR7Y29tcG9uZW50fVxcYCBpbiBhIHN0cmljdCBtb2RlIHRlbXBsYXRlLiBJbiBzdHJpY3QgbW9kZSwgdXNpbmcgc3RyaW5ncyB0byByZXNvbHZlIGNvbXBvbmVudCBkZWZpbml0aW9ucyBpcyBwcm9oaWJpdGVkLiBZb3UgY2FuIGluc3RlYWQgaW1wb3J0IHRoZSBjb21wb25lbnQgZGVmaW5pdGlvbiBhbmQgdXNlIGl0IGRpcmVjdGx5LmBcbiAgICAgICk7XG4gICAgfVxuXG4gICAgbGV0IHJlc29sdmVkRGVmaW5pdGlvbiA9IHJlc29sdmVDb21wb25lbnQodm0ucnVudGltZS5yZXNvbHZlciwgY29uc3RhbnRzLCBjb21wb25lbnQsIG93bmVyKTtcblxuICAgIGRlZmluaXRpb24gPSBleHBlY3QocmVzb2x2ZWREZWZpbml0aW9uLCBgQ291bGQgbm90IGZpbmQgYSBjb21wb25lbnQgbmFtZWQgXCIke2NvbXBvbmVudH1cImApO1xuICB9IGVsc2UgaWYgKGlzQ3VycmllZFZhbHVlKGNvbXBvbmVudCkpIHtcbiAgICBkZWZpbml0aW9uID0gY29tcG9uZW50O1xuICB9IGVsc2Uge1xuICAgIGRlZmluaXRpb24gPSBjb25zdGFudHMuY29tcG9uZW50KGNvbXBvbmVudCwgb3duZXIpO1xuICB9XG5cbiAgc3RhY2sucHVzaChkZWZpbml0aW9uKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuUmVzb2x2ZUN1cnJpZWRDb21wb25lbnQsICh2bSkgPT4ge1xuICBsZXQgc3RhY2sgPSB2bS5zdGFjaztcbiAgbGV0IHJlZiA9IGNoZWNrKHN0YWNrLnBvcCgpLCBDaGVja1JlZmVyZW5jZSk7XG4gIGxldCB2YWx1ZSA9IHZhbHVlRm9yUmVmKHJlZik7XG4gIGxldCBjb25zdGFudHMgPSB2bVtDT05TVEFOVFNdO1xuXG4gIGxldCBkZWZpbml0aW9uOiBDdXJyaWVkVmFsdWUgfCBDb21wb25lbnREZWZpbml0aW9uIHwgbnVsbDtcblxuICBpZiAoREVCVUcgJiYgISh0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbicgfHwgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgIT09IG51bGwpKSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIGBFeHBlY3RlZCBhIGNvbXBvbmVudCBkZWZpbml0aW9uLCBidXQgcmVjZWl2ZWQgJHt2YWx1ZX0uIFlvdSBtYXkgaGF2ZSBhY2NpZGVudGFsbHkgZG9uZSA8JHtyZWYuZGVidWdMYWJlbH0+LCB3aGVyZSBcIiR7cmVmLmRlYnVnTGFiZWx9XCIgd2FzIGEgc3RyaW5nIGluc3RlYWQgb2YgYSBjdXJyaWVkIGNvbXBvbmVudCBkZWZpbml0aW9uLiBZb3UgbXVzdCBlaXRoZXIgdXNlIHRoZSBjb21wb25lbnQgZGVmaW5pdGlvbiBkaXJlY3RseSwgb3IgdXNlIHRoZSB7e2NvbXBvbmVudH19IGhlbHBlciB0byBjcmVhdGUgYSBjdXJyaWVkIGNvbXBvbmVudCBkZWZpbml0aW9uIHdoZW4gaW52b2tpbmcgZHluYW1pY2FsbHkuYFxuICAgICk7XG4gIH1cblxuICBpZiAoaXNDdXJyaWVkVmFsdWUodmFsdWUpKSB7XG4gICAgZGVmaW5pdGlvbiA9IHZhbHVlO1xuICB9IGVsc2Uge1xuICAgIGRlZmluaXRpb24gPSBjb25zdGFudHMuY29tcG9uZW50KHZhbHVlIGFzIG9iamVjdCwgdm0uZ2V0T3duZXIoKSwgdHJ1ZSk7XG5cbiAgICBpZiAoREVCVUcgJiYgZGVmaW5pdGlvbiA9PT0gbnVsbCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBgRXhwZWN0ZWQgYSBkeW5hbWljIGNvbXBvbmVudCBkZWZpbml0aW9uLCBidXQgcmVjZWl2ZWQgYW4gb2JqZWN0IG9yIGZ1bmN0aW9uIHRoYXQgZGlkIG5vdCBoYXZlIGEgY29tcG9uZW50IG1hbmFnZXIgYXNzb2NpYXRlZCB3aXRoIGl0LiBUaGUgZHluYW1pYyBpbnZvY2F0aW9uIHdhcyBcXGA8JHtcbiAgICAgICAgICByZWYuZGVidWdMYWJlbFxuICAgICAgICB9PlxcYCBvciBcXGB7eyR7XG4gICAgICAgICAgcmVmLmRlYnVnTGFiZWxcbiAgICAgICAgfX19XFxgLCBhbmQgdGhlIGluY29ycmVjdCBkZWZpbml0aW9uIGlzIHRoZSB2YWx1ZSBhdCB0aGUgcGF0aCBcXGAke1xuICAgICAgICAgIHJlZi5kZWJ1Z0xhYmVsXG4gICAgICAgIH1cXGAsIHdoaWNoIHdhczogJHtkZWJ1Z1RvU3RyaW5nISh2YWx1ZSl9YFxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICBzdGFjay5wdXNoKGRlZmluaXRpb24pO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5QdXNoRHluYW1pY0NvbXBvbmVudEluc3RhbmNlLCAodm0pID0+IHtcbiAgbGV0IHsgc3RhY2sgfSA9IHZtO1xuICBsZXQgZGVmaW5pdGlvbiA9IHN0YWNrLnBvcDxDb21wb25lbnREZWZpbml0aW9uPigpO1xuXG4gIGxldCBjYXBhYmlsaXRpZXMsIG1hbmFnZXI7XG5cbiAgaWYgKGlzQ3VycmllZFZhbHVlKGRlZmluaXRpb24pKSB7XG4gICAgbWFuYWdlciA9IGNhcGFiaWxpdGllcyA9IG51bGw7XG4gIH0gZWxzZSB7XG4gICAgbWFuYWdlciA9IGRlZmluaXRpb24ubWFuYWdlcjtcbiAgICBjYXBhYmlsaXRpZXMgPSBkZWZpbml0aW9uLmNhcGFiaWxpdGllcztcbiAgfVxuXG4gIHN0YWNrLnB1c2goeyBkZWZpbml0aW9uLCBjYXBhYmlsaXRpZXMsIG1hbmFnZXIsIHN0YXRlOiBudWxsLCBoYW5kbGU6IG51bGwsIHRhYmxlOiBudWxsIH0pO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5QdXNoQXJncywgKHZtLCB7IG9wMTogX25hbWVzLCBvcDI6IF9ibG9ja05hbWVzLCBvcDM6IGZsYWdzIH0pID0+IHtcbiAgbGV0IHN0YWNrID0gdm0uc3RhY2s7XG4gIGxldCBuYW1lcyA9IHZtW0NPTlNUQU5UU10uZ2V0QXJyYXk8c3RyaW5nPihfbmFtZXMpO1xuXG4gIGxldCBwb3NpdGlvbmFsQ291bnQgPSBmbGFncyA+PiA0O1xuICBsZXQgYXROYW1lcyA9IGZsYWdzICYgMGIxMDAwO1xuICBsZXQgYmxvY2tOYW1lcyA9XG4gICAgZmxhZ3MgJiAwYjAxMTEgPyB2bVtDT05TVEFOVFNdLmdldEFycmF5PHN0cmluZz4oX2Jsb2NrTmFtZXMpIDogRU1QVFlfU1RSSU5HX0FSUkFZO1xuXG4gIHZtW0FSR1NdLnNldHVwKHN0YWNrLCBuYW1lcywgYmxvY2tOYW1lcywgcG9zaXRpb25hbENvdW50LCAhIWF0TmFtZXMpO1xuICBzdGFjay5wdXNoKHZtW0FSR1NdKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuUHVzaEVtcHR5QXJncywgKHZtKSA9PiB7XG4gIGxldCB7IHN0YWNrIH0gPSB2bTtcblxuICBzdGFjay5wdXNoKHZtW0FSR1NdLmVtcHR5KHN0YWNrKSk7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkNhcHR1cmVBcmdzLCAodm0pID0+IHtcbiAgbGV0IHN0YWNrID0gdm0uc3RhY2s7XG5cbiAgbGV0IGFyZ3MgPSBjaGVjayhzdGFjay5wb3AoKSwgQ2hlY2tJbnN0YW5jZW9mKFZNQXJndW1lbnRzSW1wbCkpO1xuICBsZXQgY2FwdHVyZWRBcmdzID0gYXJncy5jYXB0dXJlKCk7XG4gIHN0YWNrLnB1c2goY2FwdHVyZWRBcmdzKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuUHJlcGFyZUFyZ3MsICh2bSwgeyBvcDE6IF9zdGF0ZSB9KSA9PiB7XG4gIGxldCBzdGFjayA9IHZtLnN0YWNrO1xuICBsZXQgaW5zdGFuY2UgPSB2bS5mZXRjaFZhbHVlPENvbXBvbmVudEluc3RhbmNlPihfc3RhdGUpO1xuICBsZXQgYXJncyA9IGNoZWNrKHN0YWNrLnBvcCgpLCBDaGVja0luc3RhbmNlb2YoVk1Bcmd1bWVudHNJbXBsKSk7XG5cbiAgbGV0IHsgZGVmaW5pdGlvbiB9ID0gaW5zdGFuY2U7XG5cbiAgaWYgKGlzQ3VycmllZFR5cGUoZGVmaW5pdGlvbiwgQ3VycmllZFR5cGUuQ29tcG9uZW50KSkge1xuICAgIGFzc2VydChcbiAgICAgICFkZWZpbml0aW9uLm1hbmFnZXIsXG4gICAgICBcIklmIHRoZSBjb21wb25lbnQgZGVmaW5pdGlvbiB3YXMgY3VycmllZCwgd2UgZG9uJ3QgeWV0IGhhdmUgYSBtYW5hZ2VyXCJcbiAgICApO1xuXG4gICAgbGV0IGNvbnN0YW50cyA9IHZtW0NPTlNUQU5UU107XG5cbiAgICBsZXQge1xuICAgICAgZGVmaW5pdGlvbjogcmVzb2x2ZWREZWZpbml0aW9uLFxuICAgICAgb3duZXIsXG4gICAgICByZXNvbHZlZCxcbiAgICAgIHBvc2l0aW9uYWwsXG4gICAgICBuYW1lZCxcbiAgICB9ID0gcmVzb2x2ZUN1cnJpZWRWYWx1ZShkZWZpbml0aW9uKTtcblxuICAgIGlmIChyZXNvbHZlZCA9PT0gdHJ1ZSkge1xuICAgICAgZGVmaW5pdGlvbiA9IHJlc29sdmVkRGVmaW5pdGlvbiBhcyBDb21wb25lbnREZWZpbml0aW9uO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHJlc29sdmVkRGVmaW5pdGlvbiA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGxldCByZXNvbHZlZFZhbHVlID0gdm0ucnVudGltZS5yZXNvbHZlci5sb29rdXBDb21wb25lbnQocmVzb2x2ZWREZWZpbml0aW9uLCBvd25lcik7XG5cbiAgICAgIGRlZmluaXRpb24gPSBjb25zdGFudHMucmVzb2x2ZWRDb21wb25lbnQoXG4gICAgICAgIGV4cGVjdChyZXNvbHZlZFZhbHVlLCAnQlVHOiBleHBlY3RlZCByZXNvbHZlZCBjb21wb25lbnQnKSxcbiAgICAgICAgcmVzb2x2ZWREZWZpbml0aW9uXG4gICAgICApO1xuICAgIH0gZWxzZSB7XG4gICAgICBkZWZpbml0aW9uID0gY29uc3RhbnRzLmNvbXBvbmVudChyZXNvbHZlZERlZmluaXRpb24sIG93bmVyKTtcbiAgICB9XG5cbiAgICBpZiAobmFtZWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgYXJncy5uYW1lZC5tZXJnZShhc3NpZ24oe30sIC4uLm5hbWVkKSk7XG4gICAgfVxuXG4gICAgaWYgKHBvc2l0aW9uYWwgIT09IHVuZGVmaW5lZCkge1xuICAgICAgYXJncy5yZWFsbG9jKHBvc2l0aW9uYWwubGVuZ3RoKTtcbiAgICAgIGFyZ3MucG9zaXRpb25hbC5wcmVwZW5kKHBvc2l0aW9uYWwpO1xuICAgIH1cblxuICAgIGxldCB7IG1hbmFnZXIgfSA9IGRlZmluaXRpb247XG5cbiAgICBhc3NlcnQoaW5zdGFuY2UubWFuYWdlciA9PT0gbnVsbCwgJ2NvbXBvbmVudCBpbnN0YW5jZSBtYW5hZ2VyIHNob3VsZCBub3QgYmUgcG9wdWxhdGVkIHlldCcpO1xuICAgIGFzc2VydChcbiAgICAgIGluc3RhbmNlLmNhcGFiaWxpdGllcyA9PT0gbnVsbCxcbiAgICAgICdjb21wb25lbnQgaW5zdGFuY2UgbWFuYWdlciBzaG91bGQgbm90IGJlIHBvcHVsYXRlZCB5ZXQnXG4gICAgKTtcblxuICAgIGluc3RhbmNlLmRlZmluaXRpb24gPSBkZWZpbml0aW9uO1xuICAgIGluc3RhbmNlLm1hbmFnZXIgPSBtYW5hZ2VyO1xuICAgIGluc3RhbmNlLmNhcGFiaWxpdGllcyA9IGRlZmluaXRpb24uY2FwYWJpbGl0aWVzO1xuXG4gICAgLy8gU2F2ZSBvZmYgdGhlIG93bmVyIHRoYXQgdGhpcyBjb21wb25lbnQgd2FzIGN1cnJpZWQgd2l0aC4gTGF0ZXIgb24sXG4gICAgLy8gd2UnbGwgZmV0Y2ggdGhlIHZhbHVlIG9mIHRoaXMgcmVnaXN0ZXIgYW5kIHNldCBpdCBhcyB0aGUgb3duZXIgb24gdGhlXG4gICAgLy8gbmV3IHJvb3Qgc2NvcGUuXG4gICAgdm0ubG9hZFZhbHVlKCR0MSwgb3duZXIpO1xuICB9XG5cbiAgbGV0IHsgbWFuYWdlciwgc3RhdGUgfSA9IGRlZmluaXRpb247XG4gIGxldCBjYXBhYmlsaXRpZXMgPSBpbnN0YW5jZS5jYXBhYmlsaXRpZXM7XG5cbiAgaWYgKCFtYW5hZ2VySGFzQ2FwYWJpbGl0eShtYW5hZ2VyLCBjYXBhYmlsaXRpZXMsIEludGVybmFsQ29tcG9uZW50Q2FwYWJpbGl0eS5QcmVwYXJlQXJncykpIHtcbiAgICBzdGFjay5wdXNoKGFyZ3MpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGxldCBibG9ja3MgPSBhcmdzLmJsb2Nrcy52YWx1ZXM7XG4gIGxldCBibG9ja05hbWVzID0gYXJncy5ibG9ja3MubmFtZXM7XG4gIGxldCBwcmVwYXJlZEFyZ3MgPSBtYW5hZ2VyLnByZXBhcmVBcmdzKHN0YXRlLCBhcmdzKTtcblxuICBpZiAocHJlcGFyZWRBcmdzKSB7XG4gICAgYXJncy5jbGVhcigpO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBibG9ja3MubGVuZ3RoOyBpKyspIHtcbiAgICAgIHN0YWNrLnB1c2goYmxvY2tzW2ldKTtcbiAgICB9XG5cbiAgICBsZXQgeyBwb3NpdGlvbmFsLCBuYW1lZCB9ID0gcHJlcGFyZWRBcmdzO1xuXG4gICAgbGV0IHBvc2l0aW9uYWxDb3VudCA9IHBvc2l0aW9uYWwubGVuZ3RoO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwb3NpdGlvbmFsQ291bnQ7IGkrKykge1xuICAgICAgc3RhY2sucHVzaChwb3NpdGlvbmFsW2ldKTtcbiAgICB9XG5cbiAgICBsZXQgbmFtZXMgPSBPYmplY3Qua2V5cyhuYW1lZCk7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5hbWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBzdGFjay5wdXNoKG5hbWVkW25hbWVzW2ldXSk7XG4gICAgfVxuXG4gICAgYXJncy5zZXR1cChzdGFjaywgbmFtZXMsIGJsb2NrTmFtZXMsIHBvc2l0aW9uYWxDb3VudCwgZmFsc2UpO1xuICB9XG5cbiAgc3RhY2sucHVzaChhcmdzKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuQ3JlYXRlQ29tcG9uZW50LCAodm0sIHsgb3AxOiBmbGFncywgb3AyOiBfc3RhdGUgfSkgPT4ge1xuICBsZXQgaW5zdGFuY2UgPSBjaGVjayh2bS5mZXRjaFZhbHVlKF9zdGF0ZSksIENoZWNrQ29tcG9uZW50SW5zdGFuY2UpO1xuICBsZXQgeyBkZWZpbml0aW9uLCBtYW5hZ2VyLCBjYXBhYmlsaXRpZXMgfSA9IGluc3RhbmNlO1xuXG4gIGlmICghbWFuYWdlckhhc0NhcGFiaWxpdHkobWFuYWdlciwgY2FwYWJpbGl0aWVzLCBJbnRlcm5hbENvbXBvbmVudENhcGFiaWxpdHkuQ3JlYXRlSW5zdGFuY2UpKSB7XG4gICAgLy8gVE9ETzogQ2xvc3VyZSBhbmQgTWFpbiBjb21wb25lbnRzIGFyZSBhbHdheXMgaW52b2tlZCBkeW5hbWljYWxseSwgc28gdGhpc1xuICAgIC8vIG9wY29kZSBtYXkgcnVuIGV2ZW4gaWYgdGhpcyBjYXBhYmlsaXR5IGlzIG5vdCBlbmFibGVkLiBJbiB0aGUgZnV0dXJlIHdlXG4gICAgLy8gc2hvdWxkIGhhbmRsZSB0aGlzIGluIGEgYmV0dGVyIHdheS5cbiAgICByZXR1cm47XG4gIH1cblxuICBsZXQgZHluYW1pY1Njb3BlOiBPcHRpb248RHluYW1pY1Njb3BlPiA9IG51bGw7XG4gIGlmIChtYW5hZ2VySGFzQ2FwYWJpbGl0eShtYW5hZ2VyLCBjYXBhYmlsaXRpZXMsIEludGVybmFsQ29tcG9uZW50Q2FwYWJpbGl0eS5EeW5hbWljU2NvcGUpKSB7XG4gICAgZHluYW1pY1Njb3BlID0gdm0uZHluYW1pY1Njb3BlKCk7XG4gIH1cblxuICBsZXQgaGFzRGVmYXVsdEJsb2NrID0gZmxhZ3MgJiAxO1xuICBsZXQgYXJnczogT3B0aW9uPFZNQXJndW1lbnRzPiA9IG51bGw7XG5cbiAgaWYgKG1hbmFnZXJIYXNDYXBhYmlsaXR5KG1hbmFnZXIsIGNhcGFiaWxpdGllcywgSW50ZXJuYWxDb21wb25lbnRDYXBhYmlsaXR5LkNyZWF0ZUFyZ3MpKSB7XG4gICAgYXJncyA9IGNoZWNrKHZtLnN0YWNrLnBlZWsoKSwgQ2hlY2tBcmd1bWVudHMpO1xuICB9XG5cbiAgbGV0IHNlbGY6IE9wdGlvbjxSZWZlcmVuY2U+ID0gbnVsbDtcbiAgaWYgKG1hbmFnZXJIYXNDYXBhYmlsaXR5KG1hbmFnZXIsIGNhcGFiaWxpdGllcywgSW50ZXJuYWxDb21wb25lbnRDYXBhYmlsaXR5LkNyZWF0ZUNhbGxlcikpIHtcbiAgICBzZWxmID0gdm0uZ2V0U2VsZigpO1xuICB9XG5cbiAgbGV0IHN0YXRlID0gbWFuYWdlci5jcmVhdGUoXG4gICAgdm0uZ2V0T3duZXIoKSxcbiAgICBkZWZpbml0aW9uLnN0YXRlLFxuICAgIGFyZ3MsXG4gICAgdm0uZW52LFxuICAgIGR5bmFtaWNTY29wZSxcbiAgICBzZWxmLFxuICAgICEhaGFzRGVmYXVsdEJsb2NrXG4gICk7XG5cbiAgLy8gV2Ugd2FudCB0byByZXVzZSB0aGUgYHN0YXRlYCBQT0pPIGhlcmUsIGJlY2F1c2Ugd2Uga25vdyB0aGF0IHRoZSBvcGNvZGVzXG4gIC8vIG9ubHkgdHJhbnNpdGlvbiBhdCBleGFjdGx5IG9uZSBwbGFjZS5cbiAgaW5zdGFuY2Uuc3RhdGUgPSBzdGF0ZTtcblxuICBpZiAobWFuYWdlckhhc0NhcGFiaWxpdHkobWFuYWdlciwgY2FwYWJpbGl0aWVzLCBJbnRlcm5hbENvbXBvbmVudENhcGFiaWxpdHkuVXBkYXRlSG9vaykpIHtcbiAgICB2bS51cGRhdGVXaXRoKG5ldyBVcGRhdGVDb21wb25lbnRPcGNvZGUoc3RhdGUsIG1hbmFnZXIsIGR5bmFtaWNTY29wZSkpO1xuICB9XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLlJlZ2lzdGVyQ29tcG9uZW50RGVzdHJ1Y3RvciwgKHZtLCB7IG9wMTogX3N0YXRlIH0pID0+IHtcbiAgbGV0IHsgbWFuYWdlciwgc3RhdGUsIGNhcGFiaWxpdGllcyB9ID0gY2hlY2sodm0uZmV0Y2hWYWx1ZShfc3RhdGUpLCBDaGVja0NvbXBvbmVudEluc3RhbmNlKTtcblxuICBsZXQgZCA9IG1hbmFnZXIuZ2V0RGVzdHJveWFibGUoc3RhdGUpO1xuXG4gIGlmIChcbiAgICBERUJVRyAmJlxuICAgICFtYW5hZ2VySGFzQ2FwYWJpbGl0eShtYW5hZ2VyLCBjYXBhYmlsaXRpZXMsIEludGVybmFsQ29tcG9uZW50Q2FwYWJpbGl0eS5XaWxsRGVzdHJveSkgJiZcbiAgICBkICE9PSBudWxsICYmXG4gICAgdHlwZW9mICd3aWxsRGVzdHJveScgaW4gZFxuICApIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAnQlVHOiBEZXN0cnVjdG9yIGhhcyB3aWxsRGVzdHJveSwgYnV0IHRoZSB3aWxsRGVzdHJveSBjYXBhYmlsaXR5IHdhcyBub3QgZW5hYmxlZCBmb3IgdGhpcyBjb21wb25lbnQuIFByZS1kZXN0cnVjdGlvbiBob29rcyBtdXN0IGJlIGV4cGxpY2l0bHkgb3B0ZWQgaW50bydcbiAgICApO1xuICB9XG5cbiAgaWYgKGQpIHZtLmFzc29jaWF0ZURlc3Ryb3lhYmxlKGQpO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5CZWdpbkNvbXBvbmVudFRyYW5zYWN0aW9uLCAodm0sIHsgb3AxOiBfc3RhdGUgfSkgPT4ge1xuICBsZXQgbmFtZTtcblxuICBpZiAoREVCVUcpIHtcbiAgICBsZXQgeyBkZWZpbml0aW9uLCBtYW5hZ2VyIH0gPSBjaGVjayh2bS5mZXRjaFZhbHVlKF9zdGF0ZSksIENoZWNrQ29tcG9uZW50SW5zdGFuY2UpO1xuXG4gICAgbmFtZSA9IGRlZmluaXRpb24ucmVzb2x2ZWROYW1lID8/IG1hbmFnZXIuZ2V0RGVidWdOYW1lKGRlZmluaXRpb24uc3RhdGUpO1xuICB9XG5cbiAgdm0uYmVnaW5DYWNoZUdyb3VwKG5hbWUpO1xuICB2bS5lbGVtZW50cygpLnB1c2hTaW1wbGVCbG9jaygpO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5QdXRDb21wb25lbnRPcGVyYXRpb25zLCAodm0pID0+IHtcbiAgdm0ubG9hZFZhbHVlKCR0MCwgbmV3IENvbXBvbmVudEVsZW1lbnRPcGVyYXRpb25zKCkpO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5Db21wb25lbnRBdHRyLCAodm0sIHsgb3AxOiBfbmFtZSwgb3AyOiBfdHJ1c3RpbmcsIG9wMzogX25hbWVzcGFjZSB9KSA9PiB7XG4gIGxldCBuYW1lID0gdm1bQ09OU1RBTlRTXS5nZXRWYWx1ZTxzdHJpbmc+KF9uYW1lKTtcbiAgbGV0IHRydXN0aW5nID0gdm1bQ09OU1RBTlRTXS5nZXRWYWx1ZTxib29sZWFuPihfdHJ1c3RpbmcpO1xuICBsZXQgcmVmZXJlbmNlID0gY2hlY2sodm0uc3RhY2sucG9wKCksIENoZWNrUmVmZXJlbmNlKTtcbiAgbGV0IG5hbWVzcGFjZSA9IF9uYW1lc3BhY2UgPyB2bVtDT05TVEFOVFNdLmdldFZhbHVlPHN0cmluZz4oX25hbWVzcGFjZSkgOiBudWxsO1xuXG4gIGNoZWNrKHZtLmZldGNoVmFsdWUoJHQwKSwgQ2hlY2tJbnN0YW5jZW9mKENvbXBvbmVudEVsZW1lbnRPcGVyYXRpb25zKSkuc2V0QXR0cmlidXRlKFxuICAgIG5hbWUsXG4gICAgcmVmZXJlbmNlLFxuICAgIHRydXN0aW5nLFxuICAgIG5hbWVzcGFjZVxuICApO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5TdGF0aWNDb21wb25lbnRBdHRyLCAodm0sIHsgb3AxOiBfbmFtZSwgb3AyOiBfdmFsdWUsIG9wMzogX25hbWVzcGFjZSB9KSA9PiB7XG4gIGxldCBuYW1lID0gdm1bQ09OU1RBTlRTXS5nZXRWYWx1ZTxzdHJpbmc+KF9uYW1lKTtcbiAgbGV0IHZhbHVlID0gdm1bQ09OU1RBTlRTXS5nZXRWYWx1ZTxzdHJpbmc+KF92YWx1ZSk7XG4gIGxldCBuYW1lc3BhY2UgPSBfbmFtZXNwYWNlID8gdm1bQ09OU1RBTlRTXS5nZXRWYWx1ZTxzdHJpbmc+KF9uYW1lc3BhY2UpIDogbnVsbDtcblxuICBjaGVjayh2bS5mZXRjaFZhbHVlKCR0MCksIENoZWNrSW5zdGFuY2VvZihDb21wb25lbnRFbGVtZW50T3BlcmF0aW9ucykpLnNldFN0YXRpY0F0dHJpYnV0ZShcbiAgICBuYW1lLFxuICAgIHZhbHVlLFxuICAgIG5hbWVzcGFjZVxuICApO1xufSk7XG5cbnR5cGUgRGVmZXJyZWRBdHRyaWJ1dGUgPSB7XG4gIHZhbHVlOiBzdHJpbmcgfCBSZWZlcmVuY2U8dW5rbm93bj47XG4gIG5hbWVzcGFjZTogT3B0aW9uPHN0cmluZz47XG4gIHRydXN0aW5nPzogYm9vbGVhbjtcbn07XG5cbmV4cG9ydCBjbGFzcyBDb21wb25lbnRFbGVtZW50T3BlcmF0aW9ucyBpbXBsZW1lbnRzIEVsZW1lbnRPcGVyYXRpb25zIHtcbiAgcHJpdmF0ZSBhdHRyaWJ1dGVzID0gZGljdDxEZWZlcnJlZEF0dHJpYnV0ZT4oKTtcbiAgcHJpdmF0ZSBjbGFzc2VzOiAoc3RyaW5nIHwgUmVmZXJlbmNlPHVua25vd24+KVtdID0gW107XG4gIHByaXZhdGUgbW9kaWZpZXJzOiBNb2RpZmllckluc3RhbmNlW10gPSBbXTtcblxuICBzZXRBdHRyaWJ1dGUoXG4gICAgbmFtZTogc3RyaW5nLFxuICAgIHZhbHVlOiBSZWZlcmVuY2U8dW5rbm93bj4sXG4gICAgdHJ1c3Rpbmc6IGJvb2xlYW4sXG4gICAgbmFtZXNwYWNlOiBPcHRpb248c3RyaW5nPlxuICApIHtcbiAgICBsZXQgZGVmZXJyZWQgPSB7IHZhbHVlLCBuYW1lc3BhY2UsIHRydXN0aW5nIH07XG5cbiAgICBpZiAobmFtZSA9PT0gJ2NsYXNzJykge1xuICAgICAgdGhpcy5jbGFzc2VzLnB1c2godmFsdWUpO1xuICAgIH1cblxuICAgIHRoaXMuYXR0cmlidXRlc1tuYW1lXSA9IGRlZmVycmVkO1xuICB9XG5cbiAgc2V0U3RhdGljQXR0cmlidXRlKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgbmFtZXNwYWNlOiBPcHRpb248c3RyaW5nPik6IHZvaWQge1xuICAgIGxldCBkZWZlcnJlZCA9IHsgdmFsdWUsIG5hbWVzcGFjZSB9O1xuXG4gICAgaWYgKG5hbWUgPT09ICdjbGFzcycpIHtcbiAgICAgIHRoaXMuY2xhc3Nlcy5wdXNoKHZhbHVlKTtcbiAgICB9XG5cbiAgICB0aGlzLmF0dHJpYnV0ZXNbbmFtZV0gPSBkZWZlcnJlZDtcbiAgfVxuXG4gIGFkZE1vZGlmaWVyKG1vZGlmaWVyOiBNb2RpZmllckluc3RhbmNlKTogdm9pZCB7XG4gICAgdGhpcy5tb2RpZmllcnMucHVzaChtb2RpZmllcik7XG4gIH1cblxuICBmbHVzaCh2bTogSW50ZXJuYWxWTSk6IE1vZGlmaWVySW5zdGFuY2VbXSB7XG4gICAgbGV0IHR5cGU6IERlZmVycmVkQXR0cmlidXRlIHwgdW5kZWZpbmVkO1xuICAgIGxldCBhdHRyaWJ1dGVzID0gdGhpcy5hdHRyaWJ1dGVzO1xuXG4gICAgZm9yIChsZXQgbmFtZSBpbiB0aGlzLmF0dHJpYnV0ZXMpIHtcbiAgICAgIGlmIChuYW1lID09PSAndHlwZScpIHtcbiAgICAgICAgdHlwZSA9IGF0dHJpYnV0ZXNbbmFtZV07XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICBsZXQgYXR0ciA9IHRoaXMuYXR0cmlidXRlc1tuYW1lXTtcbiAgICAgIGlmIChuYW1lID09PSAnY2xhc3MnKSB7XG4gICAgICAgIHNldERlZmVycmVkQXR0cih2bSwgJ2NsYXNzJywgbWVyZ2VDbGFzc2VzKHRoaXMuY2xhc3NlcyksIGF0dHIubmFtZXNwYWNlLCBhdHRyLnRydXN0aW5nKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNldERlZmVycmVkQXR0cih2bSwgbmFtZSwgYXR0ci52YWx1ZSwgYXR0ci5uYW1lc3BhY2UsIGF0dHIudHJ1c3RpbmcpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0eXBlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHNldERlZmVycmVkQXR0cih2bSwgJ3R5cGUnLCB0eXBlLnZhbHVlLCB0eXBlLm5hbWVzcGFjZSwgdHlwZS50cnVzdGluZyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMubW9kaWZpZXJzO1xuICB9XG59XG5cbmZ1bmN0aW9uIG1lcmdlQ2xhc3NlcyhjbGFzc2VzOiAoc3RyaW5nIHwgUmVmZXJlbmNlKVtdKTogc3RyaW5nIHwgUmVmZXJlbmNlPHVua25vd24+IHtcbiAgaWYgKGNsYXNzZXMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuICcnO1xuICB9XG4gIGlmIChjbGFzc2VzLmxlbmd0aCA9PT0gMSkge1xuICAgIHJldHVybiBjbGFzc2VzWzBdO1xuICB9XG4gIGlmIChhbGxTdHJpbmdDbGFzc2VzKGNsYXNzZXMpKSB7XG4gICAgcmV0dXJuIGNsYXNzZXMuam9pbignICcpO1xuICB9XG5cbiAgcmV0dXJuIGNyZWF0ZUNsYXNzTGlzdFJlZihjbGFzc2VzIGFzIFJlZmVyZW5jZVtdKTtcbn1cblxuZnVuY3Rpb24gYWxsU3RyaW5nQ2xhc3NlcyhjbGFzc2VzOiAoc3RyaW5nIHwgUmVmZXJlbmNlPHVua25vd24+KVtdKTogY2xhc3NlcyBpcyBzdHJpbmdbXSB7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgY2xhc3Nlcy5sZW5ndGg7IGkrKykge1xuICAgIGlmICh0eXBlb2YgY2xhc3Nlc1tpXSAhPT0gJ3N0cmluZycpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59XG5cbmZ1bmN0aW9uIHNldERlZmVycmVkQXR0cihcbiAgdm06IEludGVybmFsVk0sXG4gIG5hbWU6IHN0cmluZyxcbiAgdmFsdWU6IHN0cmluZyB8IFJlZmVyZW5jZTx1bmtub3duPixcbiAgbmFtZXNwYWNlOiBPcHRpb248c3RyaW5nPixcbiAgdHJ1c3RpbmcgPSBmYWxzZVxuKSB7XG4gIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgdm0uZWxlbWVudHMoKS5zZXRTdGF0aWNBdHRyaWJ1dGUobmFtZSwgdmFsdWUsIG5hbWVzcGFjZSk7XG4gIH0gZWxzZSB7XG4gICAgbGV0IGF0dHJpYnV0ZSA9IHZtXG4gICAgICAuZWxlbWVudHMoKVxuICAgICAgLnNldER5bmFtaWNBdHRyaWJ1dGUobmFtZSwgdmFsdWVGb3JSZWYodmFsdWUpLCB0cnVzdGluZywgbmFtZXNwYWNlKTtcbiAgICBpZiAoIWlzQ29uc3RSZWYodmFsdWUpKSB7XG4gICAgICB2bS51cGRhdGVXaXRoKG5ldyBVcGRhdGVEeW5hbWljQXR0cmlidXRlT3Bjb2RlKHZhbHVlLCBhdHRyaWJ1dGUsIHZtLmVudikpO1xuICAgIH1cbiAgfVxufVxuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuRGlkQ3JlYXRlRWxlbWVudCwgKHZtLCB7IG9wMTogX3N0YXRlIH0pID0+IHtcbiAgbGV0IHsgZGVmaW5pdGlvbiwgc3RhdGUgfSA9IGNoZWNrKHZtLmZldGNoVmFsdWUoX3N0YXRlKSwgQ2hlY2tDb21wb25lbnRJbnN0YW5jZSk7XG4gIGxldCB7IG1hbmFnZXIgfSA9IGRlZmluaXRpb247XG5cbiAgbGV0IG9wZXJhdGlvbnMgPSBjaGVjayh2bS5mZXRjaFZhbHVlKCR0MCksIENoZWNrSW5zdGFuY2VvZihDb21wb25lbnRFbGVtZW50T3BlcmF0aW9ucykpO1xuXG4gIChtYW5hZ2VyIGFzIFdpdGhFbGVtZW50SG9vazx1bmtub3duPikuZGlkQ3JlYXRlRWxlbWVudChcbiAgICBzdGF0ZSxcbiAgICBleHBlY3Qodm0uZWxlbWVudHMoKS5jb25zdHJ1Y3RpbmcsIGBFeHBlY3RlZCBhIGNvbnN0cnVjdGluZyBlbGVtZW50IGluIERpZENyZWF0ZU9wY29kZWApLFxuICAgIG9wZXJhdGlvbnNcbiAgKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuR2V0Q29tcG9uZW50U2VsZiwgKHZtLCB7IG9wMTogX3N0YXRlLCBvcDI6IF9uYW1lcyB9KSA9PiB7XG4gIGxldCBpbnN0YW5jZSA9IGNoZWNrKHZtLmZldGNoVmFsdWUoX3N0YXRlKSwgQ2hlY2tDb21wb25lbnRJbnN0YW5jZSk7XG4gIGxldCB7IGRlZmluaXRpb24sIHN0YXRlIH0gPSBpbnN0YW5jZTtcbiAgbGV0IHsgbWFuYWdlciB9ID0gZGVmaW5pdGlvbjtcbiAgbGV0IHNlbGZSZWYgPSBtYW5hZ2VyLmdldFNlbGYoc3RhdGUpO1xuXG4gIGlmICh2bS5lbnYuZGVidWdSZW5kZXJUcmVlICE9PSB1bmRlZmluZWQpIHtcbiAgICBsZXQgaW5zdGFuY2UgPSBjaGVjayh2bS5mZXRjaFZhbHVlKF9zdGF0ZSksIENoZWNrQ29tcG9uZW50SW5zdGFuY2UpO1xuICAgIGxldCB7IGRlZmluaXRpb24sIG1hbmFnZXIgfSA9IGluc3RhbmNlO1xuXG4gICAgbGV0IGFyZ3M6IENhcHR1cmVkQXJndW1lbnRzO1xuXG4gICAgaWYgKHZtLnN0YWNrLnBlZWsoKSA9PT0gdm1bQVJHU10pIHtcbiAgICAgIGFyZ3MgPSB2bVtBUkdTXS5jYXB0dXJlKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCBuYW1lcyA9IHZtW0NPTlNUQU5UU10uZ2V0QXJyYXk8c3RyaW5nPihfbmFtZXMpO1xuICAgICAgdm1bQVJHU10uc2V0dXAodm0uc3RhY2ssIG5hbWVzLCBbXSwgMCwgdHJ1ZSk7XG4gICAgICBhcmdzID0gdm1bQVJHU10uY2FwdHVyZSgpO1xuICAgIH1cblxuICAgIGxldCBtb2R1bGVOYW1lOiBzdHJpbmc7XG4gICAgbGV0IGNvbXBpbGFibGU6IENvbXBpbGFibGVQcm9ncmFtIHwgbnVsbCA9IGRlZmluaXRpb24uY29tcGlsYWJsZTtcblxuICAgIGlmIChjb21waWxhYmxlID09PSBudWxsKSB7XG4gICAgICBhc3NlcnQoXG4gICAgICAgIG1hbmFnZXJIYXNDYXBhYmlsaXR5KFxuICAgICAgICAgIG1hbmFnZXIsXG4gICAgICAgICAgaW5zdGFuY2UuY2FwYWJpbGl0aWVzLFxuICAgICAgICAgIEludGVybmFsQ29tcG9uZW50Q2FwYWJpbGl0eS5EeW5hbWljTGF5b3V0XG4gICAgICAgICksXG4gICAgICAgICdCVUc6IE5vIHRlbXBsYXRlIHdhcyBmb3VuZCBmb3IgdGhpcyBjb21wb25lbnQsIGFuZCB0aGUgY29tcG9uZW50IGRpZCBub3QgaGF2ZSB0aGUgZHluYW1pYyBsYXlvdXQgY2FwYWJpbGl0eSdcbiAgICAgICk7XG5cbiAgICAgIGNvbXBpbGFibGUgPSBtYW5hZ2VyLmdldER5bmFtaWNMYXlvdXQoc3RhdGUsIHZtLnJ1bnRpbWUucmVzb2x2ZXIpO1xuXG4gICAgICBpZiAoY29tcGlsYWJsZSAhPT0gbnVsbCkge1xuICAgICAgICBtb2R1bGVOYW1lID0gY29tcGlsYWJsZS5tb2R1bGVOYW1lO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbW9kdWxlTmFtZSA9ICdfX2RlZmF1bHRfXy5oYnMnO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBtb2R1bGVOYW1lID0gY29tcGlsYWJsZS5tb2R1bGVOYW1lO1xuICAgIH1cblxuICAgIC8vIEZvciB0ZWFyaW5nIGRvd24gdGhlIGRlYnVnUmVuZGVyVHJlZVxuICAgIHZtLmFzc29jaWF0ZURlc3Ryb3lhYmxlKGluc3RhbmNlKTtcblxuICAgIGlmIChoYXNDdXN0b21EZWJ1Z1JlbmRlclRyZWVMaWZlY3ljbGUobWFuYWdlcikpIHtcbiAgICAgIGxldCBub2RlcyA9IG1hbmFnZXIuZ2V0RGVidWdDdXN0b21SZW5kZXJUcmVlKFxuICAgICAgICBpbnN0YW5jZS5kZWZpbml0aW9uLnN0YXRlLFxuICAgICAgICBpbnN0YW5jZS5zdGF0ZSxcbiAgICAgICAgYXJncyxcbiAgICAgICAgbW9kdWxlTmFtZVxuICAgICAgKTtcblxuICAgICAgbm9kZXMuZm9yRWFjaCgobm9kZSkgPT4ge1xuICAgICAgICBsZXQgeyBidWNrZXQgfSA9IG5vZGU7XG4gICAgICAgIHZtLmVudi5kZWJ1Z1JlbmRlclRyZWUhLmNyZWF0ZShidWNrZXQsIG5vZGUpO1xuXG4gICAgICAgIHJlZ2lzdGVyRGVzdHJ1Y3RvcihpbnN0YW5jZSwgKCkgPT4ge1xuICAgICAgICAgIHZtLmVudi5kZWJ1Z1JlbmRlclRyZWU/LndpbGxEZXN0cm95KGJ1Y2tldCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHZtLnVwZGF0ZVdpdGgobmV3IERlYnVnUmVuZGVyVHJlZVVwZGF0ZU9wY29kZShidWNrZXQpKTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBsZXQgbmFtZSA9IGRlZmluaXRpb24ucmVzb2x2ZWROYW1lID8/IG1hbmFnZXIuZ2V0RGVidWdOYW1lKGRlZmluaXRpb24uc3RhdGUpO1xuXG4gICAgICB2bS5lbnYuZGVidWdSZW5kZXJUcmVlLmNyZWF0ZShpbnN0YW5jZSwge1xuICAgICAgICB0eXBlOiAnY29tcG9uZW50JyxcbiAgICAgICAgbmFtZSxcbiAgICAgICAgYXJncyxcbiAgICAgICAgdGVtcGxhdGU6IG1vZHVsZU5hbWUsXG4gICAgICAgIGluc3RhbmNlOiB2YWx1ZUZvclJlZihzZWxmUmVmKSxcbiAgICAgIH0pO1xuXG4gICAgICB2bS5hc3NvY2lhdGVEZXN0cm95YWJsZShpbnN0YW5jZSk7XG5cbiAgICAgIHJlZ2lzdGVyRGVzdHJ1Y3RvcihpbnN0YW5jZSwgKCkgPT4ge1xuICAgICAgICB2bS5lbnYuZGVidWdSZW5kZXJUcmVlPy53aWxsRGVzdHJveShpbnN0YW5jZSk7XG4gICAgICB9KTtcblxuICAgICAgdm0udXBkYXRlV2l0aChuZXcgRGVidWdSZW5kZXJUcmVlVXBkYXRlT3Bjb2RlKGluc3RhbmNlKSk7XG4gICAgfVxuICB9XG5cbiAgdm0uc3RhY2sucHVzaChzZWxmUmVmKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuR2V0Q29tcG9uZW50VGFnTmFtZSwgKHZtLCB7IG9wMTogX3N0YXRlIH0pID0+IHtcbiAgbGV0IHsgZGVmaW5pdGlvbiwgc3RhdGUgfSA9IGNoZWNrKHZtLmZldGNoVmFsdWUoX3N0YXRlKSwgQ2hlY2tDb21wb25lbnRJbnN0YW5jZSk7XG4gIGxldCB7IG1hbmFnZXIgfSA9IGRlZmluaXRpb247XG5cbiAgbGV0IHRhZ05hbWUgPSAobWFuYWdlciBhcyBSZWNhc3Q8XG4gICAgSW50ZXJuYWxDb21wb25lbnRNYW5hZ2VyLFxuICAgIFdpdGhEeW5hbWljVGFnTmFtZTx1bmtub3duPlxuICA+KS5nZXRUYWdOYW1lKHN0YXRlKTtcblxuICAvLyBVc2VyIHByb3ZpZGVkIHZhbHVlIGZyb20gSlMsIHNvIHdlIGRvbid0IGJvdGhlciB0byBlbmNvZGVcbiAgdm0uc3RhY2sucHVzaCh0YWdOYW1lKTtcbn0pO1xuXG4vLyBEeW5hbWljIEludm9jYXRpb24gT25seVxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkdldENvbXBvbmVudExheW91dCwgKHZtLCB7IG9wMTogX3N0YXRlIH0pID0+IHtcbiAgbGV0IGluc3RhbmNlID0gY2hlY2sodm0uZmV0Y2hWYWx1ZShfc3RhdGUpLCBDaGVja0NvbXBvbmVudEluc3RhbmNlKTtcblxuICBsZXQgeyBtYW5hZ2VyLCBkZWZpbml0aW9uIH0gPSBpbnN0YW5jZTtcbiAgbGV0IHsgc3RhY2sgfSA9IHZtO1xuXG4gIGxldCB7IGNvbXBpbGFibGUgfSA9IGRlZmluaXRpb247XG5cbiAgaWYgKGNvbXBpbGFibGUgPT09IG51bGwpIHtcbiAgICBsZXQgeyBjYXBhYmlsaXRpZXMgfSA9IGluc3RhbmNlO1xuXG4gICAgYXNzZXJ0KFxuICAgICAgbWFuYWdlckhhc0NhcGFiaWxpdHkobWFuYWdlciwgY2FwYWJpbGl0aWVzLCBJbnRlcm5hbENvbXBvbmVudENhcGFiaWxpdHkuRHluYW1pY0xheW91dCksXG4gICAgICAnQlVHOiBObyB0ZW1wbGF0ZSB3YXMgZm91bmQgZm9yIHRoaXMgY29tcG9uZW50LCBhbmQgdGhlIGNvbXBvbmVudCBkaWQgbm90IGhhdmUgdGhlIGR5bmFtaWMgbGF5b3V0IGNhcGFiaWxpdHknXG4gICAgKTtcblxuICAgIGNvbXBpbGFibGUgPSBtYW5hZ2VyLmdldER5bmFtaWNMYXlvdXQoaW5zdGFuY2Uuc3RhdGUsIHZtLnJ1bnRpbWUucmVzb2x2ZXIpO1xuXG4gICAgaWYgKGNvbXBpbGFibGUgPT09IG51bGwpIHtcbiAgICAgIGlmIChtYW5hZ2VySGFzQ2FwYWJpbGl0eShtYW5hZ2VyLCBjYXBhYmlsaXRpZXMsIEludGVybmFsQ29tcG9uZW50Q2FwYWJpbGl0eS5XcmFwcGVkKSkge1xuICAgICAgICBjb21waWxhYmxlID0gdW53cmFwVGVtcGxhdGUodm1bQ09OU1RBTlRTXS5kZWZhdWx0VGVtcGxhdGUpLmFzV3JhcHBlZExheW91dCgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29tcGlsYWJsZSA9IHVud3JhcFRlbXBsYXRlKHZtW0NPTlNUQU5UU10uZGVmYXVsdFRlbXBsYXRlKS5hc0xheW91dCgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGxldCBoYW5kbGUgPSBjb21waWxhYmxlLmNvbXBpbGUodm0uY29udGV4dCk7XG5cbiAgc3RhY2sucHVzaChjb21waWxhYmxlLnN5bWJvbFRhYmxlKTtcbiAgc3RhY2sucHVzaChoYW5kbGUpO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5NYWluLCAodm0sIHsgb3AxOiByZWdpc3RlciB9KSA9PiB7XG4gIGxldCBkZWZpbml0aW9uID0gY2hlY2sodm0uc3RhY2sucG9wKCksIENoZWNrQ29tcG9uZW50RGVmaW5pdGlvbik7XG4gIGxldCBpbnZvY2F0aW9uID0gY2hlY2sodm0uc3RhY2sucG9wKCksIENoZWNrSW52b2NhdGlvbik7XG5cbiAgbGV0IHsgbWFuYWdlciwgY2FwYWJpbGl0aWVzIH0gPSBkZWZpbml0aW9uO1xuXG4gIGxldCBzdGF0ZTogUG9wdWxhdGVkQ29tcG9uZW50SW5zdGFuY2UgPSB7XG4gICAgZGVmaW5pdGlvbixcbiAgICBtYW5hZ2VyLFxuICAgIGNhcGFiaWxpdGllcyxcbiAgICBzdGF0ZTogbnVsbCxcbiAgICBoYW5kbGU6IGludm9jYXRpb24uaGFuZGxlLFxuICAgIHRhYmxlOiBpbnZvY2F0aW9uLnN5bWJvbFRhYmxlLFxuICAgIGxvb2t1cDogbnVsbCxcbiAgfTtcblxuICB2bS5sb2FkVmFsdWUocmVnaXN0ZXIsIHN0YXRlKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuUG9wdWxhdGVMYXlvdXQsICh2bSwgeyBvcDE6IF9zdGF0ZSB9KSA9PiB7XG4gIGxldCB7IHN0YWNrIH0gPSB2bTtcblxuICAvLyBJbiBERUJVRyBoYW5kbGVzIGNvdWxkIGJlIEVyckhhbmRsZSBvYmplY3RzXG4gIGxldCBoYW5kbGUgPSBjaGVjayhzdGFjay5wb3AoKSwgQ2hlY2tIYW5kbGUpO1xuICBsZXQgdGFibGUgPSBjaGVjayhzdGFjay5wb3AoKSwgQ2hlY2tQcm9ncmFtU3ltYm9sVGFibGUpO1xuXG4gIGxldCBzdGF0ZSA9IGNoZWNrKHZtLmZldGNoVmFsdWUoX3N0YXRlKSwgQ2hlY2tDb21wb25lbnRJbnN0YW5jZSk7XG5cbiAgc3RhdGUuaGFuZGxlID0gaGFuZGxlO1xuICBzdGF0ZS50YWJsZSA9IHRhYmxlO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5WaXJ0dWFsUm9vdFNjb3BlLCAodm0sIHsgb3AxOiBfc3RhdGUgfSkgPT4ge1xuICBsZXQgeyB0YWJsZSwgbWFuYWdlciwgY2FwYWJpbGl0aWVzLCBzdGF0ZSB9ID0gY2hlY2soXG4gICAgdm0uZmV0Y2hWYWx1ZShfc3RhdGUpLFxuICAgIENoZWNrRmluaXNoZWRDb21wb25lbnRJbnN0YW5jZVxuICApO1xuXG4gIGxldCBvd25lcjtcblxuICBpZiAobWFuYWdlckhhc0NhcGFiaWxpdHkobWFuYWdlciwgY2FwYWJpbGl0aWVzLCBJbnRlcm5hbENvbXBvbmVudENhcGFiaWxpdHkuSGFzU3ViT3duZXIpKSB7XG4gICAgb3duZXIgPSBtYW5hZ2VyLmdldE93bmVyKHN0YXRlKTtcbiAgICB2bS5sb2FkVmFsdWUoJHQxLCBudWxsKTsgLy8gQ2xlYXIgdGhlIHRlbXAgcmVnaXN0ZXJcbiAgfSBlbHNlIHtcbiAgICAvLyBDaGVjayB0aGUgdGVtcCByZWdpc3RlciB0byBzZWUgaWYgYW4gb3duZXIgd2FzIHJlc29sdmVkIGZyb20gY3VycnlpbmdcbiAgICBvd25lciA9IHZtLmZldGNoVmFsdWU8T3duZXIgfCBudWxsPigkdDEpO1xuXG4gICAgaWYgKG93bmVyID09PSBudWxsKSB7XG4gICAgICAvLyBJZiBhbiBvd25lciB3YXNuJ3QgZm91bmQsIGRlZmF1bHQgdG8gdXNpbmcgdGhlIGN1cnJlbnQgb3duZXIuIFRoaXNcbiAgICAgIC8vIHdpbGwgaGFwcGVuIGZvciBub3JtYWwgZHluYW1pYyBjb21wb25lbnQgaW52b2NhdGlvbixcbiAgICAgIC8vIGUuZy4gPFNvbWVDbGFzc2ljRW1iZXJDb21wb25lbnQvPlxuICAgICAgb3duZXIgPSB2bS5nZXRPd25lcigpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBFbHNlIHRoZSBvd25lciB3YXMgZm91bmQsIHNvIGNsZWFyIHRoZSB0ZW1wIHJlZ2lzdGVyLiBUaGlzIHdpbGwgaGFwcGVuXG4gICAgICAvLyBpZiB3ZSBhcmUgbG9hZGluZyBhIGN1cnJpZWQgY29tcG9uZW50LCBlLmcuIDxAc29tZUN1cnJpZWRDb21wb25lbnQvPlxuICAgICAgdm0ubG9hZFZhbHVlKCR0MSwgbnVsbCk7XG4gICAgfVxuICB9XG5cbiAgdm0ucHVzaFJvb3RTY29wZSh0YWJsZS5zeW1ib2xzLmxlbmd0aCArIDEsIG93bmVyKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuU2V0dXBGb3JFdmFsLCAodm0sIHsgb3AxOiBfc3RhdGUgfSkgPT4ge1xuICBsZXQgc3RhdGUgPSBjaGVjayh2bS5mZXRjaFZhbHVlKF9zdGF0ZSksIENoZWNrRmluaXNoZWRDb21wb25lbnRJbnN0YW5jZSk7XG5cbiAgaWYgKHN0YXRlLnRhYmxlLmhhc0V2YWwpIHtcbiAgICBsZXQgbG9va3VwID0gKHN0YXRlLmxvb2t1cCA9IGRpY3Q8U2NvcGVTbG90PigpKTtcbiAgICB2bS5zY29wZSgpLmJpbmRFdmFsU2NvcGUobG9va3VwKTtcbiAgfVxufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5TZXROYW1lZFZhcmlhYmxlcywgKHZtLCB7IG9wMTogX3N0YXRlIH0pID0+IHtcbiAgbGV0IHN0YXRlID0gY2hlY2sodm0uZmV0Y2hWYWx1ZShfc3RhdGUpLCBDaGVja0ZpbmlzaGVkQ29tcG9uZW50SW5zdGFuY2UpO1xuICBsZXQgc2NvcGUgPSB2bS5zY29wZSgpO1xuXG4gIGxldCBhcmdzID0gY2hlY2sodm0uc3RhY2sucGVlaygpLCBDaGVja0FyZ3VtZW50cyk7XG4gIGxldCBjYWxsZXJOYW1lcyA9IGFyZ3MubmFtZWQuYXROYW1lcztcblxuICBmb3IgKGxldCBpID0gY2FsbGVyTmFtZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICBsZXQgYXROYW1lID0gY2FsbGVyTmFtZXNbaV07XG4gICAgbGV0IHN5bWJvbCA9IHN0YXRlLnRhYmxlLnN5bWJvbHMuaW5kZXhPZihjYWxsZXJOYW1lc1tpXSk7XG4gICAgbGV0IHZhbHVlID0gYXJncy5uYW1lZC5nZXQoYXROYW1lLCB0cnVlKTtcblxuICAgIGlmIChzeW1ib2wgIT09IC0xKSBzY29wZS5iaW5kU3ltYm9sKHN5bWJvbCArIDEsIHZhbHVlKTtcbiAgICBpZiAoc3RhdGUubG9va3VwKSBzdGF0ZS5sb29rdXBbYXROYW1lXSA9IHZhbHVlO1xuICB9XG59KTtcblxuZnVuY3Rpb24gYmluZEJsb2NrKFxuICBzeW1ib2xOYW1lOiBzdHJpbmcsXG4gIGJsb2NrTmFtZTogc3RyaW5nLFxuICBzdGF0ZTogQ29tcG9uZW50SW5zdGFuY2UsXG4gIGJsb2NrczogQmxvY2tBcmd1bWVudHNJbXBsLFxuICB2bTogSW50ZXJuYWxWTVxuKSB7XG4gIGxldCBzeW1ib2wgPSBzdGF0ZS50YWJsZS5zeW1ib2xzLmluZGV4T2Yoc3ltYm9sTmFtZSk7XG4gIGxldCBibG9jayA9IGJsb2Nrcy5nZXQoYmxvY2tOYW1lKTtcblxuICBpZiAoc3ltYm9sICE9PSAtMSkgdm0uc2NvcGUoKS5iaW5kQmxvY2soc3ltYm9sICsgMSwgYmxvY2spO1xuICBpZiAoc3RhdGUubG9va3VwKSBzdGF0ZS5sb29rdXBbc3ltYm9sTmFtZV0gPSBibG9jaztcbn1cblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLlNldEJsb2NrcywgKHZtLCB7IG9wMTogX3N0YXRlIH0pID0+IHtcbiAgbGV0IHN0YXRlID0gY2hlY2sodm0uZmV0Y2hWYWx1ZShfc3RhdGUpLCBDaGVja0ZpbmlzaGVkQ29tcG9uZW50SW5zdGFuY2UpO1xuICBsZXQgeyBibG9ja3MgfSA9IGNoZWNrKHZtLnN0YWNrLnBlZWsoKSwgQ2hlY2tBcmd1bWVudHMpO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYmxvY2tzLm5hbWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgYmluZEJsb2NrKGJsb2Nrcy5zeW1ib2xOYW1lc1tpXSwgYmxvY2tzLm5hbWVzW2ldLCBzdGF0ZSwgYmxvY2tzLCB2bSk7XG4gIH1cbn0pO1xuXG4vLyBEeW5hbWljIEludm9jYXRpb24gT25seVxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkludm9rZUNvbXBvbmVudExheW91dCwgKHZtLCB7IG9wMTogX3N0YXRlIH0pID0+IHtcbiAgbGV0IHN0YXRlID0gY2hlY2sodm0uZmV0Y2hWYWx1ZShfc3RhdGUpLCBDaGVja0ZpbmlzaGVkQ29tcG9uZW50SW5zdGFuY2UpO1xuXG4gIHZtLmNhbGwoc3RhdGUuaGFuZGxlISk7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkRpZFJlbmRlckxheW91dCwgKHZtLCB7IG9wMTogX3N0YXRlIH0pID0+IHtcbiAgbGV0IGluc3RhbmNlID0gY2hlY2sodm0uZmV0Y2hWYWx1ZShfc3RhdGUpLCBDaGVja0NvbXBvbmVudEluc3RhbmNlKTtcbiAgbGV0IHsgbWFuYWdlciwgc3RhdGUsIGNhcGFiaWxpdGllcyB9ID0gaW5zdGFuY2U7XG4gIGxldCBib3VuZHMgPSB2bS5lbGVtZW50cygpLnBvcEJsb2NrKCk7XG5cbiAgaWYgKHZtLmVudi5kZWJ1Z1JlbmRlclRyZWUgIT09IHVuZGVmaW5lZCkge1xuICAgIGlmIChoYXNDdXN0b21EZWJ1Z1JlbmRlclRyZWVMaWZlY3ljbGUobWFuYWdlcikpIHtcbiAgICAgIGxldCBub2RlcyA9IG1hbmFnZXIuZ2V0RGVidWdDdXN0b21SZW5kZXJUcmVlKGluc3RhbmNlLmRlZmluaXRpb24uc3RhdGUsIHN0YXRlLCBFTVBUWV9BUkdTKTtcblxuICAgICAgbm9kZXMucmV2ZXJzZSgpLmZvckVhY2goKG5vZGUpID0+IHtcbiAgICAgICAgbGV0IHsgYnVja2V0IH0gPSBub2RlO1xuXG4gICAgICAgIHZtLmVudi5kZWJ1Z1JlbmRlclRyZWUhLmRpZFJlbmRlcihidWNrZXQsIGJvdW5kcyk7XG5cbiAgICAgICAgdm0udXBkYXRlV2l0aChuZXcgRGVidWdSZW5kZXJUcmVlRGlkUmVuZGVyT3Bjb2RlKGJ1Y2tldCwgYm91bmRzKSk7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdm0uZW52LmRlYnVnUmVuZGVyVHJlZS5kaWRSZW5kZXIoaW5zdGFuY2UsIGJvdW5kcyk7XG5cbiAgICAgIHZtLnVwZGF0ZVdpdGgobmV3IERlYnVnUmVuZGVyVHJlZURpZFJlbmRlck9wY29kZShpbnN0YW5jZSwgYm91bmRzKSk7XG4gICAgfVxuICB9XG5cbiAgaWYgKG1hbmFnZXJIYXNDYXBhYmlsaXR5KG1hbmFnZXIsIGNhcGFiaWxpdGllcywgSW50ZXJuYWxDb21wb25lbnRDYXBhYmlsaXR5LkNyZWF0ZUluc3RhbmNlKSkge1xuICAgIGxldCBtZ3IgPSBjaGVjayhtYW5hZ2VyLCBDaGVja0ludGVyZmFjZSh7IGRpZFJlbmRlckxheW91dDogQ2hlY2tGdW5jdGlvbiB9KSk7XG4gICAgbWdyLmRpZFJlbmRlckxheW91dChzdGF0ZSwgYm91bmRzKTtcblxuICAgIHZtLmVudi5kaWRDcmVhdGUoaW5zdGFuY2UgYXMgQ29tcG9uZW50SW5zdGFuY2VXaXRoQ3JlYXRlKTtcbiAgICB2bS51cGRhdGVXaXRoKG5ldyBEaWRVcGRhdGVMYXlvdXRPcGNvZGUoaW5zdGFuY2UgYXMgQ29tcG9uZW50SW5zdGFuY2VXaXRoQ3JlYXRlLCBib3VuZHMpKTtcbiAgfVxufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5Db21taXRDb21wb25lbnRUcmFuc2FjdGlvbiwgKHZtKSA9PiB7XG4gIHZtLmNvbW1pdENhY2hlR3JvdXAoKTtcbn0pO1xuXG5leHBvcnQgY2xhc3MgVXBkYXRlQ29tcG9uZW50T3Bjb2RlIGltcGxlbWVudHMgVXBkYXRpbmdPcGNvZGUge1xuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIGNvbXBvbmVudDogQ29tcG9uZW50SW5zdGFuY2VTdGF0ZSxcbiAgICBwcml2YXRlIG1hbmFnZXI6IFdpdGhVcGRhdGVIb29rLFxuICAgIHByaXZhdGUgZHluYW1pY1Njb3BlOiBPcHRpb248RHluYW1pY1Njb3BlPlxuICApIHt9XG5cbiAgZXZhbHVhdGUoX3ZtOiBVcGRhdGluZ1ZNKSB7XG4gICAgbGV0IHsgY29tcG9uZW50LCBtYW5hZ2VyLCBkeW5hbWljU2NvcGUgfSA9IHRoaXM7XG5cbiAgICBtYW5hZ2VyLnVwZGF0ZShjb21wb25lbnQsIGR5bmFtaWNTY29wZSk7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIERpZFVwZGF0ZUxheW91dE9wY29kZSBpbXBsZW1lbnRzIFVwZGF0aW5nT3Bjb2RlIHtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSBjb21wb25lbnQ6IENvbXBvbmVudEluc3RhbmNlV2l0aENyZWF0ZSwgcHJpdmF0ZSBib3VuZHM6IEJvdW5kcykge31cblxuICBldmFsdWF0ZSh2bTogVXBkYXRpbmdWTSkge1xuICAgIGxldCB7IGNvbXBvbmVudCwgYm91bmRzIH0gPSB0aGlzO1xuICAgIGxldCB7IG1hbmFnZXIsIHN0YXRlIH0gPSBjb21wb25lbnQ7XG5cbiAgICBtYW5hZ2VyLmRpZFVwZGF0ZUxheW91dChzdGF0ZSwgYm91bmRzKTtcblxuICAgIHZtLmVudi5kaWRVcGRhdGUoY29tcG9uZW50KTtcbiAgfVxufVxuXG5jbGFzcyBEZWJ1Z1JlbmRlclRyZWVVcGRhdGVPcGNvZGUgaW1wbGVtZW50cyBVcGRhdGluZ09wY29kZSB7XG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgYnVja2V0OiBvYmplY3QpIHt9XG5cbiAgZXZhbHVhdGUodm06IFVwZGF0aW5nVk0pIHtcbiAgICB2bS5lbnYuZGVidWdSZW5kZXJUcmVlPy51cGRhdGUodGhpcy5idWNrZXQpO1xuICB9XG59XG5cbmNsYXNzIERlYnVnUmVuZGVyVHJlZURpZFJlbmRlck9wY29kZSBpbXBsZW1lbnRzIFVwZGF0aW5nT3Bjb2RlIHtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSBidWNrZXQ6IG9iamVjdCwgcHJpdmF0ZSBib3VuZHM6IEJvdW5kcykge31cblxuICBldmFsdWF0ZSh2bTogVXBkYXRpbmdWTSkge1xuICAgIHZtLmVudi5kZWJ1Z1JlbmRlclRyZWU/LmRpZFJlbmRlcih0aGlzLmJ1Y2tldCwgdGhpcy5ib3VuZHMpO1xuICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9