import { DEBUG } from '@glimmer/env';
import { isConstRef, valueForRef } from '@glimmer/reference';
import { assert, assign, debugToString, dict, EMPTY_STRING_ARRAY, unwrapTemplate } from '@glimmer/util';
import { $t0, $t1 } from '@glimmer/vm';
import { registerDestructor } from '@glimmer/destroyable';
import { managerHasCapability } from '@glimmer/manager';
import { resolveComponent } from '../../component/resolve';
import { hasCustomDebugRenderTreeLifecycle } from '../../component/interfaces';
import { APPEND_OPCODES } from '../../opcodes';
import createClassListRef from '../../references/class-list';
import { ARGS, CONSTANTS } from '../../symbols';
import { EMPTY_ARGS } from '../../vm/arguments';
import { UpdateDynamicAttributeOpcode } from './dom';
import { isCurriedType, isCurriedValue, resolveCurriedValue } from '../../curried-value';
APPEND_OPCODES.add(78
/* PushComponentDefinition */
, (vm, {
  op1: handle
}) => {
  let definition = vm[CONSTANTS].getValue(handle);
  (false && assert(!!definition, `Missing component for ${handle}`));
  let {
    manager,
    capabilities
  } = definition;
  let instance = {
    definition,
    manager,
    capabilities,
    state: null,
    handle: null,
    table: null,
    lookup: null
  };
  vm.stack.push(instance);
});
APPEND_OPCODES.add(80
/* ResolveDynamicComponent */
, (vm, {
  op1: _isStrict
}) => {
  let stack = vm.stack;
  let component = valueForRef(stack.pop());
  let constants = vm[CONSTANTS];
  let owner = vm.getOwner();
  let isStrict = constants.getValue(_isStrict);
  vm.loadValue($t1, null); // Clear the temp register

  let definition;

  if (typeof component === 'string') {
    if (DEBUG && isStrict) {
      throw new Error(`Attempted to resolve a dynamic component with a string definition, \`${component}\` in a strict mode template. In strict mode, using strings to resolve component definitions is prohibited. You can instead import the component definition and use it directly.`);
    }

    let resolvedDefinition = resolveComponent(vm.runtime.resolver, constants, component, owner);
    definition = resolvedDefinition;
  } else if (isCurriedValue(component)) {
    definition = component;
  } else {
    definition = constants.component(component, owner);
  }

  stack.push(definition);
});
APPEND_OPCODES.add(81
/* ResolveCurriedComponent */
, vm => {
  let stack = vm.stack;
  let ref = stack.pop();
  let value = valueForRef(ref);
  let constants = vm[CONSTANTS];
  let definition;

  if (DEBUG && !(typeof value === 'function' || typeof value === 'object' && value !== null)) {
    throw new Error(`Expected a component definition, but received ${value}. You may have accidentally done <${ref.debugLabel}>, where "${ref.debugLabel}" was a string instead of a curried component definition. You must either use the component definition directly, or use the {{component}} helper to create a curried component definition when invoking dynamically.`);
  }

  if (isCurriedValue(value)) {
    definition = value;
  } else {
    definition = constants.component(value, vm.getOwner(), true);

    if (DEBUG && definition === null) {
      throw new Error(`Expected a dynamic component definition, but received an object or function that did not have a component manager associated with it. The dynamic invocation was \`<${ref.debugLabel}>\` or \`{{${ref.debugLabel}}}\`, and the incorrect definition is the value at the path \`${ref.debugLabel}\`, which was: ${debugToString(value)}`);
    }
  }

  stack.push(definition);
});
APPEND_OPCODES.add(79
/* PushDynamicComponentInstance */
, vm => {
  let {
    stack
  } = vm;
  let definition = stack.pop();
  let capabilities, manager;

  if (isCurriedValue(definition)) {
    manager = capabilities = null;
  } else {
    manager = definition.manager;
    capabilities = definition.capabilities;
  }

  stack.push({
    definition,
    capabilities,
    manager,
    state: null,
    handle: null,
    table: null
  });
});
APPEND_OPCODES.add(82
/* PushArgs */
, (vm, {
  op1: _names,
  op2: _blockNames,
  op3: flags
}) => {
  let stack = vm.stack;
  let names = vm[CONSTANTS].getArray(_names);
  let positionalCount = flags >> 4;
  let atNames = flags & 0b1000;
  let blockNames = flags & 0b0111 ? vm[CONSTANTS].getArray(_blockNames) : EMPTY_STRING_ARRAY;
  vm[ARGS].setup(stack, names, blockNames, positionalCount, !!atNames);
  stack.push(vm[ARGS]);
});
APPEND_OPCODES.add(83
/* PushEmptyArgs */
, vm => {
  let {
    stack
  } = vm;
  stack.push(vm[ARGS].empty(stack));
});
APPEND_OPCODES.add(86
/* CaptureArgs */
, vm => {
  let stack = vm.stack;
  let args = stack.pop();
  let capturedArgs = args.capture();
  stack.push(capturedArgs);
});
APPEND_OPCODES.add(85
/* PrepareArgs */
, (vm, {
  op1: _state
}) => {
  let stack = vm.stack;
  let instance = vm.fetchValue(_state);
  let args = stack.pop();
  let {
    definition
  } = instance;

  if (isCurriedType(definition, 0
  /* Component */
  )) {
    (false && assert(!definition.manager, "If the component definition was curried, we don't yet have a manager"));
    let constants = vm[CONSTANTS];
    let {
      definition: resolvedDefinition,
      owner,
      resolved,
      positional,
      named
    } = resolveCurriedValue(definition);

    if (resolved === true) {
      definition = resolvedDefinition;
    } else if (typeof resolvedDefinition === 'string') {
      let resolvedValue = vm.runtime.resolver.lookupComponent(resolvedDefinition, owner);
      definition = constants.resolvedComponent(resolvedValue, resolvedDefinition);
    } else {
      definition = constants.component(resolvedDefinition, owner);
    }

    if (named !== undefined) {
      args.named.merge(assign({}, ...named));
    }

    if (positional !== undefined) {
      args.realloc(positional.length);
      args.positional.prepend(positional);
    }

    let {
      manager
    } = definition;
    (false && assert(instance.manager === null, 'component instance manager should not be populated yet'));
    (false && assert(instance.capabilities === null, 'component instance manager should not be populated yet'));
    instance.definition = definition;
    instance.manager = manager;
    instance.capabilities = definition.capabilities; // Save off the owner that this component was curried with. Later on,
    // we'll fetch the value of this register and set it as the owner on the
    // new root scope.

    vm.loadValue($t1, owner);
  }

  let {
    manager,
    state
  } = definition;
  let capabilities = instance.capabilities;

  if (!managerHasCapability(manager, capabilities, 4
  /* PrepareArgs */
  )) {
    stack.push(args);
    return;
  }

  let blocks = args.blocks.values;
  let blockNames = args.blocks.names;
  let preparedArgs = manager.prepareArgs(state, args);

  if (preparedArgs) {
    args.clear();

    for (let i = 0; i < blocks.length; i++) {
      stack.push(blocks[i]);
    }

    let {
      positional,
      named
    } = preparedArgs;
    let positionalCount = positional.length;

    for (let i = 0; i < positionalCount; i++) {
      stack.push(positional[i]);
    }

    let names = Object.keys(named);

    for (let i = 0; i < names.length; i++) {
      stack.push(named[names[i]]);
    }

    args.setup(stack, names, blockNames, positionalCount, false);
  }

  stack.push(args);
});
APPEND_OPCODES.add(87
/* CreateComponent */
, (vm, {
  op1: flags,
  op2: _state
}) => {
  let instance = vm.fetchValue(_state);
  let {
    definition,
    manager,
    capabilities
  } = instance;

  if (!managerHasCapability(manager, capabilities, 512
  /* CreateInstance */
  )) {
    // TODO: Closure and Main components are always invoked dynamically, so this
    // opcode may run even if this capability is not enabled. In the future we
    // should handle this in a better way.
    return;
  }

  let dynamicScope = null;

  if (managerHasCapability(manager, capabilities, 64
  /* DynamicScope */
  )) {
    dynamicScope = vm.dynamicScope();
  }

  let hasDefaultBlock = flags & 1;
  let args = null;

  if (managerHasCapability(manager, capabilities, 8
  /* CreateArgs */
  )) {
    args = vm.stack.peek();
  }

  let self = null;

  if (managerHasCapability(manager, capabilities, 128
  /* CreateCaller */
  )) {
    self = vm.getSelf();
  }

  let state = manager.create(vm.getOwner(), definition.state, args, vm.env, dynamicScope, self, !!hasDefaultBlock); // We want to reuse the `state` POJO here, because we know that the opcodes
  // only transition at exactly one place.

  instance.state = state;

  if (managerHasCapability(manager, capabilities, 256
  /* UpdateHook */
  )) {
    vm.updateWith(new UpdateComponentOpcode(state, manager, dynamicScope));
  }
});
APPEND_OPCODES.add(88
/* RegisterComponentDestructor */
, (vm, {
  op1: _state
}) => {
  let {
    manager,
    state,
    capabilities
  } = vm.fetchValue(_state);
  let d = manager.getDestroyable(state);

  if (DEBUG && !managerHasCapability(manager, capabilities, 2048
  /* WillDestroy */
  ) && d !== null && typeof 'willDestroy' in d) {
    throw new Error('BUG: Destructor has willDestroy, but the willDestroy capability was not enabled for this component. Pre-destruction hooks must be explicitly opted into');
  }

  if (d) vm.associateDestroyable(d);
});
APPEND_OPCODES.add(97
/* BeginComponentTransaction */
, (vm, {
  op1: _state
}) => {
  var _a;

  let name;

  if (DEBUG) {
    let {
      definition,
      manager
    } = vm.fetchValue(_state);
    name = (_a = definition.resolvedName) !== null && _a !== void 0 ? _a : manager.getDebugName(definition.state);
  }

  vm.beginCacheGroup(name);
  vm.elements().pushSimpleBlock();
});
APPEND_OPCODES.add(89
/* PutComponentOperations */
, vm => {
  vm.loadValue($t0, new ComponentElementOperations());
});
APPEND_OPCODES.add(53
/* ComponentAttr */
, (vm, {
  op1: _name,
  op2: _trusting,
  op3: _namespace
}) => {
  let name = vm[CONSTANTS].getValue(_name);
  let trusting = vm[CONSTANTS].getValue(_trusting);
  let reference = vm.stack.pop();
  let namespace = _namespace ? vm[CONSTANTS].getValue(_namespace) : null;
  vm.fetchValue($t0).setAttribute(name, reference, trusting, namespace);
});
APPEND_OPCODES.add(105
/* StaticComponentAttr */
, (vm, {
  op1: _name,
  op2: _value,
  op3: _namespace
}) => {
  let name = vm[CONSTANTS].getValue(_name);
  let value = vm[CONSTANTS].getValue(_value);
  let namespace = _namespace ? vm[CONSTANTS].getValue(_namespace) : null;
  vm.fetchValue($t0).setStaticAttribute(name, value, namespace);
});
export class ComponentElementOperations {
  constructor() {
    this.attributes = dict();
    this.classes = [];
    this.modifiers = [];
  }

  setAttribute(name, value, trusting, namespace) {
    let deferred = {
      value,
      namespace,
      trusting
    };

    if (name === 'class') {
      this.classes.push(value);
    }

    this.attributes[name] = deferred;
  }

  setStaticAttribute(name, value, namespace) {
    let deferred = {
      value,
      namespace
    };

    if (name === 'class') {
      this.classes.push(value);
    }

    this.attributes[name] = deferred;
  }

  addModifier(modifier) {
    this.modifiers.push(modifier);
  }

  flush(vm) {
    let type;
    let attributes = this.attributes;

    for (let name in this.attributes) {
      if (name === 'type') {
        type = attributes[name];
        continue;
      }

      let attr = this.attributes[name];

      if (name === 'class') {
        setDeferredAttr(vm, 'class', mergeClasses(this.classes), attr.namespace, attr.trusting);
      } else {
        setDeferredAttr(vm, name, attr.value, attr.namespace, attr.trusting);
      }
    }

    if (type !== undefined) {
      setDeferredAttr(vm, 'type', type.value, type.namespace, type.trusting);
    }

    return this.modifiers;
  }

}

function mergeClasses(classes) {
  if (classes.length === 0) {
    return '';
  }

  if (classes.length === 1) {
    return classes[0];
  }

  if (allStringClasses(classes)) {
    return classes.join(' ');
  }

  return createClassListRef(classes);
}

function allStringClasses(classes) {
  for (let i = 0; i < classes.length; i++) {
    if (typeof classes[i] !== 'string') {
      return false;
    }
  }

  return true;
}

function setDeferredAttr(vm, name, value, namespace, trusting = false) {
  if (typeof value === 'string') {
    vm.elements().setStaticAttribute(name, value, namespace);
  } else {
    let attribute = vm.elements().setDynamicAttribute(name, valueForRef(value), trusting, namespace);

    if (!isConstRef(value)) {
      vm.updateWith(new UpdateDynamicAttributeOpcode(value, attribute, vm.env));
    }
  }
}

APPEND_OPCODES.add(99
/* DidCreateElement */
, (vm, {
  op1: _state
}) => {
  let {
    definition,
    state
  } = vm.fetchValue(_state);
  let {
    manager
  } = definition;
  let operations = vm.fetchValue($t0);
  manager.didCreateElement(state, vm.elements().constructing, operations);
});
APPEND_OPCODES.add(90
/* GetComponentSelf */
, (vm, {
  op1: _state,
  op2: _names
}) => {
  var _a;

  let instance = vm.fetchValue(_state);
  let {
    definition,
    state
  } = instance;
  let {
    manager
  } = definition;
  let selfRef = manager.getSelf(state);

  if (vm.env.debugRenderTree !== undefined) {
    let instance = vm.fetchValue(_state);
    let {
      definition,
      manager
    } = instance;
    let args;

    if (vm.stack.peek() === vm[ARGS]) {
      args = vm[ARGS].capture();
    } else {
      let names = vm[CONSTANTS].getArray(_names);
      vm[ARGS].setup(vm.stack, names, [], 0, true);
      args = vm[ARGS].capture();
    }

    let moduleName;
    let compilable = definition.compilable;

    if (compilable === null) {
      (false && assert(managerHasCapability(manager, instance.capabilities, 1
      /* DynamicLayout */
      ), 'BUG: No template was found for this component, and the component did not have the dynamic layout capability'));
      compilable = manager.getDynamicLayout(state, vm.runtime.resolver);

      if (compilable !== null) {
        moduleName = compilable.moduleName;
      } else {
        moduleName = '__default__.hbs';
      }
    } else {
      moduleName = compilable.moduleName;
    } // For tearing down the debugRenderTree


    vm.associateDestroyable(instance);

    if (hasCustomDebugRenderTreeLifecycle(manager)) {
      let nodes = manager.getDebugCustomRenderTree(instance.definition.state, instance.state, args, moduleName);
      nodes.forEach(node => {
        let {
          bucket
        } = node;
        vm.env.debugRenderTree.create(bucket, node);
        registerDestructor(instance, () => {
          var _a;

          (_a = vm.env.debugRenderTree) === null || _a === void 0 ? void 0 : _a.willDestroy(bucket);
        });
        vm.updateWith(new DebugRenderTreeUpdateOpcode(bucket));
      });
    } else {
      let name = (_a = definition.resolvedName) !== null && _a !== void 0 ? _a : manager.getDebugName(definition.state);
      vm.env.debugRenderTree.create(instance, {
        type: 'component',
        name,
        args,
        template: moduleName,
        instance: valueForRef(selfRef)
      });
      vm.associateDestroyable(instance);
      registerDestructor(instance, () => {
        var _a;

        (_a = vm.env.debugRenderTree) === null || _a === void 0 ? void 0 : _a.willDestroy(instance);
      });
      vm.updateWith(new DebugRenderTreeUpdateOpcode(instance));
    }
  }

  vm.stack.push(selfRef);
});
APPEND_OPCODES.add(91
/* GetComponentTagName */
, (vm, {
  op1: _state
}) => {
  let {
    definition,
    state
  } = vm.fetchValue(_state);
  let {
    manager
  } = definition;
  let tagName = manager.getTagName(state); // User provided value from JS, so we don't bother to encode

  vm.stack.push(tagName);
}); // Dynamic Invocation Only

APPEND_OPCODES.add(92
/* GetComponentLayout */
, (vm, {
  op1: _state
}) => {
  let instance = vm.fetchValue(_state);
  let {
    manager,
    definition
  } = instance;
  let {
    stack
  } = vm;
  let {
    compilable
  } = definition;

  if (compilable === null) {
    let {
      capabilities
    } = instance;
    (false && assert(managerHasCapability(manager, capabilities, 1
    /* DynamicLayout */
    ), 'BUG: No template was found for this component, and the component did not have the dynamic layout capability'));
    compilable = manager.getDynamicLayout(instance.state, vm.runtime.resolver);

    if (compilable === null) {
      if (managerHasCapability(manager, capabilities, 1024
      /* Wrapped */
      )) {
        compilable = unwrapTemplate(vm[CONSTANTS].defaultTemplate).asWrappedLayout();
      } else {
        compilable = unwrapTemplate(vm[CONSTANTS].defaultTemplate).asLayout();
      }
    }
  }

  let handle = compilable.compile(vm.context);
  stack.push(compilable.symbolTable);
  stack.push(handle);
});
APPEND_OPCODES.add(75
/* Main */
, (vm, {
  op1: register
}) => {
  let definition = vm.stack.pop();
  let invocation = vm.stack.pop();
  let {
    manager,
    capabilities
  } = definition;
  let state = {
    definition,
    manager,
    capabilities,
    state: null,
    handle: invocation.handle,
    table: invocation.symbolTable,
    lookup: null
  };
  vm.loadValue(register, state);
});
APPEND_OPCODES.add(95
/* PopulateLayout */
, (vm, {
  op1: _state
}) => {
  let {
    stack
  } = vm; // In DEBUG handles could be ErrHandle objects

  let handle = stack.pop();
  let table = stack.pop();
  let state = vm.fetchValue(_state);
  state.handle = handle;
  state.table = table;
});
APPEND_OPCODES.add(38
/* VirtualRootScope */
, (vm, {
  op1: _state
}) => {
  let {
    table,
    manager,
    capabilities,
    state
  } = vm.fetchValue(_state);
  let owner;

  if (managerHasCapability(manager, capabilities, 4096
  /* HasSubOwner */
  )) {
    owner = manager.getOwner(state);
    vm.loadValue($t1, null); // Clear the temp register
  } else {
    // Check the temp register to see if an owner was resolved from currying
    owner = vm.fetchValue($t1);

    if (owner === null) {
      // If an owner wasn't found, default to using the current owner. This
      // will happen for normal dynamic component invocation,
      // e.g. <SomeClassicEmberComponent/>
      owner = vm.getOwner();
    } else {
      // Else the owner was found, so clear the temp register. This will happen
      // if we are loading a curried component, e.g. <@someCurriedComponent/>
      vm.loadValue($t1, null);
    }
  }

  vm.pushRootScope(table.symbols.length + 1, owner);
});
APPEND_OPCODES.add(94
/* SetupForEval */
, (vm, {
  op1: _state
}) => {
  let state = vm.fetchValue(_state);

  if (state.table.hasEval) {
    let lookup = state.lookup = dict();
    vm.scope().bindEvalScope(lookup);
  }
});
APPEND_OPCODES.add(17
/* SetNamedVariables */
, (vm, {
  op1: _state
}) => {
  let state = vm.fetchValue(_state);
  let scope = vm.scope();
  let args = vm.stack.peek();
  let callerNames = args.named.atNames;

  for (let i = callerNames.length - 1; i >= 0; i--) {
    let atName = callerNames[i];
    let symbol = state.table.symbols.indexOf(callerNames[i]);
    let value = args.named.get(atName, true);
    if (symbol !== -1) scope.bindSymbol(symbol + 1, value);
    if (state.lookup) state.lookup[atName] = value;
  }
});

function bindBlock(symbolName, blockName, state, blocks, vm) {
  let symbol = state.table.symbols.indexOf(symbolName);
  let block = blocks.get(blockName);
  if (symbol !== -1) vm.scope().bindBlock(symbol + 1, block);
  if (state.lookup) state.lookup[symbolName] = block;
}

APPEND_OPCODES.add(18
/* SetBlocks */
, (vm, {
  op1: _state
}) => {
  let state = vm.fetchValue(_state);
  let {
    blocks
  } = vm.stack.peek();

  for (let i = 0; i < blocks.names.length; i++) {
    bindBlock(blocks.symbolNames[i], blocks.names[i], state, blocks, vm);
  }
}); // Dynamic Invocation Only

APPEND_OPCODES.add(96
/* InvokeComponentLayout */
, (vm, {
  op1: _state
}) => {
  let state = vm.fetchValue(_state);
  vm.call(state.handle);
});
APPEND_OPCODES.add(100
/* DidRenderLayout */
, (vm, {
  op1: _state
}) => {
  let instance = vm.fetchValue(_state);
  let {
    manager,
    state,
    capabilities
  } = instance;
  let bounds = vm.elements().popBlock();

  if (vm.env.debugRenderTree !== undefined) {
    if (hasCustomDebugRenderTreeLifecycle(manager)) {
      let nodes = manager.getDebugCustomRenderTree(instance.definition.state, state, EMPTY_ARGS);
      nodes.reverse().forEach(node => {
        let {
          bucket
        } = node;
        vm.env.debugRenderTree.didRender(bucket, bounds);
        vm.updateWith(new DebugRenderTreeDidRenderOpcode(bucket, bounds));
      });
    } else {
      vm.env.debugRenderTree.didRender(instance, bounds);
      vm.updateWith(new DebugRenderTreeDidRenderOpcode(instance, bounds));
    }
  }

  if (managerHasCapability(manager, capabilities, 512
  /* CreateInstance */
  )) {
    let mgr = manager;
    mgr.didRenderLayout(state, bounds);
    vm.env.didCreate(instance);
    vm.updateWith(new DidUpdateLayoutOpcode(instance, bounds));
  }
});
APPEND_OPCODES.add(98
/* CommitComponentTransaction */
, vm => {
  vm.commitCacheGroup();
});
export class UpdateComponentOpcode {
  constructor(component, manager, dynamicScope) {
    this.component = component;
    this.manager = manager;
    this.dynamicScope = dynamicScope;
  }

  evaluate(_vm) {
    let {
      component,
      manager,
      dynamicScope
    } = this;
    manager.update(component, dynamicScope);
  }

}
export class DidUpdateLayoutOpcode {
  constructor(component, bounds) {
    this.component = component;
    this.bounds = bounds;
  }

  evaluate(vm) {
    let {
      component,
      bounds
    } = this;
    let {
      manager,
      state
    } = component;
    manager.didUpdateLayout(state, bounds);
    vm.env.didUpdate(component);
  }

}

class DebugRenderTreeUpdateOpcode {
  constructor(bucket) {
    this.bucket = bucket;
  }

  evaluate(vm) {
    var _a;

    (_a = vm.env.debugRenderTree) === null || _a === void 0 ? void 0 : _a.update(this.bucket);
  }

}

class DebugRenderTreeDidRenderOpcode {
  constructor(bucket, bounds) {
    this.bucket = bucket;
    this.bounds = bounds;
  }

  evaluate(vm) {
    var _a;

    (_a = vm.env.debugRenderTree) === null || _a === void 0 ? void 0 : _a.didRender(this.bucket, this.bounds);
  }

}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL3J1bnRpbWUvbGliL2NvbXBpbGVkL29wY29kZXMvY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQVVBLFNBQVMsS0FBVCxRQUFzQixjQUF0QjtBQTZCQSxTQUFTLFVBQVQsRUFBZ0MsV0FBaEMsUUFBbUQsb0JBQW5EO0FBQ0EsU0FDRSxNQURGLEVBRUUsTUFGRixFQUdFLGFBSEYsRUFJRSxJQUpGLEVBS0Usa0JBTEYsRUFPRSxjQVBGLFFBUU8sZUFSUDtBQVNBLFNBQVMsR0FBVCxFQUFjLEdBQWQsUUFBeUIsYUFBekI7QUFDQSxTQUFTLGtCQUFULFFBQW1DLHNCQUFuQztBQUNBLFNBQVMsb0JBQVQsUUFBcUMsa0JBQXJDO0FBQ0EsU0FBUyxnQkFBVCxRQUFpQyx5QkFBakM7QUFDQSxTQUFTLGlDQUFULFFBQWtELDRCQUFsRDtBQUNBLFNBQVMsY0FBVCxRQUErQixlQUEvQjtBQUNBLE9BQU8sa0JBQVAsTUFBK0IsNkJBQS9CO0FBQ0EsU0FBUyxJQUFULEVBQWUsU0FBZixRQUFnQyxlQUFoQztBQUdBLFNBQTZCLFVBQTdCLFFBQWdFLG9CQUFoRTtBQVVBLFNBQVMsNEJBQVQsUUFBNkMsT0FBN0M7QUFDQSxTQUVFLGFBRkYsRUFHRSxjQUhGLEVBSUUsbUJBSkYsUUFLTyxxQkFMUDtBQTBDQSxjQUFjLENBQUMsR0FBZixDQUFrQjtBQUFBO0FBQWxCLEVBQStDLENBQUMsRUFBRCxFQUFLO0FBQUUsRUFBQSxHQUFHLEVBQUU7QUFBUCxDQUFMLEtBQXdCO0FBQ3JFLE1BQUksVUFBVSxHQUFHLEVBQUUsQ0FBQyxTQUFELENBQUYsQ0FBYyxRQUFkLENBQTRDLE1BQTVDLENBQWpCO0FBRHFFLFlBRXJFLE1BQU0sQ0FBQyxDQUFDLENBQUMsVUFBSCxFQUFlLHlCQUF5QixNQUFNLEVBQTlDLENBRitEO0FBSXJFLE1BQUk7QUFBRSxJQUFBLE9BQUY7QUFBVyxJQUFBO0FBQVgsTUFBNEIs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RDs7QUFWK0I7O0FBYWxDLE1BQU0sMkJBQU4sQ0FBaUM7QUFDL0IsRUFBQSxXQUFBLENBQW9CLE1BQXBCLEVBQWtDO0FBQWQsU0FBQSxNQUFBLEdBQUEsTUFBQTtBQUFrQjs7QUFFdEMsRUFBQSxRQUFRLENBQUMsRUFBRCxFQUFlOzs7QUFDckIsS0FBQSxFQUFBLEdBQUEsRUFBRSxDQUFDLEdBQUgsQ0FBTyxlQUFQLE1BQXNCLElBQXRCLElBQXNCLEVBQUEsS0FBQSxLQUFBLENBQXRCLEdBQXNCLEtBQUEsQ0FBdEIsR0FBc0IsRUFBQSxDQUFFLE1BQUYsQ0FBUyxLQUFLLE1BQWQsQ0FBdEI7QUFDRDs7QUFMOEI7O0FBUWpDLE1BQU0sOEJBQU4sQ0FBb0M7QUFDbEMsRUFBQSxXQUFBLENBQW9CLE1BQXBCLEVBQTRDLE1BQTVDLEVBQTBEO0FBQXRDLFNBQUEsTUFBQSxHQUFBLE1BQUE7QUFBd0IsU0FBQSxNQUFBLEdBQUEsTUFBQTtBQUFrQjs7QUFFOUQsRUFBQSxRQUFRLENBQUMsRUFBRCxFQUFlOzs7QUFDckIsS0FBQSxFQUFBLEdBQUEsRUFBRSxDQUFDLEdBQUgsQ0FBTyxlQUFQLE1BQXNCLElBQXRCLElBQXNCLEVBQUEsS0FBQSxLQUFBLENBQXRCLEdBQXNCLEtBQUEsQ0FBdEIsR0FBc0IsRUFBQSxDQUFFLFNBQUYsQ0FBWSxLQUFLLE1BQWpCLEVBQXlCLEtBQUssTUFBOUIsQ0FBdEI7QUFDRDs7QUFMaUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBjaGVjayxcbiAgQ2hlY2tGdW5jdGlvbixcbiAgQ2hlY2tIYW5kbGUsXG4gIENoZWNrSW5zdGFuY2VvZixcbiAgQ2hlY2tJbnRlcmZhY2UsXG4gIENoZWNrUHJvZ3JhbVN5bWJvbFRhYmxlLFxuICBDaGVja1N0cmluZyxcbiAgQ2hlY2tPcixcbn0gZnJvbSAnQGdsaW1tZXIvZGVidWcnO1xuaW1wb3J0IHsgREVCVUcgfSBmcm9tICdAZ2xpbW1lci9lbnYnO1xuaW1wb3J0IHtcbiAgQm91bmRzLFxuICBDb21wb25lbnREZWZpbml0aW9uLFxuICBJbnRlcm5hbENvbXBvbmVudENhcGFiaWxpdHksXG4gIENvbXBvbmVudERlZmluaXRpb25TdGF0ZSxcbiAgQ29tcG9uZW50SW5zdGFuY2VTdGF0ZSxcbiAgSW50ZXJuYWxDb21wb25lbnRNYW5hZ2VyLFxuICBEaWN0LFxuICBEeW5hbWljU2NvcGUsXG4gIEVsZW1lbnRPcGVyYXRpb25zLFxuICBPcCxcbiAgT3B0aW9uLFxuICBQcm9ncmFtU3ltYm9sVGFibGUsXG4gIFJlY2FzdCxcbiAgU2NvcGVTbG90LFxuICBWTUFyZ3VtZW50cyxcbiAgV2l0aER5bmFtaWNUYWdOYW1lLFxuICBXaXRoRWxlbWVudEhvb2ssXG4gIFdpdGhVcGRhdGVIb29rLFxuICBDYXB0dXJlZEFyZ3VtZW50cyxcbiAgQ29tcGlsYWJsZVByb2dyYW0sXG4gIENvbXBvbmVudEluc3RhbmNlLFxuICBNb2RpZmllckluc3RhbmNlLFxuICBDb21wb25lbnRJbnN0YW5jZVdpdGhDcmVhdGUsXG4gIE93bmVyLFxuICBDdXJyaWVkVHlwZSxcbiAgVXBkYXRpbmdPcGNvZGUsXG59IGZyb20gJ0BnbGltbWVyL2ludGVyZmFjZXMnO1xuaW1wb3J0IHsgaXNDb25zdFJlZiwgUmVmZXJlbmNlLCB2YWx1ZUZvclJlZiB9IGZyb20gJ0BnbGltbWVyL3JlZmVyZW5jZSc7XG5pbXBvcnQge1xuICBhc3NlcnQsXG4gIGFzc2lnbixcbiAgZGVidWdUb1N0cmluZyxcbiAgZGljdCxcbiAgRU1QVFlfU1RSSU5HX0FSUkFZLFxuICBleHBlY3QsXG4gIHVud3JhcFRlbXBsYXRlLFxufSBmcm9tICdAZ2xpbW1lci91dGlsJztcbmltcG9ydCB7ICR0MCwgJHQxIH0gZnJvbSAnQGdsaW1tZXIvdm0nO1xuaW1wb3J0IHsgcmVnaXN0ZXJEZXN0cnVjdG9yIH0gZnJvbSAnQGdsaW1tZXIvZGVzdHJveWFibGUnO1xuaW1wb3J0IHsgbWFuYWdlckhhc0NhcGFiaWxpdHkgfSBmcm9tICdAZ2xpbW1lci9tYW5hZ2VyJztcbmltcG9ydCB7IHJlc29sdmVDb21wb25lbnQgfSBmcm9tICcuLi8uLi9jb21wb25lbnQvcmVzb2x2ZSc7XG5pbXBvcnQgeyBoYXNDdXN0b21EZWJ1Z1JlbmRlclRyZWVMaWZlY3ljbGUgfSBmcm9tICcuLi8uLi9jb21wb25lbnQvaW50ZXJmYWNlcyc7XG5pbXBvcnQgeyBBUFBFTkRfT1BDT0RFUyB9IGZyb20gJy4uLy4uL29wY29kZXMnO1xuaW1wb3J0IGNyZWF0ZUNsYXNzTGlzdFJlZiBmcm9tICcuLi8uLi9yZWZlcmVuY2VzL2NsYXNzLWxpc3QnO1xuaW1wb3J0IHsgQVJHUywgQ09OU1RBTlRTIH0gZnJvbSAnLi4vLi4vc3ltYm9scyc7XG5pbXBvcnQgeyBVcGRhdGluZ1ZNIH0gZnJvbSAnLi4vLi4vdm0nO1xuaW1wb3J0IHsgSW50ZXJuYWxWTSB9IGZyb20gJy4uLy4uL3ZtL2FwcGVuZCc7XG5pbXBvcnQgeyBCbG9ja0FyZ3VtZW50c0ltcGwsIEVNUFRZX0FSR1MsIFZNQXJndW1lbnRzSW1wbCB9IGZyb20gJy4uLy4uL3ZtL2FyZ3VtZW50cyc7XG5pbXBvcnQge1xuICBDaGVja0FyZ3VtZW50cyxcbiAgQ2hlY2tDb21wb25lbnREZWZpbml0aW9uLFxuICBDaGVja0NvbXBvbmVudEluc3RhbmNlLFxuICBDaGVja0ZpbmlzaGVkQ29tcG9uZW50SW5zdGFuY2UsXG4gIENoZWNrSW52b2NhdGlvbixcbiAgQ2hlY2tSZWZlcmVuY2UsXG4gIENoZWNrQ3VycmllZENvbXBvbmVudERlZmluaXRpb24sXG59IGZyb20gJy4vLWRlYnVnLXN0cmlwJztcbmltcG9ydCB7IFVwZGF0ZUR5bmFtaWNBdHRyaWJ1dGVPcGNvZGUgfSBmcm9tICcuL2RvbSc7XG5pbXBvcnQge1xuICBDdXJyaWVkVmFsdWUsXG4gIGlzQ3VycmllZFR5cGUsXG4gIGlzQ3VycmllZFZhbHVlLFxuICByZXNvbHZlQ3VycmllZFZhbHVlLFxufSBmcm9tICcuLi8uLi9jdXJyaWVkLXZhbHVlJztcblxuLyoqXG4gKiBUaGUgVk0gY3JlYXRlcyBhIG5ldyBDb21wb25lbnRJbnN0YW5jZSBkYXRhIHN0cnVjdHVyZSBmb3IgZXZlcnkgY29tcG9uZW50XG4gKiBpbnZvY2F0aW9uIGl0IGVuY291bnRlcnMuXG4gKlxuICogU2ltaWxhciB0byBob3cgYSBDb21wb25lbnREZWZpbml0aW9uIGNvbnRhaW5zIHN0YXRlIGFib3V0IGFsbCBjb21wb25lbnRzIG9mIGFcbiAqIHBhcnRpY3VsYXIgdHlwZSwgYSBDb21wb25lbnRJbnN0YW5jZSBjb250YWlucyBzdGF0ZSBzcGVjaWZpYyB0byBhIHBhcnRpY3VsYXJcbiAqIGluc3RhbmNlIG9mIGEgY29tcG9uZW50IHR5cGUuIEl0IGFsc28gY29udGFpbnMgYSBwb2ludGVyIGJhY2sgdG8gaXRzXG4gKiBjb21wb25lbnQgdHlwZSdzIENvbXBvbmVudERlZmluaXRpb24uXG4gKi9cblxuZXhwb3J0IGludGVyZmFjZSBJbml0aWFsQ29tcG9uZW50SW5zdGFuY2Uge1xuICBkZWZpbml0aW9uOiBDb21wb25lbnREZWZpbml0aW9uO1xuICBtYW5hZ2VyOiBPcHRpb248SW50ZXJuYWxDb21wb25lbnRNYW5hZ2VyPjtcbiAgY2FwYWJpbGl0aWVzOiBPcHRpb248SW50ZXJuYWxDb21wb25lbnRDYXBhYmlsaXR5PjtcbiAgc3RhdGU6IG51bGw7XG4gIGhhbmRsZTogT3B0aW9uPG51bWJlcj47XG4gIHRhYmxlOiBPcHRpb248UHJvZ3JhbVN5bWJvbFRhYmxlPjtcbiAgbG9va3VwOiBPcHRpb248RGljdDxTY29wZVNsb3Q+Pjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQb3B1bGF0ZWRDb21wb25lbnRJbnN0YW5jZSB7XG4gIGRlZmluaXRpb246IENvbXBvbmVudERlZmluaXRpb247XG4gIG1hbmFnZXI6IEludGVybmFsQ29tcG9uZW50TWFuYWdlcjtcbiAgY2FwYWJpbGl0aWVzOiBJbnRlcm5hbENvbXBvbmVudENhcGFiaWxpdHk7XG4gIHN0YXRlOiBudWxsO1xuICBoYW5kbGU6IG51bWJlcjtcbiAgdGFibGU6IE9wdGlvbjxQcm9ncmFtU3ltYm9sVGFibGU+O1xuICBsb29rdXA6IE9wdGlvbjxEaWN0PFNjb3BlU2xvdD4+O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFBhcnRpYWxDb21wb25lbnREZWZpbml0aW9uIHtcbiAgc3RhdGU6IE9wdGlvbjxDb21wb25lbnREZWZpbml0aW9uU3RhdGU+O1xuICBtYW5hZ2VyOiBJbnRlcm5hbENvbXBvbmVudE1hbmFnZXI7XG59XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5QdXNoQ29tcG9uZW50RGVmaW5pdGlvbiwgKHZtLCB7IG9wMTogaGFuZGxlIH0pID0+IHtcbiAgbGV0IGRlZmluaXRpb24gPSB2bVtDT05TVEFOVFNdLmdldFZhbHVlPENvbXBvbmVudERlZmluaXRpb24+KGhhbmRsZSk7XG4gIGFzc2VydCghIWRlZmluaXRpb24sIGBNaXNzaW5nIGNvbXBvbmVudCBmb3IgJHtoYW5kbGV9YCk7XG5cbiAgbGV0IHsgbWFuYWdlciwgY2FwYWJpbGl0aWVzIH0gPSBkZWZpbml0aW9uO1xuXG4gIGxldCBpbnN0YW5jZTogSW5pdGlhbENvbXBvbmVudEluc3RhbmNlID0ge1xuICAgIGRlZmluaXRpb24sXG4gICAgbWFuYWdlcixcbiAgICBjYXBhYmlsaXRpZXMsXG4gICAgc3RhdGU6IG51bGwsXG4gICAgaGFuZGxlOiBudWxsLFxuICAgIHRhYmxlOiBudWxsLFxuICAgIGxvb2t1cDogbnVsbCxcbiAgfTtcblxuICB2bS5zdGFjay5wdXNoKGluc3RhbmNlKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuUmVzb2x2ZUR5bmFtaWNDb21wb25lbnQsICh2bSwgeyBvcDE6IF9pc1N0cmljdCB9KSA9PiB7XG4gIGxldCBzdGFjayA9IHZtLnN0YWNrO1xuICBsZXQgY29tcG9uZW50ID0gY2hlY2soXG4gICAgdmFsdWVGb3JSZWYoY2hlY2soc3RhY2sucG9wKCksIENoZWNrUmVmZXJlbmNlKSksXG4gICAgQ2hlY2tPcihDaGVja1N0cmluZywgQ2hlY2tDdXJyaWVkQ29tcG9uZW50RGVmaW5pdGlvbilcbiAgKTtcbiAgbGV0IGNvbnN0YW50cyA9IHZtW0NPTlNUQU5UU107XG4gIGxldCBvd25lciA9IHZtLmdldE93bmVyKCk7XG4gIGxldCBpc1N0cmljdCA9IGNvbnN0YW50cy5nZXRWYWx1ZTxib29sZWFuPihfaXNTdHJpY3QpO1xuXG4gIHZtLmxvYWRWYWx1ZSgkdDEsIG51bGwpOyAvLyBDbGVhciB0aGUgdGVtcCByZWdpc3RlclxuXG4gIGxldCBkZWZpbml0aW9uOiBDb21wb25lbnREZWZpbml0aW9uIHwgQ3VycmllZFZhbHVlO1xuXG4gIGlmICh0eXBlb2YgY29tcG9uZW50ID09PSAnc3RyaW5nJykge1xuICAgIGlmIChERUJVRyAmJiBpc1N0cmljdCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBgQXR0ZW1wdGVkIHRvIHJlc29sdmUgYSBkeW5hbWljIGNvbXBvbmVudCB3aXRoIGEgc3RyaW5nIGRlZmluaXRpb24sIFxcYCR7Y29tcG9uZW50fVxcYCBpbiBhIHN0cmljdCBtb2RlIHRlbXBsYXRlLiBJbiBzdHJpY3QgbW9kZSwgdXNpbmcgc3RyaW5ncyB0byByZXNvbHZlIGNvbXBvbmVudCBkZWZpbml0aW9ucyBpcyBwcm9oaWJpdGVkLiBZb3UgY2FuIGluc3RlYWQgaW1wb3J0IHRoZSBjb21wb25lbnQgZGVmaW5pdGlvbiBhbmQgdXNlIGl0IGRpcmVjdGx5LmBcbiAgICAgICk7XG4gICAgfVxuXG4gICAgbGV0IHJlc29sdmVkRGVmaW5pdGlvbiA9IHJlc29sdmVDb21wb25lbnQodm0ucnVudGltZS5yZXNvbHZlciwgY29uc3RhbnRzLCBjb21wb25lbnQsIG93bmVyKTtcblxuICAgIGRlZmluaXRpb24gPSBleHBlY3QocmVzb2x2ZWREZWZpbml0aW9uLCBgQ291bGQgbm90IGZpbmQgYSBjb21wb25lbnQgbmFtZWQgXCIke2NvbXBvbmVudH1cImApO1xuICB9IGVsc2UgaWYgKGlzQ3VycmllZFZhbHVlKGNvbXBvbmVudCkpIHtcbiAgICBkZWZpbml0aW9uID0gY29tcG9uZW50O1xuICB9IGVsc2Uge1xuICAgIGRlZmluaXRpb24gPSBjb25zdGFudHMuY29tcG9uZW50KGNvbXBvbmVudCwgb3duZXIpO1xuICB9XG5cbiAgc3RhY2sucHVzaChkZWZpbml0aW9uKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuUmVzb2x2ZUN1cnJpZWRDb21wb25lbnQsICh2bSkgPT4ge1xuICBsZXQgc3RhY2sgPSB2bS5zdGFjaztcbiAgbGV0IHJlZiA9IGNoZWNrKHN0YWNrLnBvcCgpLCBDaGVja1JlZmVyZW5jZSk7XG4gIGxldCB2YWx1ZSA9IHZhbHVlRm9yUmVmKHJlZik7XG4gIGxldCBjb25zdGFudHMgPSB2bVtDT05TVEFOVFNdO1xuXG4gIGxldCBkZWZpbml0aW9uOiBDdXJyaWVkVmFsdWUgfCBDb21wb25lbnREZWZpbml0aW9uIHwgbnVsbDtcblxuICBpZiAoREVCVUcgJiYgISh0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbicgfHwgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgIT09IG51bGwpKSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIGBFeHBlY3RlZCBhIGNvbXBvbmVudCBkZWZpbml0aW9uLCBidXQgcmVjZWl2ZWQgJHt2YWx1ZX0uIFlvdSBtYXkgaGF2ZSBhY2NpZGVudGFsbHkgZG9uZSA8JHtyZWYuZGVidWdMYWJlbH0+LCB3aGVyZSBcIiR7cmVmLmRlYnVnTGFiZWx9XCIgd2FzIGEgc3RyaW5nIGluc3RlYWQgb2YgYSBjdXJyaWVkIGNvbXBvbmVudCBkZWZpbml0aW9uLiBZb3UgbXVzdCBlaXRoZXIgdXNlIHRoZSBjb21wb25lbnQgZGVmaW5pdGlvbiBkaXJlY3RseSwgb3IgdXNlIHRoZSB7e2NvbXBvbmVudH19IGhlbHBlciB0byBjcmVhdGUgYSBjdXJyaWVkIGNvbXBvbmVudCBkZWZpbml0aW9uIHdoZW4gaW52b2tpbmcgZHluYW1pY2FsbHkuYFxuICAgICk7XG4gIH1cblxuICBpZiAoaXNDdXJyaWVkVmFsdWUodmFsdWUpKSB7XG4gICAgZGVmaW5pdGlvbiA9IHZhbHVlO1xuICB9IGVsc2Uge1xuICAgIGRlZmluaXRpb24gPSBjb25zdGFudHMuY29tcG9uZW50KHZhbHVlIGFzIG9iamVjdCwgdm0uZ2V0T3duZXIoKSwgdHJ1ZSk7XG5cbiAgICBpZiAoREVCVUcgJiYgZGVmaW5pdGlvbiA9PT0gbnVsbCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBgRXhwZWN0ZWQgYSBkeW5hbWljIGNvbXBvbmVudCBkZWZpbml0aW9uLCBidXQgcmVjZWl2ZWQgYW4gb2JqZWN0IG9yIGZ1bmN0aW9uIHRoYXQgZGlkIG5vdCBoYXZlIGEgY29tcG9uZW50IG1hbmFnZXIgYXNzb2NpYXRlZCB3aXRoIGl0LiBUaGUgZHluYW1pYyBpbnZvY2F0aW9uIHdhcyBcXGA8JHtcbiAgICAgICAgICByZWYuZGVidWdMYWJlbFxuICAgICAgICB9PlxcYCBvciBcXGB7eyR7XG4gICAgICAgICAgcmVmLmRlYnVnTGFiZWxcbiAgICAgICAgfX19XFxgLCBhbmQgdGhlIGluY29ycmVjdCBkZWZpbml0aW9uIGlzIHRoZSB2YWx1ZSBhdCB0aGUgcGF0aCBcXGAke1xuICAgICAgICAgIHJlZi5kZWJ1Z0xhYmVsXG4gICAgICAgIH1cXGAsIHdoaWNoIHdhczogJHtkZWJ1Z1RvU3RyaW5nISh2YWx1ZSl9YFxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICBzdGFjay5wdXNoKGRlZmluaXRpb24pO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5QdXNoRHluYW1pY0NvbXBvbmVudEluc3RhbmNlLCAodm0pID0+IHtcbiAgbGV0IHsgc3RhY2sgfSA9IHZtO1xuICBsZXQgZGVmaW5pdGlvbiA9IHN0YWNrLnBvcDxDb21wb25lbnREZWZpbml0aW9uPigpO1xuXG4gIGxldCBjYXBhYmlsaXRpZXMsIG1hbmFnZXI7XG5cbiAgaWYgKGlzQ3VycmllZFZhbHVlKGRlZmluaXRpb24pKSB7XG4gICAgbWFuYWdlciA9IGNhcGFiaWxpdGllcyA9IG51bGw7XG4gIH0gZWxzZSB7XG4gICAgbWFuYWdlciA9IGRlZmluaXRpb24ubWFuYWdlcjtcbiAgICBjYXBhYmlsaXRpZXMgPSBkZWZpbml0aW9uLmNhcGFiaWxpdGllcztcbiAgfVxuXG4gIHN0YWNrLnB1c2goeyBkZWZpbml0aW9uLCBjYXBhYmlsaXRpZXMsIG1hbmFnZXIsIHN0YXRlOiBudWxsLCBoYW5kbGU6IG51bGwsIHRhYmxlOiBudWxsIH0pO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5QdXNoQXJncywgKHZtLCB7IG9wMTogX25hbWVzLCBvcDI6IF9ibG9ja05hbWVzLCBvcDM6IGZsYWdzIH0pID0+IHtcbiAgbGV0IHN0YWNrID0gdm0uc3RhY2s7XG4gIGxldCBuYW1lcyA9IHZtW0NPTlNUQU5UU10uZ2V0QXJyYXk8c3RyaW5nPihfbmFtZXMpO1xuXG4gIGxldCBwb3NpdGlvbmFsQ291bnQgPSBmbGFncyA+PiA0O1xuICBsZXQgYXROYW1lcyA9IGZsYWdzICYgMGIxMDAwO1xuICBsZXQgYmxvY2tOYW1lcyA9XG4gICAgZmxhZ3MgJiAwYjAxMTEgPyB2bVtDT05TVEFOVFNdLmdldEFycmF5PHN0cmluZz4oX2Jsb2NrTmFtZXMpIDogRU1QVFlfU1RSSU5HX0FSUkFZO1xuXG4gIHZtW0FSR1NdLnNldHVwKHN0YWNrLCBuYW1lcywgYmxvY2tOYW1lcywgcG9zaXRpb25hbENvdW50LCAhIWF0TmFtZXMpO1xuICBzdGFjay5wdXNoKHZtW0FSR1NdKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuUHVzaEVtcHR5QXJncywgKHZtKSA9PiB7XG4gIGxldCB7IHN0YWNrIH0gPSB2bTtcblxuICBzdGFjay5wdXNoKHZtW0FSR1NdLmVtcHR5KHN0YWNrKSk7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkNhcHR1cmVBcmdzLCAodm0pID0+IHtcbiAgbGV0IHN0YWNrID0gdm0uc3RhY2s7XG5cbiAgbGV0IGFyZ3MgPSBjaGVjayhzdGFjay5wb3AoKSwgQ2hlY2tJbnN0YW5jZW9mKFZNQXJndW1lbnRzSW1wbCkpO1xuICBsZXQgY2FwdHVyZWRBcmdzID0gYXJncy5jYXB0dXJlKCk7XG4gIHN0YWNrLnB1c2goY2FwdHVyZWRBcmdzKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuUHJlcGFyZUFyZ3MsICh2bSwgeyBvcDE6IF9zdGF0ZSB9KSA9PiB7XG4gIGxldCBzdGFjayA9IHZtLnN0YWNrO1xuICBsZXQgaW5zdGFuY2UgPSB2bS5mZXRjaFZhbHVlPENvbXBvbmVudEluc3RhbmNlPihfc3RhdGUpO1xuICBsZXQgYXJncyA9IGNoZWNrKHN0YWNrLnBvcCgpLCBDaGVja0luc3RhbmNlb2YoVk1Bcmd1bWVudHNJbXBsKSk7XG5cbiAgbGV0IHsgZGVmaW5pdGlvbiB9ID0gaW5zdGFuY2U7XG5cbiAgaWYgKGlzQ3VycmllZFR5cGUoZGVmaW5pdGlvbiwgQ3VycmllZFR5cGUuQ29tcG9uZW50KSkge1xuICAgIGFzc2VydChcbiAgICAgICFkZWZpbml0aW9uLm1hbmFnZXIsXG4gICAgICBcIklmIHRoZSBjb21wb25lbnQgZGVmaW5pdGlvbiB3YXMgY3VycmllZCwgd2UgZG9uJ3QgeWV0IGhhdmUgYSBtYW5hZ2VyXCJcbiAgICApO1xuXG4gICAgbGV0IGNvbnN0YW50cyA9IHZtW0NPTlNUQU5UU107XG5cbiAgICBsZXQge1xuICAgICAgZGVmaW5pdGlvbjogcmVzb2x2ZWREZWZpbml0aW9uLFxuICAgICAgb3duZXIsXG4gICAgICByZXNvbHZlZCxcbiAgICAgIHBvc2l0aW9uYWwsXG4gICAgICBuYW1lZCxcbiAgICB9ID0gcmVzb2x2ZUN1cnJpZWRWYWx1ZShkZWZpbml0aW9uKTtcblxuICAgIGlmIChyZXNvbHZlZCA9PT0gdHJ1ZSkge1xuICAgICAgZGVmaW5pdGlvbiA9IHJlc29sdmVkRGVmaW5pdGlvbiBhcyBDb21wb25lbnREZWZpbml0aW9uO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHJlc29sdmVkRGVmaW5pdGlvbiA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGxldCByZXNvbHZlZFZhbHVlID0gdm0ucnVudGltZS5yZXNvbHZlci5sb29rdXBDb21wb25lbnQocmVzb2x2ZWREZWZpbml0aW9uLCBvd25lcik7XG5cbiAgICAgIGRlZmluaXRpb24gPSBjb25zdGFudHMucmVzb2x2ZWRDb21wb25lbnQoXG4gICAgICAgIGV4cGVjdChyZXNvbHZlZFZhbHVlLCAnQlVHOiBleHBlY3RlZCByZXNvbHZlZCBjb21wb25lbnQnKSxcbiAgICAgICAgcmVzb2x2ZWREZWZpbml0aW9uXG4gICAgICApO1xuICAgIH0gZWxzZSB7XG4gICAgICBkZWZpbml0aW9uID0gY29uc3RhbnRzLmNvbXBvbmVudChyZXNvbHZlZERlZmluaXRpb24sIG93bmVyKTtcbiAgICB9XG5cbiAgICBpZiAobmFtZWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgYXJncy5uYW1lZC5tZXJnZShhc3NpZ24oe30sIC4uLm5hbWVkKSk7XG4gICAgfVxuXG4gICAgaWYgKHBvc2l0aW9uYWwgIT09IHVuZGVmaW5lZCkge1xuICAgICAgYXJncy5yZWFsbG9jKHBvc2l0aW9uYWwubGVuZ3RoKTtcbiAgICAgIGFyZ3MucG9zaXRpb25hbC5wcmVwZW5kKHBvc2l0aW9uYWwpO1xuICAgIH1cblxuICAgIGxldCB7IG1hbmFnZXIgfSA9IGRlZmluaXRpb247XG5cbiAgICBhc3NlcnQoaW5zdGFuY2UubWFuYWdlciA9PT0gbnVsbCwgJ2NvbXBvbmVudCBpbnN0YW5jZSBtYW5hZ2VyIHNob3VsZCBub3QgYmUgcG9wdWxhdGVkIHlldCcpO1xuICAgIGFzc2VydChcbiAgICAgIGluc3RhbmNlLmNhcGFiaWxpdGllcyA9PT0gbnVsbCxcbiAgICAgICdjb21wb25lbnQgaW5zdGFuY2UgbWFuYWdlciBzaG91bGQgbm90IGJlIHBvcHVsYXRlZCB5ZXQnXG4gICAgKTtcblxuICAgIGluc3RhbmNlLmRlZmluaXRpb24gPSBkZWZpbml0aW9uO1xuICAgIGluc3RhbmNlLm1hbmFnZXIgPSBtYW5hZ2VyO1xuICAgIGluc3RhbmNlLmNhcGFiaWxpdGllcyA9IGRlZmluaXRpb24uY2FwYWJpbGl0aWVzO1xuXG4gICAgLy8gU2F2ZSBvZmYgdGhlIG93bmVyIHRoYXQgdGhpcyBjb21wb25lbnQgd2FzIGN1cnJpZWQgd2l0aC4gTGF0ZXIgb24sXG4gICAgLy8gd2UnbGwgZmV0Y2ggdGhlIHZhbHVlIG9mIHRoaXMgcmVnaXN0ZXIgYW5kIHNldCBpdCBhcyB0aGUgb3duZXIgb24gdGhlXG4gICAgLy8gbmV3IHJvb3Qgc2NvcGUuXG4gICAgdm0ubG9hZFZhbHVlKCR0MSwgb3duZXIpO1xuICB9XG5cbiAgbGV0IHsgbWFuYWdlciwgc3RhdGUgfSA9IGRlZmluaXRpb247XG4gIGxldCBjYXBhYmlsaXRpZXMgPSBpbnN0YW5jZS5jYXBhYmlsaXRpZXM7XG5cbiAgaWYgKCFtYW5hZ2VySGFzQ2FwYWJpbGl0eShtYW5hZ2VyLCBjYXBhYmlsaXRpZXMsIEludGVybmFsQ29tcG9uZW50Q2FwYWJpbGl0eS5QcmVwYXJlQXJncykpIHtcbiAgICBzdGFjay5wdXNoKGFyZ3MpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGxldCBibG9ja3MgPSBhcmdzLmJsb2Nrcy52YWx1ZXM7XG4gIGxldCBibG9ja05hbWVzID0gYXJncy5ibG9ja3MubmFtZXM7XG4gIGxldCBwcmVwYXJlZEFyZ3MgPSBtYW5hZ2VyLnByZXBhcmVBcmdzKHN0YXRlLCBhcmdzKTtcblxuICBpZiAocHJlcGFyZWRBcmdzKSB7XG4gICAgYXJncy5jbGVhcigpO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBibG9ja3MubGVuZ3RoOyBpKyspIHtcbiAgICAgIHN0YWNrLnB1c2goYmxvY2tzW2ldKTtcbiAgICB9XG5cbiAgICBsZXQgeyBwb3NpdGlvbmFsLCBuYW1lZCB9ID0gcHJlcGFyZWRBcmdzO1xuXG4gICAgbGV0IHBvc2l0aW9uYWxDb3VudCA9IHBvc2l0aW9uYWwubGVuZ3RoO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwb3NpdGlvbmFsQ291bnQ7IGkrKykge1xuICAgICAgc3RhY2sucHVzaChwb3NpdGlvbmFsW2ldKTtcbiAgICB9XG5cbiAgICBsZXQgbmFtZXMgPSBPYmplY3Qua2V5cyhuYW1lZCk7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5hbWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBzdGFjay5wdXNoKG5hbWVkW25hbWVzW2ldXSk7XG4gICAgfVxuXG4gICAgYXJncy5zZXR1cChzdGFjaywgbmFtZXMsIGJsb2NrTmFtZXMsIHBvc2l0aW9uYWxDb3VudCwgZmFsc2UpO1xuICB9XG5cbiAgc3RhY2sucHVzaChhcmdzKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuQ3JlYXRlQ29tcG9uZW50LCAodm0sIHsgb3AxOiBmbGFncywgb3AyOiBfc3RhdGUgfSkgPT4ge1xuICBsZXQgaW5zdGFuY2UgPSBjaGVjayh2bS5mZXRjaFZhbHVlKF9zdGF0ZSksIENoZWNrQ29tcG9uZW50SW5zdGFuY2UpO1xuICBsZXQgeyBkZWZpbml0aW9uLCBtYW5hZ2VyLCBjYXBhYmlsaXRpZXMgfSA9IGluc3RhbmNlO1xuXG4gIGlmICghbWFuYWdlckhhc0NhcGFiaWxpdHkobWFuYWdlciwgY2FwYWJpbGl0aWVzLCBJbnRlcm5hbENvbXBvbmVudENhcGFiaWxpdHkuQ3JlYXRlSW5zdGFuY2UpKSB7XG4gICAgLy8gVE9ETzogQ2xvc3VyZSBhbmQgTWFpbiBjb21wb25lbnRzIGFyZSBhbHdheXMgaW52b2tlZCBkeW5hbWljYWxseSwgc28gdGhpc1xuICAgIC8vIG9wY29kZSBtYXkgcnVuIGV2ZW4gaWYgdGhpcyBjYXBhYmlsaXR5IGlzIG5vdCBlbmFibGVkLiBJbiB0aGUgZnV0dXJlIHdlXG4gICAgLy8gc2hvdWxkIGhhbmRsZSB0aGlzIGluIGEgYmV0dGVyIHdheS5cbiAgICByZXR1cm47XG4gIH1cblxuICBsZXQgZHluYW1pY1Njb3BlOiBPcHRpb248RHluYW1pY1Njb3BlPiA9IG51bGw7XG4gIGlmIChtYW5hZ2VySGFzQ2FwYWJpbGl0eShtYW5hZ2VyLCBjYXBhYmlsaXRpZXMsIEludGVybmFsQ29tcG9uZW50Q2FwYWJpbGl0eS5EeW5hbWljU2NvcGUpKSB7XG4gICAgZHluYW1pY1Njb3BlID0gdm0uZHluYW1pY1Njb3BlKCk7XG4gIH1cblxuICBsZXQgaGFzRGVmYXVsdEJsb2NrID0gZmxhZ3MgJiAxO1xuICBsZXQgYXJnczogT3B0aW9uPFZNQXJndW1lbnRzPiA9IG51bGw7XG5cbiAgaWYgKG1hbmFnZXJIYXNDYXBhYmlsaXR5KG1hbmFnZXIsIGNhcGFiaWxpdGllcywgSW50ZXJuYWxDb21wb25lbnRDYXBhYmlsaXR5LkNyZWF0ZUFyZ3MpKSB7XG4gICAgYXJncyA9IGNoZWNrKHZtLnN0YWNrLnBlZWsoKSwgQ2hlY2tBcmd1bWVudHMpO1xuICB9XG5cbiAgbGV0IHNlbGY6IE9wdGlvbjxSZWZlcmVuY2U+ID0gbnVsbDtcbiAgaWYgKG1hbmFnZXJIYXNDYXBhYmlsaXR5KG1hbmFnZXIsIGNhcGFiaWxpdGllcywgSW50ZXJuYWxDb21wb25lbnRDYXBhYmlsaXR5LkNyZWF0ZUNhbGxlcikpIHtcbiAgICBzZWxmID0gdm0uZ2V0U2VsZigpO1xuICB9XG5cbiAgbGV0IHN0YXRlID0gbWFuYWdlci5jcmVhdGUoXG4gICAgdm0uZ2V0T3duZXIoKSxcbiAgICBkZWZpbml0aW9uLnN0YXRlLFxuICAgIGFyZ3MsXG4gICAgdm0uZW52LFxuICAgIGR5bmFtaWNTY29wZSxcbiAgICBzZWxmLFxuICAgICEhaGFzRGVmYXVsdEJsb2NrXG4gICk7XG5cbiAgLy8gV2Ugd2FudCB0byByZXVzZSB0aGUgYHN0YXRlYCBQT0pPIGhlcmUsIGJlY2F1c2Ugd2Uga25vdyB0aGF0IHRoZSBvcGNvZGVzXG4gIC8vIG9ubHkgdHJhbnNpdGlvbiBhdCBleGFjdGx5IG9uZSBwbGFjZS5cbiAgaW5zdGFuY2Uuc3RhdGUgPSBzdGF0ZTtcblxuICBpZiAobWFuYWdlckhhc0NhcGFiaWxpdHkobWFuYWdlciwgY2FwYWJpbGl0aWVzLCBJbnRlcm5hbENvbXBvbmVudENhcGFiaWxpdHkuVXBkYXRlSG9vaykpIHtcbiAgICB2bS51cGRhdGVXaXRoKG5ldyBVcGRhdGVDb21wb25lbnRPcGNvZGUoc3RhdGUsIG1hbmFnZXIsIGR5bmFtaWNTY29wZSkpO1xuICB9XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLlJlZ2lzdGVyQ29tcG9uZW50RGVzdHJ1Y3RvciwgKHZtLCB7IG9wMTogX3N0YXRlIH0pID0+IHtcbiAgbGV0IHsgbWFuYWdlciwgc3RhdGUsIGNhcGFiaWxpdGllcyB9ID0gY2hlY2sodm0uZmV0Y2hWYWx1ZShfc3RhdGUpLCBDaGVja0NvbXBvbmVudEluc3RhbmNlKTtcblxuICBsZXQgZCA9IG1hbmFnZXIuZ2V0RGVzdHJveWFibGUoc3RhdGUpO1xuXG4gIGlmIChcbiAgICBERUJVRyAmJlxuICAgICFtYW5hZ2VySGFzQ2FwYWJpbGl0eShtYW5hZ2VyLCBjYXBhYmlsaXRpZXMsIEludGVybmFsQ29tcG9uZW50Q2FwYWJpbGl0eS5XaWxsRGVzdHJveSkgJiZcbiAgICBkICE9PSBudWxsICYmXG4gICAgdHlwZW9mICd3aWxsRGVzdHJveScgaW4gZFxuICApIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAnQlVHOiBEZXN0cnVjdG9yIGhhcyB3aWxsRGVzdHJveSwgYnV0IHRoZSB3aWxsRGVzdHJveSBjYXBhYmlsaXR5IHdhcyBub3QgZW5hYmxlZCBmb3IgdGhpcyBjb21wb25lbnQuIFByZS1kZXN0cnVjdGlvbiBob29rcyBtdXN0IGJlIGV4cGxpY2l0bHkgb3B0ZWQgaW50bydcbiAgICApO1xuICB9XG5cbiAgaWYgKGQpIHZtLmFzc29jaWF0ZURlc3Ryb3lhYmxlKGQpO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5CZWdpbkNvbXBvbmVudFRyYW5zYWN0aW9uLCAodm0sIHsgb3AxOiBfc3RhdGUgfSkgPT4ge1xuICBsZXQgbmFtZTtcblxuICBpZiAoREVCVUcpIHtcbiAgICBsZXQgeyBkZWZpbml0aW9uLCBtYW5hZ2VyIH0gPSBjaGVjayh2bS5mZXRjaFZhbHVlKF9zdGF0ZSksIENoZWNrQ29tcG9uZW50SW5zdGFuY2UpO1xuXG4gICAgbmFtZSA9IGRlZmluaXRpb24ucmVzb2x2ZWROYW1lID8/IG1hbmFnZXIuZ2V0RGVidWdOYW1lKGRlZmluaXRpb24uc3RhdGUpO1xuICB9XG5cbiAgdm0uYmVnaW5DYWNoZUdyb3VwKG5hbWUpO1xuICB2bS5lbGVtZW50cygpLnB1c2hTaW1wbGVCbG9jaygpO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5QdXRDb21wb25lbnRPcGVyYXRpb25zLCAodm0pID0+IHtcbiAgdm0ubG9hZFZhbHVlKCR0MCwgbmV3IENvbXBvbmVudEVsZW1lbnRPcGVyYXRpb25zKCkpO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5Db21wb25lbnRBdHRyLCAodm0sIHsgb3AxOiBfbmFtZSwgb3AyOiBfdHJ1c3RpbmcsIG9wMzogX25hbWVzcGFjZSB9KSA9PiB7XG4gIGxldCBuYW1lID0gdm1bQ09OU1RBTlRTXS5nZXRWYWx1ZTxzdHJpbmc+KF9uYW1lKTtcbiAgbGV0IHRydXN0aW5nID0gdm1bQ09OU1RBTlRTXS5nZXRWYWx1ZTxib29sZWFuPihfdHJ1c3RpbmcpO1xuICBsZXQgcmVmZXJlbmNlID0gY2hlY2sodm0uc3RhY2sucG9wKCksIENoZWNrUmVmZXJlbmNlKTtcbiAgbGV0IG5hbWVzcGFjZSA9IF9uYW1lc3BhY2UgPyB2bVtDT05TVEFOVFNdLmdldFZhbHVlPHN0cmluZz4oX25hbWVzcGFjZSkgOiBudWxsO1xuXG4gIGNoZWNrKHZtLmZldGNoVmFsdWUoJHQwKSwgQ2hlY2tJbnN0YW5jZW9mKENvbXBvbmVudEVsZW1lbnRPcGVyYXRpb25zKSkuc2V0QXR0cmlidXRlKFxuICAgIG5hbWUsXG4gICAgcmVmZXJlbmNlLFxuICAgIHRydXN0aW5nLFxuICAgIG5hbWVzcGFjZVxuICApO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5TdGF0aWNDb21wb25lbnRBdHRyLCAodm0sIHsgb3AxOiBfbmFtZSwgb3AyOiBfdmFsdWUsIG9wMzogX25hbWVzcGFjZSB9KSA9PiB7XG4gIGxldCBuYW1lID0gdm1bQ09OU1RBTlRTXS5nZXRWYWx1ZTxzdHJpbmc+KF9uYW1lKTtcbiAgbGV0IHZhbHVlID0gdm1bQ09OU1RBTlRTXS5nZXRWYWx1ZTxzdHJpbmc+KF92YWx1ZSk7XG4gIGxldCBuYW1lc3BhY2UgPSBfbmFtZXNwYWNlID8gdm1bQ09OU1RBTlRTXS5nZXRWYWx1ZTxzdHJpbmc+KF9uYW1lc3BhY2UpIDogbnVsbDtcblxuICBjaGVjayh2bS5mZXRjaFZhbHVlKCR0MCksIENoZWNrSW5zdGFuY2VvZihDb21wb25lbnRFbGVtZW50T3BlcmF0aW9ucykpLnNldFN0YXRpY0F0dHJpYnV0ZShcbiAgICBuYW1lLFxuICAgIHZhbHVlLFxuICAgIG5hbWVzcGFjZVxuICApO1xufSk7XG5cbnR5cGUgRGVmZXJyZWRBdHRyaWJ1dGUgPSB7XG4gIHZhbHVlOiBzdHJpbmcgfCBSZWZlcmVuY2U8dW5rbm93bj47XG4gIG5hbWVzcGFjZTogT3B0aW9uPHN0cmluZz47XG4gIHRydXN0aW5nPzogYm9vbGVhbjtcbn07XG5cbmV4cG9ydCBjbGFzcyBDb21wb25lbnRFbGVtZW50T3BlcmF0aW9ucyBpbXBsZW1lbnRzIEVsZW1lbnRPcGVyYXRpb25zIHtcbiAgcHJpdmF0ZSBhdHRyaWJ1dGVzID0gZGljdDxEZWZlcnJlZEF0dHJpYnV0ZT4oKTtcbiAgcHJpdmF0ZSBjbGFzc2VzOiAoc3RyaW5nIHwgUmVmZXJlbmNlPHVua25vd24+KVtdID0gW107XG4gIHByaXZhdGUgbW9kaWZpZXJzOiBNb2RpZmllckluc3RhbmNlW10gPSBbXTtcblxuICBzZXRBdHRyaWJ1dGUoXG4gICAgbmFtZTogc3RyaW5nLFxuICAgIHZhbHVlOiBSZWZlcmVuY2U8dW5rbm93bj4sXG4gICAgdHJ1c3Rpbmc6IGJvb2xlYW4sXG4gICAgbmFtZXNwYWNlOiBPcHRpb248c3RyaW5nPlxuICApIHtcbiAgICBsZXQgZGVmZXJyZWQgPSB7IHZhbHVlLCBuYW1lc3BhY2UsIHRydXN0aW5nIH07XG5cbiAgICBpZiAobmFtZSA9PT0gJ2NsYXNzJykge1xuICAgICAgdGhpcy5jbGFzc2VzLnB1c2godmFsdWUpO1xuICAgIH1cblxuICAgIHRoaXMuYXR0cmlidXRlc1tuYW1lXSA9IGRlZmVycmVkO1xuICB9XG5cbiAgc2V0U3RhdGljQXR0cmlidXRlKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgbmFtZXNwYWNlOiBPcHRpb248c3RyaW5nPik6IHZvaWQge1xuICAgIGxldCBkZWZlcnJlZCA9IHsgdmFsdWUsIG5hbWVzcGFjZSB9O1xuXG4gICAgaWYgKG5hbWUgPT09ICdjbGFzcycpIHtcbiAgICAgIHRoaXMuY2xhc3Nlcy5wdXNoKHZhbHVlKTtcbiAgICB9XG5cbiAgICB0aGlzLmF0dHJpYnV0ZXNbbmFtZV0gPSBkZWZlcnJlZDtcbiAgfVxuXG4gIGFkZE1vZGlmaWVyKG1vZGlmaWVyOiBNb2RpZmllckluc3RhbmNlKTogdm9pZCB7XG4gICAgdGhpcy5tb2RpZmllcnMucHVzaChtb2RpZmllcik7XG4gIH1cblxuICBmbHVzaCh2bTogSW50ZXJuYWxWTSk6IE1vZGlmaWVySW5zdGFuY2VbXSB7XG4gICAgbGV0IHR5cGU6IERlZmVycmVkQXR0cmlidXRlIHwgdW5kZWZpbmVkO1xuICAgIGxldCBhdHRyaWJ1dGVzID0gdGhpcy5hdHRyaWJ1dGVzO1xuXG4gICAgZm9yIChsZXQgbmFtZSBpbiB0aGlzLmF0dHJpYnV0ZXMpIHtcbiAgICAgIGlmIChuYW1lID09PSAndHlwZScpIHtcbiAgICAgICAgdHlwZSA9IGF0dHJpYnV0ZXNbbmFtZV07XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICBsZXQgYXR0ciA9IHRoaXMuYXR0cmlidXRlc1tuYW1lXTtcbiAgICAgIGlmIChuYW1lID09PSAnY2xhc3MnKSB7XG4gICAgICAgIHNldERlZmVycmVkQXR0cih2bSwgJ2NsYXNzJywgbWVyZ2VDbGFzc2VzKHRoaXMuY2xhc3NlcyksIGF0dHIubmFtZXNwYWNlLCBhdHRyLnRydXN0aW5nKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNldERlZmVycmVkQXR0cih2bSwgbmFtZSwgYXR0ci52YWx1ZSwgYXR0ci5uYW1lc3BhY2UsIGF0dHIudHJ1c3RpbmcpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0eXBlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHNldERlZmVycmVkQXR0cih2bSwgJ3R5cGUnLCB0eXBlLnZhbHVlLCB0eXBlLm5hbWVzcGFjZSwgdHlwZS50cnVzdGluZyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMubW9kaWZpZXJzO1xuICB9XG59XG5cbmZ1bmN0aW9uIG1lcmdlQ2xhc3NlcyhjbGFzc2VzOiAoc3RyaW5nIHwgUmVmZXJlbmNlKVtdKTogc3RyaW5nIHwgUmVmZXJlbmNlPHVua25vd24+IHtcbiAgaWYgKGNsYXNzZXMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuICcnO1xuICB9XG4gIGlmIChjbGFzc2VzLmxlbmd0aCA9PT0gMSkge1xuICAgIHJldHVybiBjbGFzc2VzWzBdO1xuICB9XG4gIGlmIChhbGxTdHJpbmdDbGFzc2VzKGNsYXNzZXMpKSB7XG4gICAgcmV0dXJuIGNsYXNzZXMuam9pbignICcpO1xuICB9XG5cbiAgcmV0dXJuIGNyZWF0ZUNsYXNzTGlzdFJlZihjbGFzc2VzIGFzIFJlZmVyZW5jZVtdKTtcbn1cblxuZnVuY3Rpb24gYWxsU3RyaW5nQ2xhc3NlcyhjbGFzc2VzOiAoc3RyaW5nIHwgUmVmZXJlbmNlPHVua25vd24+KVtdKTogY2xhc3NlcyBpcyBzdHJpbmdbXSB7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgY2xhc3Nlcy5sZW5ndGg7IGkrKykge1xuICAgIGlmICh0eXBlb2YgY2xhc3Nlc1tpXSAhPT0gJ3N0cmluZycpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59XG5cbmZ1bmN0aW9uIHNldERlZmVycmVkQXR0cihcbiAgdm06IEludGVybmFsVk0sXG4gIG5hbWU6IHN0cmluZyxcbiAgdmFsdWU6IHN0cmluZyB8IFJlZmVyZW5jZTx1bmtub3duPixcbiAgbmFtZXNwYWNlOiBPcHRpb248c3RyaW5nPixcbiAgdHJ1c3RpbmcgPSBmYWxzZVxuKSB7XG4gIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgdm0uZWxlbWVudHMoKS5zZXRTdGF0aWNBdHRyaWJ1dGUobmFtZSwgdmFsdWUsIG5hbWVzcGFjZSk7XG4gIH0gZWxzZSB7XG4gICAgbGV0IGF0dHJpYnV0ZSA9IHZtXG4gICAgICAuZWxlbWVudHMoKVxuICAgICAgLnNldER5bmFtaWNBdHRyaWJ1dGUobmFtZSwgdmFsdWVGb3JSZWYodmFsdWUpLCB0cnVzdGluZywgbmFtZXNwYWNlKTtcbiAgICBpZiAoIWlzQ29uc3RSZWYodmFsdWUpKSB7XG4gICAgICB2bS51cGRhdGVXaXRoKG5ldyBVcGRhdGVEeW5hbWljQXR0cmlidXRlT3Bjb2RlKHZhbHVlLCBhdHRyaWJ1dGUsIHZtLmVudikpO1xuICAgIH1cbiAgfVxufVxuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuRGlkQ3JlYXRlRWxlbWVudCwgKHZtLCB7IG9wMTogX3N0YXRlIH0pID0+IHtcbiAgbGV0IHsgZGVmaW5pdGlvbiwgc3RhdGUgfSA9IGNoZWNrKHZtLmZldGNoVmFsdWUoX3N0YXRlKSwgQ2hlY2tDb21wb25lbnRJbnN0YW5jZSk7XG4gIGxldCB7IG1hbmFnZXIgfSA9IGRlZmluaXRpb247XG5cbiAgbGV0IG9wZXJhdGlvbnMgPSBjaGVjayh2bS5mZXRjaFZhbHVlKCR0MCksIENoZWNrSW5zdGFuY2VvZihDb21wb25lbnRFbGVtZW50T3BlcmF0aW9ucykpO1xuXG4gIChtYW5hZ2VyIGFzIFdpdGhFbGVtZW50SG9vazx1bmtub3duPikuZGlkQ3JlYXRlRWxlbWVudChcbiAgICBzdGF0ZSxcbiAgICBleHBlY3Qodm0uZWxlbWVudHMoKS5jb25zdHJ1Y3RpbmcsIGBFeHBlY3RlZCBhIGNvbnN0cnVjdGluZyBlbGVtZW50IGluIERpZENyZWF0ZU9wY29kZWApLFxuICAgIG9wZXJhdGlvbnNcbiAgKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuR2V0Q29tcG9uZW50U2VsZiwgKHZtLCB7IG9wMTogX3N0YXRlLCBvcDI6IF9uYW1lcyB9KSA9PiB7XG4gIGxldCBpbnN0YW5jZSA9IGNoZWNrKHZtLmZldGNoVmFsdWUoX3N0YXRlKSwgQ2hlY2tDb21wb25lbnRJbnN0YW5jZSk7XG4gIGxldCB7IGRlZmluaXRpb24sIHN0YXRlIH0gPSBpbnN0YW5jZTtcbiAgbGV0IHsgbWFuYWdlciB9ID0gZGVmaW5pdGlvbjtcbiAgbGV0IHNlbGZSZWYgPSBtYW5hZ2VyLmdldFNlbGYoc3RhdGUpO1xuXG4gIGlmICh2bS5lbnYuZGVidWdSZW5kZXJUcmVlICE9PSB1bmRlZmluZWQpIHtcbiAgICBsZXQgaW5zdGFuY2UgPSBjaGVjayh2bS5mZXRjaFZhbHVlKF9zdGF0ZSksIENoZWNrQ29tcG9uZW50SW5zdGFuY2UpO1xuICAgIGxldCB7IGRlZmluaXRpb24sIG1hbmFnZXIgfSA9IGluc3RhbmNlO1xuXG4gICAgbGV0IGFyZ3M6IENhcHR1cmVkQXJndW1lbnRzO1xuXG4gICAgaWYgKHZtLnN0YWNrLnBlZWsoKSA9PT0gdm1bQVJHU10pIHtcbiAgICAgIGFyZ3MgPSB2bVtBUkdTXS5jYXB0dXJlKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCBuYW1lcyA9IHZtW0NPTlNUQU5UU10uZ2V0QXJyYXk8c3RyaW5nPihfbmFtZXMpO1xuICAgICAgdm1bQVJHU10uc2V0dXAodm0uc3RhY2ssIG5hbWVzLCBbXSwgMCwgdHJ1ZSk7XG4gICAgICBhcmdzID0gdm1bQVJHU10uY2FwdHVyZSgpO1xuICAgIH1cblxuICAgIGxldCBtb2R1bGVOYW1lOiBzdHJpbmc7XG4gICAgbGV0IGNvbXBpbGFibGU6IENvbXBpbGFibGVQcm9ncmFtIHwgbnVsbCA9IGRlZmluaXRpb24uY29tcGlsYWJsZTtcblxuICAgIGlmIChjb21waWxhYmxlID09PSBudWxsKSB7XG4gICAgICBhc3NlcnQoXG4gICAgICAgIG1hbmFnZXJIYXNDYXBhYmlsaXR5KFxuICAgICAgICAgIG1hbmFnZXIsXG4gICAgICAgICAgaW5zdGFuY2UuY2FwYWJpbGl0aWVzLFxuICAgICAgICAgIEludGVybmFsQ29tcG9uZW50Q2FwYWJpbGl0eS5EeW5hbWljTGF5b3V0XG4gICAgICAgICksXG4gICAgICAgICdCVUc6IE5vIHRlbXBsYXRlIHdhcyBmb3VuZCBmb3IgdGhpcyBjb21wb25lbnQsIGFuZCB0aGUgY29tcG9uZW50IGRpZCBub3QgaGF2ZSB0aGUgZHluYW1pYyBsYXlvdXQgY2FwYWJpbGl0eSdcbiAgICAgICk7XG5cbiAgICAgIGNvbXBpbGFibGUgPSBtYW5hZ2VyLmdldER5bmFtaWNMYXlvdXQoc3RhdGUsIHZtLnJ1bnRpbWUucmVzb2x2ZXIpO1xuXG4gICAgICBpZiAoY29tcGlsYWJsZSAhPT0gbnVsbCkge1xuICAgICAgICBtb2R1bGVOYW1lID0gY29tcGlsYWJsZS5tb2R1bGVOYW1lO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbW9kdWxlTmFtZSA9ICdfX2RlZmF1bHRfXy5oYnMnO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBtb2R1bGVOYW1lID0gY29tcGlsYWJsZS5tb2R1bGVOYW1lO1xuICAgIH1cblxuICAgIC8vIEZvciB0ZWFyaW5nIGRvd24gdGhlIGRlYnVnUmVuZGVyVHJlZVxuICAgIHZtLmFzc29jaWF0ZURlc3Ryb3lhYmxlKGluc3RhbmNlKTtcblxuICAgIGlmIChoYXNDdXN0b21EZWJ1Z1JlbmRlclRyZWVMaWZlY3ljbGUobWFuYWdlcikpIHtcbiAgICAgIGxldCBub2RlcyA9IG1hbmFnZXIuZ2V0RGVidWdDdXN0b21SZW5kZXJUcmVlKFxuICAgICAgICBpbnN0YW5jZS5kZWZpbml0aW9uLnN0YXRlLFxuICAgICAgICBpbnN0YW5jZS5zdGF0ZSxcbiAgICAgICAgYXJncyxcbiAgICAgICAgbW9kdWxlTmFtZVxuICAgICAgKTtcblxuICAgICAgbm9kZXMuZm9yRWFjaCgobm9kZSkgPT4ge1xuICAgICAgICBsZXQgeyBidWNrZXQgfSA9IG5vZGU7XG4gICAgICAgIHZtLmVudi5kZWJ1Z1JlbmRlclRyZWUhLmNyZWF0ZShidWNrZXQsIG5vZGUpO1xuXG4gICAgICAgIHJlZ2lzdGVyRGVzdHJ1Y3RvcihpbnN0YW5jZSwgKCkgPT4ge1xuICAgICAgICAgIHZtLmVudi5kZWJ1Z1JlbmRlclRyZWU/LndpbGxEZXN0cm95KGJ1Y2tldCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHZtLnVwZGF0ZVdpdGgobmV3IERlYnVnUmVuZGVyVHJlZVVwZGF0ZU9wY29kZShidWNrZXQpKTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBsZXQgbmFtZSA9IGRlZmluaXRpb24ucmVzb2x2ZWROYW1lID8/IG1hbmFnZXIuZ2V0RGVidWdOYW1lKGRlZmluaXRpb24uc3RhdGUpO1xuXG4gICAgICB2bS5lbnYuZGVidWdSZW5kZXJUcmVlLmNyZWF0ZShpbnN0YW5jZSwge1xuICAgICAgICB0eXBlOiAnY29tcG9uZW50JyxcbiAgICAgICAgbmFtZSxcbiAgICAgICAgYXJncyxcbiAgICAgICAgdGVtcGxhdGU6IG1vZHVsZU5hbWUsXG4gICAgICAgIGluc3RhbmNlOiB2YWx1ZUZvclJlZihzZWxmUmVmKSxcbiAgICAgIH0pO1xuXG4gICAgICB2bS5hc3NvY2lhdGVEZXN0cm95YWJsZShpbnN0YW5jZSk7XG5cbiAgICAgIHJlZ2lzdGVyRGVzdHJ1Y3RvcihpbnN0YW5jZSwgKCkgPT4ge1xuICAgICAgICB2bS5lbnYuZGVidWdSZW5kZXJUcmVlPy53aWxsRGVzdHJveShpbnN0YW5jZSk7XG4gICAgICB9KTtcblxuICAgICAgdm0udXBkYXRlV2l0aChuZXcgRGVidWdSZW5kZXJUcmVlVXBkYXRlT3Bjb2RlKGluc3RhbmNlKSk7XG4gICAgfVxuICB9XG5cbiAgdm0uc3RhY2sucHVzaChzZWxmUmVmKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuR2V0Q29tcG9uZW50VGFnTmFtZSwgKHZtLCB7IG9wMTogX3N0YXRlIH0pID0+IHtcbiAgbGV0IHsgZGVmaW5pdGlvbiwgc3RhdGUgfSA9IGNoZWNrKHZtLmZldGNoVmFsdWUoX3N0YXRlKSwgQ2hlY2tDb21wb25lbnRJbnN0YW5jZSk7XG4gIGxldCB7IG1hbmFnZXIgfSA9IGRlZmluaXRpb247XG5cbiAgbGV0IHRhZ05hbWUgPSAobWFuYWdlciBhcyBSZWNhc3Q8XG4gICAgSW50ZXJuYWxDb21wb25lbnRNYW5hZ2VyLFxuICAgIFdpdGhEeW5hbWljVGFnTmFtZTx1bmtub3duPlxuICA+KS5nZXRUYWdOYW1lKHN0YXRlKTtcblxuICAvLyBVc2VyIHByb3ZpZGVkIHZhbHVlIGZyb20gSlMsIHNvIHdlIGRvbid0IGJvdGhlciB0byBlbmNvZGVcbiAgdm0uc3RhY2sucHVzaCh0YWdOYW1lKTtcbn0pO1xuXG4vLyBEeW5hbWljIEludm9jYXRpb24gT25seVxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkdldENvbXBvbmVudExheW91dCwgKHZtLCB7IG9wMTogX3N0YXRlIH0pID0+IHtcbiAgbGV0IGluc3RhbmNlID0gY2hlY2sodm0uZmV0Y2hWYWx1ZShfc3RhdGUpLCBDaGVja0NvbXBvbmVudEluc3RhbmNlKTtcblxuICBsZXQgeyBtYW5hZ2VyLCBkZWZpbml0aW9uIH0gPSBpbnN0YW5jZTtcbiAgbGV0IHsgc3RhY2sgfSA9IHZtO1xuXG4gIGxldCB7IGNvbXBpbGFibGUgfSA9IGRlZmluaXRpb247XG5cbiAgaWYgKGNvbXBpbGFibGUgPT09IG51bGwpIHtcbiAgICBsZXQgeyBjYXBhYmlsaXRpZXMgfSA9IGluc3RhbmNlO1xuXG4gICAgYXNzZXJ0KFxuICAgICAgbWFuYWdlckhhc0NhcGFiaWxpdHkobWFuYWdlciwgY2FwYWJpbGl0aWVzLCBJbnRlcm5hbENvbXBvbmVudENhcGFiaWxpdHkuRHluYW1pY0xheW91dCksXG4gICAgICAnQlVHOiBObyB0ZW1wbGF0ZSB3YXMgZm91bmQgZm9yIHRoaXMgY29tcG9uZW50LCBhbmQgdGhlIGNvbXBvbmVudCBkaWQgbm90IGhhdmUgdGhlIGR5bmFtaWMgbGF5b3V0IGNhcGFiaWxpdHknXG4gICAgKTtcblxuICAgIGNvbXBpbGFibGUgPSBtYW5hZ2VyLmdldER5bmFtaWNMYXlvdXQoaW5zdGFuY2Uuc3RhdGUsIHZtLnJ1bnRpbWUucmVzb2x2ZXIpO1xuXG4gICAgaWYgKGNvbXBpbGFibGUgPT09IG51bGwpIHtcbiAgICAgIGlmIChtYW5hZ2VySGFzQ2FwYWJpbGl0eShtYW5hZ2VyLCBjYXBhYmlsaXRpZXMsIEludGVybmFsQ29tcG9uZW50Q2FwYWJpbGl0eS5XcmFwcGVkKSkge1xuICAgICAgICBjb21waWxhYmxlID0gdW53cmFwVGVtcGxhdGUodm1bQ09OU1RBTlRTXS5kZWZhdWx0VGVtcGxhdGUpLmFzV3JhcHBlZExheW91dCgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29tcGlsYWJsZSA9IHVud3JhcFRlbXBsYXRlKHZtW0NPTlNUQU5UU10uZGVmYXVsdFRlbXBsYXRlKS5hc0xheW91dCgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGxldCBoYW5kbGUgPSBjb21waWxhYmxlLmNvbXBpbGUodm0uY29udGV4dCk7XG5cbiAgc3RhY2sucHVzaChjb21waWxhYmxlLnN5bWJvbFRhYmxlKTtcbiAgc3RhY2sucHVzaChoYW5kbGUpO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5NYWluLCAodm0sIHsgb3AxOiByZWdpc3RlciB9KSA9PiB7XG4gIGxldCBkZWZpbml0aW9uID0gY2hlY2sodm0uc3RhY2sucG9wKCksIENoZWNrQ29tcG9uZW50RGVmaW5pdGlvbik7XG4gIGxldCBpbnZvY2F0aW9uID0gY2hlY2sodm0uc3RhY2sucG9wKCksIENoZWNrSW52b2NhdGlvbik7XG5cbiAgbGV0IHsgbWFuYWdlciwgY2FwYWJpbGl0aWVzIH0gPSBkZWZpbml0aW9uO1xuXG4gIGxldCBzdGF0ZTogUG9wdWxhdGVkQ29tcG9uZW50SW5zdGFuY2UgPSB7XG4gICAgZGVmaW5pdGlvbixcbiAgICBtYW5hZ2VyLFxuICAgIGNhcGFiaWxpdGllcyxcbiAgICBzdGF0ZTogbnVsbCxcbiAgICBoYW5kbGU6IGludm9jYXRpb24uaGFuZGxlLFxuICAgIHRhYmxlOiBpbnZvY2F0aW9uLnN5bWJvbFRhYmxlLFxuICAgIGxvb2t1cDogbnVsbCxcbiAgfTtcblxuICB2bS5sb2FkVmFsdWUocmVnaXN0ZXIsIHN0YXRlKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuUG9wdWxhdGVMYXlvdXQsICh2bSwgeyBvcDE6IF9zdGF0ZSB9KSA9PiB7XG4gIGxldCB7IHN0YWNrIH0gPSB2bTtcblxuICAvLyBJbiBERUJVRyBoYW5kbGVzIGNvdWxkIGJlIEVyckhhbmRsZSBvYmplY3RzXG4gIGxldCBoYW5kbGUgPSBjaGVjayhzdGFjay5wb3AoKSwgQ2hlY2tIYW5kbGUpO1xuICBsZXQgdGFibGUgPSBjaGVjayhzdGFjay5wb3AoKSwgQ2hlY2tQcm9ncmFtU3ltYm9sVGFibGUpO1xuXG4gIGxldCBzdGF0ZSA9IGNoZWNrKHZtLmZldGNoVmFsdWUoX3N0YXRlKSwgQ2hlY2tDb21wb25lbnRJbnN0YW5jZSk7XG5cbiAgc3RhdGUuaGFuZGxlID0gaGFuZGxlO1xuICBzdGF0ZS50YWJsZSA9IHRhYmxlO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5WaXJ0dWFsUm9vdFNjb3BlLCAodm0sIHsgb3AxOiBfc3RhdGUgfSkgPT4ge1xuICBsZXQgeyB0YWJsZSwgbWFuYWdlciwgY2FwYWJpbGl0aWVzLCBzdGF0ZSB9ID0gY2hlY2soXG4gICAgdm0uZmV0Y2hWYWx1ZShfc3RhdGUpLFxuICAgIENoZWNrRmluaXNoZWRDb21wb25lbnRJbnN0YW5jZVxuICApO1xuXG4gIGxldCBvd25lcjtcblxuICBpZiAobWFuYWdlckhhc0NhcGFiaWxpdHkobWFuYWdlciwgY2FwYWJpbGl0aWVzLCBJbnRlcm5hbENvbXBvbmVudENhcGFiaWxpdHkuSGFzU3ViT3duZXIpKSB7XG4gICAgb3duZXIgPSBtYW5hZ2VyLmdldE93bmVyKHN0YXRlKTtcbiAgICB2bS5sb2FkVmFsdWUoJHQxLCBudWxsKTsgLy8gQ2xlYXIgdGhlIHRlbXAgcmVnaXN0ZXJcbiAgfSBlbHNlIHtcbiAgICAvLyBDaGVjayB0aGUgdGVtcCByZWdpc3RlciB0byBzZWUgaWYgYW4gb3duZXIgd2FzIHJlc29sdmVkIGZyb20gY3VycnlpbmdcbiAgICBvd25lciA9IHZtLmZldGNoVmFsdWU8T3duZXIgfCBudWxsPigkdDEpO1xuXG4gICAgaWYgKG93bmVyID09PSBudWxsKSB7XG4gICAgICAvLyBJZiBhbiBvd25lciB3YXNuJ3QgZm91bmQsIGRlZmF1bHQgdG8gdXNpbmcgdGhlIGN1cnJlbnQgb3duZXIuIFRoaXNcbiAgICAgIC8vIHdpbGwgaGFwcGVuIGZvciBub3JtYWwgZHluYW1pYyBjb21wb25lbnQgaW52b2NhdGlvbixcbiAgICAgIC8vIGUuZy4gPFNvbWVDbGFzc2ljRW1iZXJDb21wb25lbnQvPlxuICAgICAgb3duZXIgPSB2bS5nZXRPd25lcigpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBFbHNlIHRoZSBvd25lciB3YXMgZm91bmQsIHNvIGNsZWFyIHRoZSB0ZW1wIHJlZ2lzdGVyLiBUaGlzIHdpbGwgaGFwcGVuXG4gICAgICAvLyBpZiB3ZSBhcmUgbG9hZGluZyBhIGN1cnJpZWQgY29tcG9uZW50LCBlLmcuIDxAc29tZUN1cnJpZWRDb21wb25lbnQvPlxuICAgICAgdm0ubG9hZFZhbHVlKCR0MSwgbnVsbCk7XG4gICAgfVxuICB9XG5cbiAgdm0ucHVzaFJvb3RTY29wZSh0YWJsZS5zeW1ib2xzLmxlbmd0aCArIDEsIG93bmVyKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuU2V0dXBGb3JFdmFsLCAodm0sIHsgb3AxOiBfc3RhdGUgfSkgPT4ge1xuICBsZXQgc3RhdGUgPSBjaGVjayh2bS5mZXRjaFZhbHVlKF9zdGF0ZSksIENoZWNrRmluaXNoZWRDb21wb25lbnRJbnN0YW5jZSk7XG5cbiAgaWYgKHN0YXRlLnRhYmxlLmhhc0V2YWwpIHtcbiAgICBsZXQgbG9va3VwID0gKHN0YXRlLmxvb2t1cCA9IGRpY3Q8U2NvcGVTbG90PigpKTtcbiAgICB2bS5zY29wZSgpLmJpbmRFdmFsU2NvcGUobG9va3VwKTtcbiAgfVxufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5TZXROYW1lZFZhcmlhYmxlcywgKHZtLCB7IG9wMTogX3N0YXRlIH0pID0+IHtcbiAgbGV0IHN0YXRlID0gY2hlY2sodm0uZmV0Y2hWYWx1ZShfc3RhdGUpLCBDaGVja0ZpbmlzaGVkQ29tcG9uZW50SW5zdGFuY2UpO1xuICBsZXQgc2NvcGUgPSB2bS5zY29wZSgpO1xuXG4gIGxldCBhcmdzID0gY2hlY2sodm0uc3RhY2sucGVlaygpLCBDaGVja0FyZ3VtZW50cyk7XG4gIGxldCBjYWxsZXJOYW1lcyA9IGFyZ3MubmFtZWQuYXROYW1lcztcblxuICBmb3IgKGxldCBpID0gY2FsbGVyTmFtZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICBsZXQgYXROYW1lID0gY2FsbGVyTmFtZXNbaV07XG4gICAgbGV0IHN5bWJvbCA9IHN0YXRlLnRhYmxlLnN5bWJvbHMuaW5kZXhPZihjYWxsZXJOYW1lc1tpXSk7XG4gICAgbGV0IHZhbHVlID0gYXJncy5uYW1lZC5nZXQoYXROYW1lLCB0cnVlKTtcblxuICAgIGlmIChzeW1ib2wgIT09IC0xKSBzY29wZS5iaW5kU3ltYm9sKHN5bWJvbCArIDEsIHZhbHVlKTtcbiAgICBpZiAoc3RhdGUubG9va3VwKSBzdGF0ZS5sb29rdXBbYXROYW1lXSA9IHZhbHVlO1xuICB9XG59KTtcblxuZnVuY3Rpb24gYmluZEJsb2NrKFxuICBzeW1ib2xOYW1lOiBzdHJpbmcsXG4gIGJsb2NrTmFtZTogc3RyaW5nLFxuICBzdGF0ZTogQ29tcG9uZW50SW5zdGFuY2UsXG4gIGJsb2NrczogQmxvY2tBcmd1bWVudHNJbXBsLFxuICB2bTogSW50ZXJuYWxWTVxuKSB7XG4gIGxldCBzeW1ib2wgPSBzdGF0ZS50YWJsZS5zeW1ib2xzLmluZGV4T2Yoc3ltYm9sTmFtZSk7XG4gIGxldCBibG9jayA9IGJsb2Nrcy5nZXQoYmxvY2tOYW1lKTtcblxuICBpZiAoc3ltYm9sICE9PSAtMSkgdm0uc2NvcGUoKS5iaW5kQmxvY2soc3ltYm9sICsgMSwgYmxvY2spO1xuICBpZiAoc3RhdGUubG9va3VwKSBzdGF0ZS5sb29rdXBbc3ltYm9sTmFtZV0gPSBibG9jaztcbn1cblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLlNldEJsb2NrcywgKHZtLCB7IG9wMTogX3N0YXRlIH0pID0+IHtcbiAgbGV0IHN0YXRlID0gY2hlY2sodm0uZmV0Y2hWYWx1ZShfc3RhdGUpLCBDaGVja0ZpbmlzaGVkQ29tcG9uZW50SW5zdGFuY2UpO1xuICBsZXQgeyBibG9ja3MgfSA9IGNoZWNrKHZtLnN0YWNrLnBlZWsoKSwgQ2hlY2tBcmd1bWVudHMpO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYmxvY2tzLm5hbWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgYmluZEJsb2NrKGJsb2Nrcy5zeW1ib2xOYW1lc1tpXSwgYmxvY2tzLm5hbWVzW2ldLCBzdGF0ZSwgYmxvY2tzLCB2bSk7XG4gIH1cbn0pO1xuXG4vLyBEeW5hbWljIEludm9jYXRpb24gT25seVxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkludm9rZUNvbXBvbmVudExheW91dCwgKHZtLCB7IG9wMTogX3N0YXRlIH0pID0+IHtcbiAgbGV0IHN0YXRlID0gY2hlY2sodm0uZmV0Y2hWYWx1ZShfc3RhdGUpLCBDaGVja0ZpbmlzaGVkQ29tcG9uZW50SW5zdGFuY2UpO1xuXG4gIHZtLmNhbGwoc3RhdGUuaGFuZGxlISk7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkRpZFJlbmRlckxheW91dCwgKHZtLCB7IG9wMTogX3N0YXRlIH0pID0+IHtcbiAgbGV0IGluc3RhbmNlID0gY2hlY2sodm0uZmV0Y2hWYWx1ZShfc3RhdGUpLCBDaGVja0NvbXBvbmVudEluc3RhbmNlKTtcbiAgbGV0IHsgbWFuYWdlciwgc3RhdGUsIGNhcGFiaWxpdGllcyB9ID0gaW5zdGFuY2U7XG4gIGxldCBib3VuZHMgPSB2bS5lbGVtZW50cygpLnBvcEJsb2NrKCk7XG5cbiAgaWYgKHZtLmVudi5kZWJ1Z1JlbmRlclRyZWUgIT09IHVuZGVmaW5lZCkge1xuICAgIGlmIChoYXNDdXN0b21EZWJ1Z1JlbmRlclRyZWVMaWZlY3ljbGUobWFuYWdlcikpIHtcbiAgICAgIGxldCBub2RlcyA9IG1hbmFnZXIuZ2V0RGVidWdDdXN0b21SZW5kZXJUcmVlKGluc3RhbmNlLmRlZmluaXRpb24uc3RhdGUsIHN0YXRlLCBFTVBUWV9BUkdTKTtcblxuICAgICAgbm9kZXMucmV2ZXJzZSgpLmZvckVhY2goKG5vZGUpID0+IHtcbiAgICAgICAgbGV0IHsgYnVja2V0IH0gPSBub2RlO1xuXG4gICAgICAgIHZtLmVudi5kZWJ1Z1JlbmRlclRyZWUhLmRpZFJlbmRlcihidWNrZXQsIGJvdW5kcyk7XG5cbiAgICAgICAgdm0udXBkYXRlV2l0aChuZXcgRGVidWdSZW5kZXJUcmVlRGlkUmVuZGVyT3Bjb2RlKGJ1Y2tldCwgYm91bmRzKSk7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdm0uZW52LmRlYnVnUmVuZGVyVHJlZS5kaWRSZW5kZXIoaW5zdGFuY2UsIGJvdW5kcyk7XG5cbiAgICAgIHZtLnVwZGF0ZVdpdGgobmV3IERlYnVnUmVuZGVyVHJlZURpZFJlbmRlck9wY29kZShpbnN0YW5jZSwgYm91bmRzKSk7XG4gICAgfVxuICB9XG5cbiAgaWYgKG1hbmFnZXJIYXNDYXBhYmlsaXR5KG1hbmFnZXIsIGNhcGFiaWxpdGllcywgSW50ZXJuYWxDb21wb25lbnRDYXBhYmlsaXR5LkNyZWF0ZUluc3RhbmNlKSkge1xuICAgIGxldCBtZ3IgPSBjaGVjayhtYW5hZ2VyLCBDaGVja0ludGVyZmFjZSh7IGRpZFJlbmRlckxheW91dDogQ2hlY2tGdW5jdGlvbiB9KSk7XG4gICAgbWdyLmRpZFJlbmRlckxheW91dChzdGF0ZSwgYm91bmRzKTtcblxuICAgIHZtLmVudi5kaWRDcmVhdGUoaW5zdGFuY2UgYXMgQ29tcG9uZW50SW5zdGFuY2VXaXRoQ3JlYXRlKTtcbiAgICB2bS51cGRhdGVXaXRoKG5ldyBEaWRVcGRhdGVMYXlvdXRPcGNvZGUoaW5zdGFuY2UgYXMgQ29tcG9uZW50SW5zdGFuY2VXaXRoQ3JlYXRlLCBib3VuZHMpKTtcbiAgfVxufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5Db21taXRDb21wb25lbnRUcmFuc2FjdGlvbiwgKHZtKSA9PiB7XG4gIHZtLmNvbW1pdENhY2hlR3JvdXAoKTtcbn0pO1xuXG5leHBvcnQgY2xhc3MgVXBkYXRlQ29tcG9uZW50T3Bjb2RlIGltcGxlbWVudHMgVXBkYXRpbmdPcGNvZGUge1xuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIGNvbXBvbmVudDogQ29tcG9uZW50SW5zdGFuY2VTdGF0ZSxcbiAgICBwcml2YXRlIG1hbmFnZXI6IFdpdGhVcGRhdGVIb29rLFxuICAgIHByaXZhdGUgZHluYW1pY1Njb3BlOiBPcHRpb248RHluYW1pY1Njb3BlPlxuICApIHt9XG5cbiAgZXZhbHVhdGUoX3ZtOiBVcGRhdGluZ1ZNKSB7XG4gICAgbGV0IHsgY29tcG9uZW50LCBtYW5hZ2VyLCBkeW5hbWljU2NvcGUgfSA9IHRoaXM7XG5cbiAgICBtYW5hZ2VyLnVwZGF0ZShjb21wb25lbnQsIGR5bmFtaWNTY29wZSk7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIERpZFVwZGF0ZUxheW91dE9wY29kZSBpbXBsZW1lbnRzIFVwZGF0aW5nT3Bjb2RlIHtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSBjb21wb25lbnQ6IENvbXBvbmVudEluc3RhbmNlV2l0aENyZWF0ZSwgcHJpdmF0ZSBib3VuZHM6IEJvdW5kcykge31cblxuICBldmFsdWF0ZSh2bTogVXBkYXRpbmdWTSkge1xuICAgIGxldCB7IGNvbXBvbmVudCwgYm91bmRzIH0gPSB0aGlzO1xuICAgIGxldCB7IG1hbmFnZXIsIHN0YXRlIH0gPSBjb21wb25lbnQ7XG5cbiAgICBtYW5hZ2VyLmRpZFVwZGF0ZUxheW91dChzdGF0ZSwgYm91bmRzKTtcblxuICAgIHZtLmVudi5kaWRVcGRhdGUoY29tcG9uZW50KTtcbiAgfVxufVxuXG5jbGFzcyBEZWJ1Z1JlbmRlclRyZWVVcGRhdGVPcGNvZGUgaW1wbGVtZW50cyBVcGRhdGluZ09wY29kZSB7XG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgYnVja2V0OiBvYmplY3QpIHt9XG5cbiAgZXZhbHVhdGUodm06IFVwZGF0aW5nVk0pIHtcbiAgICB2bS5lbnYuZGVidWdSZW5kZXJUcmVlPy51cGRhdGUodGhpcy5idWNrZXQpO1xuICB9XG59XG5cbmNsYXNzIERlYnVnUmVuZGVyVHJlZURpZFJlbmRlck9wY29kZSBpbXBsZW1lbnRzIFVwZGF0aW5nT3Bjb2RlIHtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSBidWNrZXQ6IG9iamVjdCwgcHJpdmF0ZSBib3VuZHM6IEJvdW5kcykge31cblxuICBldmFsdWF0ZSh2bTogVXBkYXRpbmdWTSkge1xuICAgIHZtLmVudi5kZWJ1Z1JlbmRlclRyZWU/LmRpZFJlbmRlcih0aGlzLmJ1Y2tldCwgdGhpcy5ib3VuZHMpO1xuICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9