"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.DidUpdateLayoutOpcode = exports.UpdateComponentOpcode = exports.ComponentElementOperations = void 0;

var _env = require("@glimmer/env");

var _reference = require("@glimmer/reference");

var _util = require("@glimmer/util");

var _vm2 = require("@glimmer/vm");

var _destroyable = require("@glimmer/destroyable");

var _manager3 = require("@glimmer/manager");

var _resolve = require("../../component/resolve");

var _interfaces = require("../../component/interfaces");

var _opcodes = require("../../opcodes");

var _classList = _interopRequireDefault(require("../../references/class-list"));

var _symbols = require("../../symbols");

var _arguments = require("../../vm/arguments");

var _dom = require("./dom");

var _curriedValue = require("../../curried-value");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

_opcodes.APPEND_OPCODES.add(78
/* PushComponentDefinition */
, function (vm, _ref) {
  var handle = _ref.op1;

  var definition = vm[_symbols.CONSTANTS].getValue(handle);

  false && (0, _util.assert)(!!definition, "Missing component for " + handle);
  var manager = definition.manager,
      capabilities = definition.capabilities;
  var instance = {
    definition: definition,
    manager: manager,
    capabilities: capabilities,
    state: null,
    handle: null,
    table: null,
    lookup: null
  };
  vm.stack.push(instance);
});

_opcodes.APPEND_OPCODES.add(80
/* ResolveDynamicComponent */
, function (vm, _ref2) {
  var _isStrict = _ref2.op1;
  var stack = vm.stack;
  var component = (0, _reference.valueForRef)(stack.pop());
  var constants = vm[_symbols.CONSTANTS];
  var owner = vm.getOwner();
  var isStrict = constants.getValue(_isStrict);
  vm.loadValue(_vm2.$t1, null); // Clear the temp register

  var definition;

  if (typeof component === 'string') {
    if (_env.DEBUG && isStrict) {
      throw new Error("Attempted to resolve a dynamic component with a string definition, `" + component + "` in a strict mode template. In strict mode, using strings to resolve component definitions is prohibited. You can instead import the component definition and use it directly.");
    }

    var resolvedDefinition = (0, _resolve.resolveComponent)(vm.runtime.resolver, constants, component, owner);
    definition = resolvedDefinition;
  } else if ((0, _curriedValue.isCurriedValue)(component)) {
    definition = component;
  } else {
    definition = constants.component(component, owner);
  }

  stack.push(definition);
});

_opcodes.APPEND_OPCODES.add(81
/* ResolveCurriedComponent */
, function (vm) {
  var stack = vm.stack;
  var ref = stack.pop();
  var value = (0, _reference.valueForRef)(ref);
  var constants = vm[_symbols.CONSTANTS];
  var definition;

  if (_env.DEBUG && !(typeof value === 'function' || typeof value === 'object' && value !== null)) {
    throw new Error("Expected a component definition, but received " + value + ". You may have accidentally done <" + ref.debugLabel + ">, where \"" + ref.debugLabel + "\" was a string instead of a curried component definition. You must either use the component definition directly, or use the {{component}} helper to create a curried component definition when invoking dynamically.");
  }

  if ((0, _curriedValue.isCurriedValue)(value)) {
    definition = value;
  } else {
    definition = constants.component(value, vm.getOwner(), true);

    if (_env.DEBUG && definition === null) {
      throw new Error("Expected a dynamic component definition, but received an object or function that did not have a component manager associated with it. The dynamic invocation was `<" + ref.debugLabel + ">` or `{{" + ref.debugLabel + "}}`, and the incorrect definition is the value at the path `" + ref.debugLabel + "`, which was: " + (0, _util.debugToString)(value));
    }
  }

  stack.push(definition);
});

_opcodes.APPEND_OPCODES.add(79
/* PushDynamicComponentInstance */
, function (vm) {
  var stack = vm.stack;
  var definition = stack.pop();
  var capabilities, manager;

  if ((0, _curriedValue.isCurriedValue)(definition)) {
    manager = capabilities = null;
  } else {
    manager = definition.manager;
    capabilities = definition.capabilities;
  }

  stack.push({
    definition: definition,
    capabilities: capabilities,
    manager: manager,
    state: null,
    handle: null,
    table: null
  });
});

_opcodes.APPEND_OPCODES.add(82
/* PushArgs */
, function (vm, _ref3) {
  var _names = _ref3.op1,
      _blockNames = _ref3.op2,
      flags = _ref3.op3;
  var stack = vm.stack;

  var names = vm[_symbols.CONSTANTS].getArray(_names);

  var positionalCount = flags >> 4;
  var atNames = flags & 8;
  var blockNames = flags & 7 ? vm[_symbols.CONSTANTS].getArray(_blockNames) : _util.EMPTY_STRING_ARRAY;

  vm[_symbols.ARGS].setup(stack, names, blockNames, positionalCount, !!atNames);

  stack.push(vm[_symbols.ARGS]);
});

_opcodes.APPEND_OPCODES.add(83
/* PushEmptyArgs */
, function (vm) {
  var stack = vm.stack;
  stack.push(vm[_symbols.ARGS].empty(stack));
});

_opcodes.APPEND_OPCODES.add(86
/* CaptureArgs */
, function (vm) {
  var stack = vm.stack;
  var args = stack.pop();
  var capturedArgs = args.capture();
  stack.push(capturedArgs);
});

_opcodes.APPEND_OPCODES.add(85
/* PrepareArgs */
, function (vm, _ref4) {
  var _state = _ref4.op1;
  var stack = vm.stack;
  var instance = vm.fetchValue(_state);
  var args = stack.pop();
  var definition = instance.definition;

  if ((0, _curriedValue.isCurriedType)(definition, 0
  /* Component */
  )) {
    false && (0, _util.assert)(!definition.manager, "If the component definition was curried, we don't yet have a manager");
    var constants = vm[_symbols.CONSTANTS];

    var _resolveCurriedValue = (0, _curriedValue.resolveCurriedValue)(definition),
        resolvedDefinition = _resolveCurriedValue.definition,
        owner = _resolveCurriedValue.owner,
        resolved = _resolveCurriedValue.resolved,
        positional = _resolveCurriedValue.positional,
        named = _resolveCurriedValue.named;

    if (resolved === true) {
      definition = resolvedDefinition;
    } else if (typeof resolvedDefinition === 'string') {
      var resolvedValue = vm.runtime.resolver.lookupComponent(resolvedDefinition, owner);
      definition = constants.resolvedComponent(resolvedValue, resolvedDefinition);
    } else {
      definition = constants.component(resolvedDefinition, owner);
    }

    if (named !== undefined) {
      args.named.merge(_util.assign.apply(void 0, [{}].concat(named)));
    }

    if (positional !== undefined) {
      args.realloc(positional.length);
      args.positional.prepend(positional);
    }

    var _definition = definition,
        _manager = _definition.manager;
    false && (0, _util.assert)(instance.manager === null, 'component instance manager should not be populated yet');
    false && (0, _util.assert)(instance.capabilities === null, 'component instance manager should not be populated yet');
    instance.definition = definition;
    instance.manager = _manager;
    instance.capabilities = definition.capabilities; // Save off the owner that this component was curried with. Later on,
    // we'll fetch the value of this register and set it as the owner on the
    // new root scope.

    vm.loadValue(_vm2.$t1, owner);
  }

  var _definition2 = definition,
      manager = _definition2.manager,
      state = _definition2.state;
  var capabilities = instance.capabilities;

  if (!(0, _manager3.managerHasCapability)(manager, capabilities, 4
  /* PrepareArgs */
  )) {
    stack.push(args);
    return;
  }

  var blocks = args.blocks.values;
  var blockNames = args.blocks.names;
  var preparedArgs = manager.prepareArgs(state, args);

  if (preparedArgs) {
    args.clear();

    for (var i = 0; i < blocks.length; i++) {
      stack.push(blocks[i]);
    }

    var _positional = preparedArgs.positional,
        _named = preparedArgs.named;
    var positionalCount = _positional.length;

    for (var _i = 0; _i < positionalCount; _i++) {
      stack.push(_positional[_i]);
    }

    var names = Object.keys(_named);

    for (var _i2 = 0; _i2 < names.length; _i2++) {
      stack.push(_named[names[_i2]]);
    }

    args.setup(stack, names, blockNames, positionalCount, false);
  }

  stack.push(args);
});

_opcodes.APPEND_OPCODES.add(87
/* CreateComponent */
, function (vm, _ref5) {
  var flags = _ref5.op1,
      _state = _ref5.op2;
  var instance = vm.fetchValue(_state);
  var definition = instance.definition,
      manager = instance.manager,
      capabilities = instance.capabilities;

  if (!(0, _manager3.managerHasCapability)(manager, capabilities, 512
  /* CreateInstance */
  )) {
    // TODO: Closure and Main components are always invoked dynamically, so this
    // opcode may run even if this capability is not enabled. In the future we
    // should handle this in a better way.
    return;
  }

  var dynamicScope = null;

  if ((0, _manager3.managerHasCapability)(manager, capabilities, 64
  /* DynamicScope */
  )) {
    dynamicScope = vm.dynamicScope();
  }

  var hasDefaultBlock = flags & 1;
  var args = null;

  if ((0, _manager3.managerHasCapability)(manager, capabilities, 8
  /* CreateArgs */
  )) {
    args = vm.stack.peek();
  }

  var self = null;

  if ((0, _manager3.managerHasCapability)(manager, capabilities, 128
  /* CreateCaller */
  )) {
    self = vm.getSelf();
  }

  var state = manager.create(vm.getOwner(), definition.state, args, vm.env, dynamicScope, self, !!hasDefaultBlock); // We want to reuse the `state` POJO here, because we know that the opcodes
  // only transition at exactly one place.

  instance.state = state;

  if ((0, _manager3.managerHasCapability)(manager, capabilities, 256
  /* UpdateHook */
  )) {
    vm.updateWith(new UpdateComponentOpcode(state, manager, dynamicScope));
  }
});

_opcodes.APPEND_OPCODES.add(88
/* RegisterComponentDestructor */
, function (vm, _ref6) {
  var _state = _ref6.op1;

  var _vm$fetchValue = vm.fetchValue(_state),
      manager = _vm$fetchValue.manager,
      state = _vm$fetchValue.state,
      capabilities = _vm$fetchValue.capabilities;

  var d = manager.getDestroyable(state);

  if (_env.DEBUG && !(0, _manager3.managerHasCapability)(manager, capabilities, 2048
  /* WillDestroy */
  ) && d !== null && typeof 'willDestroy' in d) {
    throw new Error('BUG: Destructor has willDestroy, but the willDestroy capability was not enabled for this component. Pre-destruction hooks must be explicitly opted into');
  }

  if (d) vm.associateDestroyable(d);
});

_opcodes.APPEND_OPCODES.add(97
/* BeginComponentTransaction */
, function (vm, _ref7) {
  var _state = _ref7.op1;

  var _a;

  var name;

  if (_env.DEBUG) {
    var _vm$fetchValue2 = vm.fetchValue(_state),
        definition = _vm$fetchValue2.definition,
        manager = _vm$fetchValue2.manager;

    name = (_a = definition.resolvedName) !== null && _a !== void 0 ? _a : manager.getDebugName(definition.state);
  }

  vm.beginCacheGroup(name);
  vm.elements().pushSimpleBlock();
});

_opcodes.APPEND_OPCODES.add(89
/* PutComponentOperations */
, function (vm) {
  vm.loadValue(_vm2.$t0, new ComponentElementOperations());
});

_opcodes.APPEND_OPCODES.add(53
/* ComponentAttr */
, function (vm, _ref8) {
  var _name = _ref8.op1,
      _trusting = _ref8.op2,
      _namespace = _ref8.op3;

  var name = vm[_symbols.CONSTANTS].getValue(_name);

  var trusting = vm[_symbols.CONSTANTS].getValue(_trusting);

  var reference = vm.stack.pop();
  var namespace = _namespace ? vm[_symbols.CONSTANTS].getValue(_namespace) : null;
  vm.fetchValue(_vm2.$t0).setAttribute(name, reference, trusting, namespace);
});

_opcodes.APPEND_OPCODES.add(105
/* StaticComponentAttr */
, function (vm, _ref9) {
  var _name = _ref9.op1,
      _value = _ref9.op2,
      _namespace = _ref9.op3;

  var name = vm[_symbols.CONSTANTS].getValue(_name);

  var value = vm[_symbols.CONSTANTS].getValue(_value);

  var namespace = _namespace ? vm[_symbols.CONSTANTS].getValue(_namespace) : null;
  vm.fetchValue(_vm2.$t0).setStaticAttribute(name, value, namespace);
});

var ComponentElementOperations = /*#__PURE__*/function () {
  function ComponentElementOperations() {
    this.attributes = (0, _util.dict)();
    this.classes = [];
    this.modifiers = [];
  }

  var _proto = ComponentElementOperations.prototype;

  _proto.setAttribute = function setAttribute(name, value, trusting, namespace) {
    var deferred = {
      value: value,
      namespace: namespace,
      trusting: trusting
    };

    if (name === 'class') {
      this.classes.push(value);
    }

    this.attributes[name] = deferred;
  };

  _proto.setStaticAttribute = function setStaticAttribute(name, value, namespace) {
    var deferred = {
      value: value,
      namespace: namespace
    };

    if (name === 'class') {
      this.classes.push(value);
    }

    this.attributes[name] = deferred;
  };

  _proto.addModifier = function addModifier(modifier) {
    this.modifiers.push(modifier);
  };

  _proto.flush = function flush(vm) {
    var type;
    var attributes = this.attributes;

    for (var name in this.attributes) {
      if (name === 'type') {
        type = attributes[name];
        continue;
      }

      var attr = this.attributes[name];

      if (name === 'class') {
        setDeferredAttr(vm, 'class', mergeClasses(this.classes), attr.namespace, attr.trusting);
      } else {
        setDeferredAttr(vm, name, attr.value, attr.namespace, attr.trusting);
      }
    }

    if (type !== undefined) {
      setDeferredAttr(vm, 'type', type.value, type.namespace, type.trusting);
    }

    return this.modifiers;
  };

  return ComponentElementOperations;
}();

exports.ComponentElementOperations = ComponentElementOperations;

function mergeClasses(classes) {
  if (classes.length === 0) {
    return '';
  }

  if (classes.length === 1) {
    return classes[0];
  }

  if (allStringClasses(classes)) {
    return classes.join(' ');
  }

  return (0, _classList.default)(classes);
}

function allStringClasses(classes) {
  for (var i = 0; i < classes.length; i++) {
    if (typeof classes[i] !== 'string') {
      return false;
    }
  }

  return true;
}

function setDeferredAttr(vm, name, value, namespace, trusting) {
  if (trusting === void 0) {
    trusting = false;
  }

  if (typeof value === 'string') {
    vm.elements().setStaticAttribute(name, value, namespace);
  } else {
    var attribute = vm.elements().setDynamicAttribute(name, (0, _reference.valueForRef)(value), trusting, namespace);

    if (!(0, _reference.isConstRef)(value)) {
      vm.updateWith(new _dom.UpdateDynamicAttributeOpcode(value, attribute, vm.env));
    }
  }
}

_opcodes.APPEND_OPCODES.add(99
/* DidCreateElement */
, function (vm, _ref10) {
  var _state = _ref10.op1;

  var _vm$fetchValue3 = vm.fetchValue(_state),
      definition = _vm$fetchValue3.definition,
      state = _vm$fetchValue3.state;

  var manager = definition.manager;
  var operations = vm.fetchValue(_vm2.$t0);
  manager.didCreateElement(state, vm.elements().constructing, operations);
});

_opcodes.APPEND_OPCODES.add(90
/* GetComponentSelf */
, function (vm, _ref11) {
  var _state = _ref11.op1,
      _names = _ref11.op2;

  var _a;

  var instance = vm.fetchValue(_state);
  var definition = instance.definition,
      state = instance.state;
  var manager = definition.manager;
  var selfRef = manager.getSelf(state);

  if (vm.env.debugRenderTree !== undefined) {
    var _instance = vm.fetchValue(_state);

    var _definition3 = _instance.definition,
        _manager2 = _instance.manager;
    var args;

    if (vm.stack.peek() === vm[_symbols.ARGS]) {
      args = vm[_symbols.ARGS].capture();
    } else {
      var names = vm[_symbols.CONSTANTS].getArray(_names);

      vm[_symbols.ARGS].setup(vm.stack, names, [], 0, true);

      args = vm[_symbols.ARGS].capture();
    }

    var moduleName;
    var compilable = _definition3.compilable;

    if (compilable === null) {
      false && (0, _util.assert)((0, _manager3.managerHasCapability)(_manager2, _instance.capabilities, 1
      /* DynamicLayout */
      ), 'BUG: No template was found for this component, and the component did not have the dynamic layout capability');
      compilable = _manager2.getDynamicLayout(state, vm.runtime.resolver);

      if (compilable !== null) {
        moduleName = compilable.moduleName;
      } else {
        moduleName = '__default__.hbs';
      }
    } else {
      moduleName = compilable.moduleName;
    } // For tearing down the debugRenderTree


    vm.associateDestroyable(_instance);

    if ((0, _interfaces.hasCustomDebugRenderTreeLifecycle)(_manager2)) {
      var nodes = _manager2.getDebugCustomRenderTree(_instance.definition.state, _instance.state, args, moduleName);

      nodes.forEach(function (node) {
        var bucket = node.bucket;
        vm.env.debugRenderTree.create(bucket, node);
        (0, _destroyable.registerDestructor)(_instance, function () {
          var _a;

          (_a = vm.env.debugRenderTree) === null || _a === void 0 ? void 0 : _a.willDestroy(bucket);
        });
        vm.updateWith(new DebugRenderTreeUpdateOpcode(bucket));
      });
    } else {
      var name = (_a = _definition3.resolvedName) !== null && _a !== void 0 ? _a : _manager2.getDebugName(_definition3.state);
      vm.env.debugRenderTree.create(_instance, {
        type: 'component',
        name: name,
        args: args,
        template: moduleName,
        instance: (0, _reference.valueForRef)(selfRef)
      });
      vm.associateDestroyable(_instance);
      (0, _destroyable.registerDestructor)(_instance, function () {
        var _a;

        (_a = vm.env.debugRenderTree) === null || _a === void 0 ? void 0 : _a.willDestroy(_instance);
      });
      vm.updateWith(new DebugRenderTreeUpdateOpcode(_instance));
    }
  }

  vm.stack.push(selfRef);
});

_opcodes.APPEND_OPCODES.add(91
/* GetComponentTagName */
, function (vm, _ref12) {
  var _state = _ref12.op1;

  var _vm$fetchValue4 = vm.fetchValue(_state),
      definition = _vm$fetchValue4.definition,
      state = _vm$fetchValue4.state;

  var manager = definition.manager;
  var tagName = manager.getTagName(state); // User provided value from JS, so we don't bother to encode

  vm.stack.push(tagName);
}); // Dynamic Invocation Only


_opcodes.APPEND_OPCODES.add(92
/* GetComponentLayout */
, function (vm, _ref13) {
  var _state = _ref13.op1;
  var instance = vm.fetchValue(_state);
  var manager = instance.manager,
      definition = instance.definition;
  var stack = vm.stack;
  var compilable = definition.compilable;

  if (compilable === null) {
    var capabilities = instance.capabilities;
    false && (0, _util.assert)((0, _manager3.managerHasCapability)(manager, capabilities, 1
    /* DynamicLayout */
    ), 'BUG: No template was found for this component, and the component did not have the dynamic layout capability');
    compilable = manager.getDynamicLayout(instance.state, vm.runtime.resolver);

    if (compilable === null) {
      if ((0, _manager3.managerHasCapability)(manager, capabilities, 1024
      /* Wrapped */
      )) {
        compilable = (0, _util.unwrapTemplate)(vm[_symbols.CONSTANTS].defaultTemplate).asWrappedLayout();
      } else {
        compilable = (0, _util.unwrapTemplate)(vm[_symbols.CONSTANTS].defaultTemplate).asLayout();
      }
    }
  }

  var handle = compilable.compile(vm.context);
  stack.push(compilable.symbolTable);
  stack.push(handle);
});

_opcodes.APPEND_OPCODES.add(75
/* Main */
, function (vm, _ref14) {
  var register = _ref14.op1;
  var definition = vm.stack.pop();
  var invocation = vm.stack.pop();
  var manager = definition.manager,
      capabilities = definition.capabilities;
  var state = {
    definition: definition,
    manager: manager,
    capabilities: capabilities,
    state: null,
    handle: invocation.handle,
    table: invocation.symbolTable,
    lookup: null
  };
  vm.loadValue(register, state);
});

_opcodes.APPEND_OPCODES.add(95
/* PopulateLayout */
, function (vm, _ref15) {
  var _state = _ref15.op1;
  var stack = vm.stack; // In DEBUG handles could be ErrHandle objects

  var handle = stack.pop();
  var table = stack.pop();
  var state = vm.fetchValue(_state);
  state.handle = handle;
  state.table = table;
});

_opcodes.APPEND_OPCODES.add(38
/* VirtualRootScope */
, function (vm, _ref16) {
  var _state = _ref16.op1;

  var _vm$fetchValue5 = vm.fetchValue(_state),
      table = _vm$fetchValue5.table,
      manager = _vm$fetchValue5.manager,
      capabilities = _vm$fetchValue5.capabilities,
      state = _vm$fetchValue5.state;

  var owner;

  if ((0, _manager3.managerHasCapability)(manager, capabilities, 4096
  /* HasSubOwner */
  )) {
    owner = manager.getOwner(state);
    vm.loadValue(_vm2.$t1, null); // Clear the temp register
  } else {
    // Check the temp register to see if an owner was resolved from currying
    owner = vm.fetchValue(_vm2.$t1);

    if (owner === null) {
      // If an owner wasn't found, default to using the current owner. This
      // will happen for normal dynamic component invocation,
      // e.g. <SomeClassicEmberComponent/>
      owner = vm.getOwner();
    } else {
      // Else the owner was found, so clear the temp register. This will happen
      // if we are loading a curried component, e.g. <@someCurriedComponent/>
      vm.loadValue(_vm2.$t1, null);
    }
  }

  vm.pushRootScope(table.symbols.length + 1, owner);
});

_opcodes.APPEND_OPCODES.add(94
/* SetupForEval */
, function (vm, _ref17) {
  var _state = _ref17.op1;
  var state = vm.fetchValue(_state);

  if (state.table.hasEval) {
    var lookup = state.lookup = (0, _util.dict)();
    vm.scope().bindEvalScope(lookup);
  }
});

_opcodes.APPEND_OPCODES.add(17
/* SetNamedVariables */
, function (vm, _ref18) {
  var _state = _ref18.op1;
  var state = vm.fetchValue(_state);
  var scope = vm.scope();
  var args = vm.stack.peek();
  var callerNames = args.named.atNames;

  for (var i = callerNames.length - 1; i >= 0; i--) {
    var atName = callerNames[i];
    var symbol = state.table.symbols.indexOf(callerNames[i]);
    var value = args.named.get(atName, true);
    if (symbol !== -1) scope.bindSymbol(symbol + 1, value);
    if (state.lookup) state.lookup[atName] = value;
  }
});

function bindBlock(symbolName, blockName, state, blocks, vm) {
  var symbol = state.table.symbols.indexOf(symbolName);
  var block = blocks.get(blockName);
  if (symbol !== -1) vm.scope().bindBlock(symbol + 1, block);
  if (state.lookup) state.lookup[symbolName] = block;
}

_opcodes.APPEND_OPCODES.add(18
/* SetBlocks */
, function (vm, _ref19) {
  var _state = _ref19.op1;
  var state = vm.fetchValue(_state);

  var _vm$stack$peek = vm.stack.peek(),
      blocks = _vm$stack$peek.blocks;

  for (var i = 0; i < blocks.names.length; i++) {
    bindBlock(blocks.symbolNames[i], blocks.names[i], state, blocks, vm);
  }
}); // Dynamic Invocation Only


_opcodes.APPEND_OPCODES.add(96
/* InvokeComponentLayout */
, function (vm, _ref20) {
  var _state = _ref20.op1;
  var state = vm.fetchValue(_state);
  vm.call(state.handle);
});

_opcodes.APPEND_OPCODES.add(100
/* DidRenderLayout */
, function (vm, _ref21) {
  var _state = _ref21.op1;
  var instance = vm.fetchValue(_state);
  var manager = instance.manager,
      state = instance.state,
      capabilities = instance.capabilities;
  var bounds = vm.elements().popBlock();

  if (vm.env.debugRenderTree !== undefined) {
    if ((0, _interfaces.hasCustomDebugRenderTreeLifecycle)(manager)) {
      var nodes = manager.getDebugCustomRenderTree(instance.definition.state, state, _arguments.EMPTY_ARGS);
      nodes.reverse().forEach(function (node) {
        var bucket = node.bucket;
        vm.env.debugRenderTree.didRender(bucket, bounds);
        vm.updateWith(new DebugRenderTreeDidRenderOpcode(bucket, bounds));
      });
    } else {
      vm.env.debugRenderTree.didRender(instance, bounds);
      vm.updateWith(new DebugRenderTreeDidRenderOpcode(instance, bounds));
    }
  }

  if ((0, _manager3.managerHasCapability)(manager, capabilities, 512
  /* CreateInstance */
  )) {
    var mgr = manager;
    mgr.didRenderLayout(state, bounds);
    vm.env.didCreate(instance);
    vm.updateWith(new DidUpdateLayoutOpcode(instance, bounds));
  }
});

_opcodes.APPEND_OPCODES.add(98
/* CommitComponentTransaction */
, function (vm) {
  vm.commitCacheGroup();
});

var UpdateComponentOpcode = /*#__PURE__*/function () {
  function UpdateComponentOpcode(component, manager, dynamicScope) {
    this.component = component;
    this.manager = manager;
    this.dynamicScope = dynamicScope;
  }

  var _proto2 = UpdateComponentOpcode.prototype;

  _proto2.evaluate = function evaluate(_vm) {
    var component = this.component,
        manager = this.manager,
        dynamicScope = this.dynamicScope;
    manager.update(component, dynamicScope);
  };

  return UpdateComponentOpcode;
}();

exports.UpdateComponentOpcode = UpdateComponentOpcode;

var DidUpdateLayoutOpcode = /*#__PURE__*/function () {
  function DidUpdateLayoutOpcode(component, bounds) {
    this.component = component;
    this.bounds = bounds;
  }

  var _proto3 = DidUpdateLayoutOpcode.prototype;

  _proto3.evaluate = function evaluate(vm) {
    var component = this.component,
        bounds = this.bounds;
    var manager = component.manager,
        state = component.state;
    manager.didUpdateLayout(state, bounds);
    vm.env.didUpdate(component);
  };

  return DidUpdateLayoutOpcode;
}();

exports.DidUpdateLayoutOpcode = DidUpdateLayoutOpcode;

var DebugRenderTreeUpdateOpcode = /*#__PURE__*/function () {
  function DebugRenderTreeUpdateOpcode(bucket) {
    this.bucket = bucket;
  }

  var _proto4 = DebugRenderTreeUpdateOpcode.prototype;

  _proto4.evaluate = function evaluate(vm) {
    var _a;

    (_a = vm.env.debugRenderTree) === null || _a === void 0 ? void 0 : _a.update(this.bucket);
  };

  return DebugRenderTreeUpdateOpcode;
}();

var DebugRenderTreeDidRenderOpcode = /*#__PURE__*/function () {
  function DebugRenderTreeDidRenderOpcode(bucket, bounds) {
    this.bucket = bucket;
    this.bounds = bounds;
  }

  var _proto5 = DebugRenderTreeDidRenderOpcode.prototype;

  _proto5.evaluate = function evaluate(vm) {
    var _a;

    (_a = vm.env.debugRenderTree) === null || _a === void 0 ? void 0 : _a.didRender(this.bucket, this.bounds);
  };

  return DebugRenderTreeDidRenderOpcode;
}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL3J1bnRpbWUvbGliL2NvbXBpbGVkL29wY29kZXMvY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFVQTs7QUE2QkE7O0FBQ0E7O0FBU0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBR0E7O0FBVUE7O0FBQ0E7Ozs7QUEwQ0Esd0JBQUEsR0FBQSxDQUFrQjtBQUFBO0FBQWxCLEVBQStDLFVBQUEsRUFBQSxFQUFBLElBQUEsRUFBd0I7QUFBQSxNQUFaLE1BQVksR0FBQSxJQUFBLENBQWpCLEdBQWlCOztBQUNyRSxNQUFJLFVBQVUsR0FBRyxFQUFFLENBQUYsa0JBQUUsQ0FBRixDQUFBLFFBQUEsQ0FBakIsTUFBaUIsQ0FBakI7O0FBRHFFLFdBRXJFLGtCQUFPLENBQUMsQ0FBRixVQUFOLEVBQU0sMkJBRitELE1BRXJFLENBRnFFO0FBQUEsTUFJakUsT0FKaUUsR0FJckUsVUFKcUUsQ0FBQSxPQUFBO0FBQUEsTUFJdEQsWUFKc0QsR0FJckUsVUFKcUUsQ0FBQSxZQUFBO0FBTXJFLE1BQUksUUFBUSxHQUE2QjtBQUN2QyxJQUFBLFVBRHVDLEVBQUEsVUFBQTtBQUV2QyxJQUFBLE9BRnVDLEVBQUEsT0FBQTtBQUd2QyxJQUFBLFlBSHVDLEVBQUEsWUFBQTtBQUl2QyxJQUFBLEtBQUssRUFKa0MsSUFBQTtBQUt2QyxJQUFBLE1BQU0sRUFMaUMsSUFBQTtBQU12QyxJQUFBLEtBQUssRUFOa0MsSUFBQTtBQU92QyxJQUFBLE1BQU0sRUFBRTtBQVArQixHQUF6QztBQVVBLEVBQUEsRUFBRSxDQUFGLEtBQUEsQ0FBQSxJQUFBLENBQUEsUUFBQTtBQWhCRixDQUFBOztBQW1CQSx3QkFBQSxHQUFBLENBQWtCO0FBQUE7QUFBbEIsRUFBK0MsVUFBQSxFQUFBLEVBQUEsS0FBQSxFQUEyQjtBQUFBLE1BQWYsU0FBZSxHQUFBLEtBQUEsQ0FB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Q0osTUFESSxHQUFBLEtBQUEsTUFBQTtBQUFBLFFBRWpCLE9BRmlCLEdBRXJCLFNBRnFCLENBQUEsT0FBQTtBQUFBLFFBRU4sS0FGTSxHQUVyQixTQUZxQixDQUFBLEtBQUE7QUFJckIsSUFBQSxPQUFPLENBQVAsZUFBQSxDQUFBLEtBQUEsRUFBQSxNQUFBO0FBRUEsSUFBQSxFQUFFLENBQUYsR0FBQSxDQUFBLFNBQUEsQ0FBQSxTQUFBO0FBVEosR0FBQTs7QUFBQSxTQUFBLHFCQUFBO0FBQUEsQ0FBQSxFQUFBOzs7O0lBYUEsMkI7QUFDRSxXQUFBLDJCQUFBLENBQUEsTUFBQSxFQUFrQztBQUFkLFNBQUEsTUFBQSxHQUFBLE1BQUE7QUFBa0I7Ozs7VUFFdEMsUSxHQUFBLFNBQUEsUUFBQSxDQUFBLEVBQUEsRUFBdUI7OztBQUNyQixLQUFBLEVBQUEsR0FBQSxFQUFFLENBQUYsR0FBQSxDQUFBLGVBQUEsTUFBQSxJQUFBLElBQXNCLEVBQUEsS0FBQSxLQUF0QixDQUFBLEdBQXNCLEtBQXRCLENBQUEsR0FBc0IsRUFBQSxDQUFBLE1BQUEsQ0FBUyxLQUEvQixNQUFzQixDQUF0Qjs7Ozs7O0lBSUosOEI7QUFDRSxXQUFBLDhCQUFBLENBQUEsTUFBQSxFQUFBLE1BQUEsRUFBMEQ7QUFBdEMsU0FBQSxNQUFBLEdBQUEsTUFBQTtBQUF3QixTQUFBLE1BQUEsR0FBQSxNQUFBO0FBQWtCOzs7O1VBRTlELFEsR0FBQSxTQUFBLFFBQUEsQ0FBQSxFQUFBLEVBQXVCOzs7QUFDckIsS0FBQSxFQUFBLEdBQUEsRUFBRSxDQUFGLEdBQUEsQ0FBQSxlQUFBLE1BQUEsSUFBQSxJQUFzQixFQUFBLEtBQUEsS0FBdEIsQ0FBQSxHQUFzQixLQUF0QixDQUFBLEdBQXNCLEVBQUEsQ0FBQSxTQUFBLENBQVksS0FBWixNQUFBLEVBQXlCLEtBQS9DLE1BQXNCLENBQXRCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgY2hlY2ssXG4gIENoZWNrRnVuY3Rpb24sXG4gIENoZWNrSGFuZGxlLFxuICBDaGVja0luc3RhbmNlb2YsXG4gIENoZWNrSW50ZXJmYWNlLFxuICBDaGVja1Byb2dyYW1TeW1ib2xUYWJsZSxcbiAgQ2hlY2tTdHJpbmcsXG4gIENoZWNrT3IsXG59IGZyb20gJ0BnbGltbWVyL2RlYnVnJztcbmltcG9ydCB7IERFQlVHIH0gZnJvbSAnQGdsaW1tZXIvZW52JztcbmltcG9ydCB7XG4gIEJvdW5kcyxcbiAgQ29tcG9uZW50RGVmaW5pdGlvbixcbiAgSW50ZXJuYWxDb21wb25lbnRDYXBhYmlsaXR5LFxuICBDb21wb25lbnREZWZpbml0aW9uU3RhdGUsXG4gIENvbXBvbmVudEluc3RhbmNlU3RhdGUsXG4gIEludGVybmFsQ29tcG9uZW50TWFuYWdlcixcbiAgRGljdCxcbiAgRHluYW1pY1Njb3BlLFxuICBFbGVtZW50T3BlcmF0aW9ucyxcbiAgT3AsXG4gIE9wdGlvbixcbiAgUHJvZ3JhbVN5bWJvbFRhYmxlLFxuICBSZWNhc3QsXG4gIFNjb3BlU2xvdCxcbiAgVk1Bcmd1bWVudHMsXG4gIFdpdGhEeW5hbWljVGFnTmFtZSxcbiAgV2l0aEVsZW1lbnRIb29rLFxuICBXaXRoVXBkYXRlSG9vayxcbiAgQ2FwdHVyZWRBcmd1bWVudHMsXG4gIENvbXBpbGFibGVQcm9ncmFtLFxuICBDb21wb25lbnRJbnN0YW5jZSxcbiAgTW9kaWZpZXJJbnN0YW5jZSxcbiAgQ29tcG9uZW50SW5zdGFuY2VXaXRoQ3JlYXRlLFxuICBPd25lcixcbiAgQ3VycmllZFR5cGUsXG4gIFVwZGF0aW5nT3Bjb2RlLFxufSBmcm9tICdAZ2xpbW1lci9pbnRlcmZhY2VzJztcbmltcG9ydCB7IGlzQ29uc3RSZWYsIFJlZmVyZW5jZSwgdmFsdWVGb3JSZWYgfSBmcm9tICdAZ2xpbW1lci9yZWZlcmVuY2UnO1xuaW1wb3J0IHtcbiAgYXNzZXJ0LFxuICBhc3NpZ24sXG4gIGRlYnVnVG9TdHJpbmcsXG4gIGRpY3QsXG4gIEVNUFRZX1NUUklOR19BUlJBWSxcbiAgZXhwZWN0LFxuICB1bndyYXBUZW1wbGF0ZSxcbn0gZnJvbSAnQGdsaW1tZXIvdXRpbCc7XG5pbXBvcnQgeyAkdDAsICR0MSB9IGZyb20gJ0BnbGltbWVyL3ZtJztcbmltcG9ydCB7IHJlZ2lzdGVyRGVzdHJ1Y3RvciB9IGZyb20gJ0BnbGltbWVyL2Rlc3Ryb3lhYmxlJztcbmltcG9ydCB7IG1hbmFnZXJIYXNDYXBhYmlsaXR5IH0gZnJvbSAnQGdsaW1tZXIvbWFuYWdlcic7XG5pbXBvcnQgeyByZXNvbHZlQ29tcG9uZW50IH0gZnJvbSAnLi4vLi4vY29tcG9uZW50L3Jlc29sdmUnO1xuaW1wb3J0IHsgaGFzQ3VzdG9tRGVidWdSZW5kZXJUcmVlTGlmZWN5Y2xlIH0gZnJvbSAnLi4vLi4vY29tcG9uZW50L2ludGVyZmFjZXMnO1xuaW1wb3J0IHsgQVBQRU5EX09QQ09ERVMgfSBmcm9tICcuLi8uLi9vcGNvZGVzJztcbmltcG9ydCBjcmVhdGVDbGFzc0xpc3RSZWYgZnJvbSAnLi4vLi4vcmVmZXJlbmNlcy9jbGFzcy1saXN0JztcbmltcG9ydCB7IEFSR1MsIENPTlNUQU5UUyB9IGZyb20gJy4uLy4uL3N5bWJvbHMnO1xuaW1wb3J0IHsgVXBkYXRpbmdWTSB9IGZyb20gJy4uLy4uL3ZtJztcbmltcG9ydCB7IEludGVybmFsVk0gfSBmcm9tICcuLi8uLi92bS9hcHBlbmQnO1xuaW1wb3J0IHsgQmxvY2tBcmd1bWVudHNJbXBsLCBFTVBUWV9BUkdTLCBWTUFyZ3VtZW50c0ltcGwgfSBmcm9tICcuLi8uLi92bS9hcmd1bWVudHMnO1xuaW1wb3J0IHtcbiAgQ2hlY2tBcmd1bWVudHMsXG4gIENoZWNrQ29tcG9uZW50RGVmaW5pdGlvbixcbiAgQ2hlY2tDb21wb25lbnRJbnN0YW5jZSxcbiAgQ2hlY2tGaW5pc2hlZENvbXBvbmVudEluc3RhbmNlLFxuICBDaGVja0ludm9jYXRpb24sXG4gIENoZWNrUmVmZXJlbmNlLFxuICBDaGVja0N1cnJpZWRDb21wb25lbnREZWZpbml0aW9uLFxufSBmcm9tICcuLy1kZWJ1Zy1zdHJpcCc7XG5pbXBvcnQgeyBVcGRhdGVEeW5hbWljQXR0cmlidXRlT3Bjb2RlIH0gZnJvbSAnLi9kb20nO1xuaW1wb3J0IHtcbiAgQ3VycmllZFZhbHVlLFxuICBpc0N1cnJpZWRUeXBlLFxuICBpc0N1cnJpZWRWYWx1ZSxcbiAgcmVzb2x2ZUN1cnJpZWRWYWx1ZSxcbn0gZnJvbSAnLi4vLi4vY3VycmllZC12YWx1ZSc7XG5cbi8qKlxuICogVGhlIFZNIGNyZWF0ZXMgYSBuZXcgQ29tcG9uZW50SW5zdGFuY2UgZGF0YSBzdHJ1Y3R1cmUgZm9yIGV2ZXJ5IGNvbXBvbmVudFxuICogaW52b2NhdGlvbiBpdCBlbmNvdW50ZXJzLlxuICpcbiAqIFNpbWlsYXIgdG8gaG93IGEgQ29tcG9uZW50RGVmaW5pdGlvbiBjb250YWlucyBzdGF0ZSBhYm91dCBhbGwgY29tcG9uZW50cyBvZiBhXG4gKiBwYXJ0aWN1bGFyIHR5cGUsIGEgQ29tcG9uZW50SW5zdGFuY2UgY29udGFpbnMgc3RhdGUgc3BlY2lmaWMgdG8gYSBwYXJ0aWN1bGFyXG4gKiBpbnN0YW5jZSBvZiBhIGNvbXBvbmVudCB0eXBlLiBJdCBhbHNvIGNvbnRhaW5zIGEgcG9pbnRlciBiYWNrIHRvIGl0c1xuICogY29tcG9uZW50IHR5cGUncyBDb21wb25lbnREZWZpbml0aW9uLlxuICovXG5cbmV4cG9ydCBpbnRlcmZhY2UgSW5pdGlhbENvbXBvbmVudEluc3RhbmNlIHtcbiAgZGVmaW5pdGlvbjogQ29tcG9uZW50RGVmaW5pdGlvbjtcbiAgbWFuYWdlcjogT3B0aW9uPEludGVybmFsQ29tcG9uZW50TWFuYWdlcj47XG4gIGNhcGFiaWxpdGllczogT3B0aW9uPEludGVybmFsQ29tcG9uZW50Q2FwYWJpbGl0eT47XG4gIHN0YXRlOiBudWxsO1xuICBoYW5kbGU6IE9wdGlvbjxudW1iZXI+O1xuICB0YWJsZTogT3B0aW9uPFByb2dyYW1TeW1ib2xUYWJsZT47XG4gIGxvb2t1cDogT3B0aW9uPERpY3Q8U2NvcGVTbG90Pj47XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUG9wdWxhdGVkQ29tcG9uZW50SW5zdGFuY2Uge1xuICBkZWZpbml0aW9uOiBDb21wb25lbnREZWZpbml0aW9uO1xuICBtYW5hZ2VyOiBJbnRlcm5hbENvbXBvbmVudE1hbmFnZXI7XG4gIGNhcGFiaWxpdGllczogSW50ZXJuYWxDb21wb25lbnRDYXBhYmlsaXR5O1xuICBzdGF0ZTogbnVsbDtcbiAgaGFuZGxlOiBudW1iZXI7XG4gIHRhYmxlOiBPcHRpb248UHJvZ3JhbVN5bWJvbFRhYmxlPjtcbiAgbG9va3VwOiBPcHRpb248RGljdDxTY29wZVNsb3Q+Pjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQYXJ0aWFsQ29tcG9uZW50RGVmaW5pdGlvbiB7XG4gIHN0YXRlOiBPcHRpb248Q29tcG9uZW50RGVmaW5pdGlvblN0YXRlPjtcbiAgbWFuYWdlcjogSW50ZXJuYWxDb21wb25lbnRNYW5hZ2VyO1xufVxuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuUHVzaENvbXBvbmVudERlZmluaXRpb24sICh2bSwgeyBvcDE6IGhhbmRsZSB9KSA9PiB7XG4gIGxldCBkZWZpbml0aW9uID0gdm1bQ09OU1RBTlRTXS5nZXRWYWx1ZTxDb21wb25lbnREZWZpbml0aW9uPihoYW5kbGUpO1xuICBhc3NlcnQoISFkZWZpbml0aW9uLCBgTWlzc2luZyBjb21wb25lbnQgZm9yICR7aGFuZGxlfWApO1xuXG4gIGxldCB7IG1hbmFnZXIsIGNhcGFiaWxpdGllcyB9ID0gZGVmaW5pdGlvbjtcblxuICBsZXQgaW5zdGFuY2U6IEluaXRpYWxDb21wb25lbnRJbnN0YW5jZSA9IHtcbiAgICBkZWZpbml0aW9uLFxuICAgIG1hbmFnZXIsXG4gICAgY2FwYWJpbGl0aWVzLFxuICAgIHN0YXRlOiBudWxsLFxuICAgIGhhbmRsZTogbnVsbCxcbiAgICB0YWJsZTogbnVsbCxcbiAgICBsb29rdXA6IG51bGwsXG4gIH07XG5cbiAgdm0uc3RhY2sucHVzaChpbnN0YW5jZSk7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLlJlc29sdmVEeW5hbWljQ29tcG9uZW50LCAodm0sIHsgb3AxOiBfaXNTdHJpY3QgfSkgPT4ge1xuICBsZXQgc3RhY2sgPSB2bS5zdGFjaztcbiAgbGV0IGNvbXBvbmVudCA9IGNoZWNrKFxuICAgIHZhbHVlRm9yUmVmKGNoZWNrKHN0YWNrLnBvcCgpLCBDaGVja1JlZmVyZW5jZSkpLFxuICAgIENoZWNrT3IoQ2hlY2tTdHJpbmcsIENoZWNrQ3VycmllZENvbXBvbmVudERlZmluaXRpb24pXG4gICk7XG4gIGxldCBjb25zdGFudHMgPSB2bVtDT05TVEFOVFNdO1xuICBsZXQgb3duZXIgPSB2bS5nZXRPd25lcigpO1xuICBsZXQgaXNTdHJpY3QgPSBjb25zdGFudHMuZ2V0VmFsdWU8Ym9vbGVhbj4oX2lzU3RyaWN0KTtcblxuICB2bS5sb2FkVmFsdWUoJHQxLCBudWxsKTsgLy8gQ2xlYXIgdGhlIHRlbXAgcmVnaXN0ZXJcblxuICBsZXQgZGVmaW5pdGlvbjogQ29tcG9uZW50RGVmaW5pdGlvbiB8IEN1cnJpZWRWYWx1ZTtcblxuICBpZiAodHlwZW9mIGNvbXBvbmVudCA9PT0gJ3N0cmluZycpIHtcbiAgICBpZiAoREVCVUcgJiYgaXNTdHJpY3QpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgYEF0dGVtcHRlZCB0byByZXNvbHZlIGEgZHluYW1pYyBjb21wb25lbnQgd2l0aCBhIHN0cmluZyBkZWZpbml0aW9uLCBcXGAke2NvbXBvbmVudH1cXGAgaW4gYSBzdHJpY3QgbW9kZSB0ZW1wbGF0ZS4gSW4gc3RyaWN0IG1vZGUsIHVzaW5nIHN0cmluZ3MgdG8gcmVzb2x2ZSBjb21wb25lbnQgZGVmaW5pdGlvbnMgaXMgcHJvaGliaXRlZC4gWW91IGNhbiBpbnN0ZWFkIGltcG9ydCB0aGUgY29tcG9uZW50IGRlZmluaXRpb24gYW5kIHVzZSBpdCBkaXJlY3RseS5gXG4gICAgICApO1xuICAgIH1cblxuICAgIGxldCByZXNvbHZlZERlZmluaXRpb24gPSByZXNvbHZlQ29tcG9uZW50KHZtLnJ1bnRpbWUucmVzb2x2ZXIsIGNvbnN0YW50cywgY29tcG9uZW50LCBvd25lcik7XG5cbiAgICBkZWZpbml0aW9uID0gZXhwZWN0KHJlc29sdmVkRGVmaW5pdGlvbiwgYENvdWxkIG5vdCBmaW5kIGEgY29tcG9uZW50IG5hbWVkIFwiJHtjb21wb25lbnR9XCJgKTtcbiAgfSBlbHNlIGlmIChpc0N1cnJpZWRWYWx1ZShjb21wb25lbnQpKSB7XG4gICAgZGVmaW5pdGlvbiA9IGNvbXBvbmVudDtcbiAgfSBlbHNlIHtcbiAgICBkZWZpbml0aW9uID0gY29uc3RhbnRzLmNvbXBvbmVudChjb21wb25lbnQsIG93bmVyKTtcbiAgfVxuXG4gIHN0YWNrLnB1c2goZGVmaW5pdGlvbik7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLlJlc29sdmVDdXJyaWVkQ29tcG9uZW50LCAodm0pID0+IHtcbiAgbGV0IHN0YWNrID0gdm0uc3RhY2s7XG4gIGxldCByZWYgPSBjaGVjayhzdGFjay5wb3AoKSwgQ2hlY2tSZWZlcmVuY2UpO1xuICBsZXQgdmFsdWUgPSB2YWx1ZUZvclJlZihyZWYpO1xuICBsZXQgY29uc3RhbnRzID0gdm1bQ09OU1RBTlRTXTtcblxuICBsZXQgZGVmaW5pdGlvbjogQ3VycmllZFZhbHVlIHwgQ29tcG9uZW50RGVmaW5pdGlvbiB8IG51bGw7XG5cbiAgaWYgKERFQlVHICYmICEodHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nIHx8ICh0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICE9PSBudWxsKSkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICBgRXhwZWN0ZWQgYSBjb21wb25lbnQgZGVmaW5pdGlvbiwgYnV0IHJlY2VpdmVkICR7dmFsdWV9LiBZb3UgbWF5IGhhdmUgYWNjaWRlbnRhbGx5IGRvbmUgPCR7cmVmLmRlYnVnTGFiZWx9Piwgd2hlcmUgXCIke3JlZi5kZWJ1Z0xhYmVsfVwiIHdhcyBhIHN0cmluZyBpbnN0ZWFkIG9mIGEgY3VycmllZCBjb21wb25lbnQgZGVmaW5pdGlvbi4gWW91IG11c3QgZWl0aGVyIHVzZSB0aGUgY29tcG9uZW50IGRlZmluaXRpb24gZGlyZWN0bHksIG9yIHVzZSB0aGUge3tjb21wb25lbnR9fSBoZWxwZXIgdG8gY3JlYXRlIGEgY3VycmllZCBjb21wb25lbnQgZGVmaW5pdGlvbiB3aGVuIGludm9raW5nIGR5bmFtaWNhbGx5LmBcbiAgICApO1xuICB9XG5cbiAgaWYgKGlzQ3VycmllZFZhbHVlKHZhbHVlKSkge1xuICAgIGRlZmluaXRpb24gPSB2YWx1ZTtcbiAgfSBlbHNlIHtcbiAgICBkZWZpbml0aW9uID0gY29uc3RhbnRzLmNvbXBvbmVudCh2YWx1ZSBhcyBvYmplY3QsIHZtLmdldE93bmVyKCksIHRydWUpO1xuXG4gICAgaWYgKERFQlVHICYmIGRlZmluaXRpb24gPT09IG51bGwpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgYEV4cGVjdGVkIGEgZHluYW1pYyBjb21wb25lbnQgZGVmaW5pdGlvbiwgYnV0IHJlY2VpdmVkIGFuIG9iamVjdCBvciBmdW5jdGlvbiB0aGF0IGRpZCBub3QgaGF2ZSBhIGNvbXBvbmVudCBtYW5hZ2VyIGFzc29jaWF0ZWQgd2l0aCBpdC4gVGhlIGR5bmFtaWMgaW52b2NhdGlvbiB3YXMgXFxgPCR7XG4gICAgICAgICAgcmVmLmRlYnVnTGFiZWxcbiAgICAgICAgfT5cXGAgb3IgXFxge3ske1xuICAgICAgICAgIHJlZi5kZWJ1Z0xhYmVsXG4gICAgICAgIH19fVxcYCwgYW5kIHRoZSBpbmNvcnJlY3QgZGVmaW5pdGlvbiBpcyB0aGUgdmFsdWUgYXQgdGhlIHBhdGggXFxgJHtcbiAgICAgICAgICByZWYuZGVidWdMYWJlbFxuICAgICAgICB9XFxgLCB3aGljaCB3YXM6ICR7ZGVidWdUb1N0cmluZyEodmFsdWUpfWBcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgc3RhY2sucHVzaChkZWZpbml0aW9uKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuUHVzaER5bmFtaWNDb21wb25lbnRJbnN0YW5jZSwgKHZtKSA9PiB7XG4gIGxldCB7IHN0YWNrIH0gPSB2bTtcbiAgbGV0IGRlZmluaXRpb24gPSBzdGFjay5wb3A8Q29tcG9uZW50RGVmaW5pdGlvbj4oKTtcblxuICBsZXQgY2FwYWJpbGl0aWVzLCBtYW5hZ2VyO1xuXG4gIGlmIChpc0N1cnJpZWRWYWx1ZShkZWZpbml0aW9uKSkge1xuICAgIG1hbmFnZXIgPSBjYXBhYmlsaXRpZXMgPSBudWxsO1xuICB9IGVsc2Uge1xuICAgIG1hbmFnZXIgPSBkZWZpbml0aW9uLm1hbmFnZXI7XG4gICAgY2FwYWJpbGl0aWVzID0gZGVmaW5pdGlvbi5jYXBhYmlsaXRpZXM7XG4gIH1cblxuICBzdGFjay5wdXNoKHsgZGVmaW5pdGlvbiwgY2FwYWJpbGl0aWVzLCBtYW5hZ2VyLCBzdGF0ZTogbnVsbCwgaGFuZGxlOiBudWxsLCB0YWJsZTogbnVsbCB9KTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuUHVzaEFyZ3MsICh2bSwgeyBvcDE6IF9uYW1lcywgb3AyOiBfYmxvY2tOYW1lcywgb3AzOiBmbGFncyB9KSA9PiB7XG4gIGxldCBzdGFjayA9IHZtLnN0YWNrO1xuICBsZXQgbmFtZXMgPSB2bVtDT05TVEFOVFNdLmdldEFycmF5PHN0cmluZz4oX25hbWVzKTtcblxuICBsZXQgcG9zaXRpb25hbENvdW50ID0gZmxhZ3MgPj4gNDtcbiAgbGV0IGF0TmFtZXMgPSBmbGFncyAmIDBiMTAwMDtcbiAgbGV0IGJsb2NrTmFtZXMgPVxuICAgIGZsYWdzICYgMGIwMTExID8gdm1bQ09OU1RBTlRTXS5nZXRBcnJheTxzdHJpbmc+KF9ibG9ja05hbWVzKSA6IEVNUFRZX1NUUklOR19BUlJBWTtcblxuICB2bVtBUkdTXS5zZXR1cChzdGFjaywgbmFtZXMsIGJsb2NrTmFtZXMsIHBvc2l0aW9uYWxDb3VudCwgISFhdE5hbWVzKTtcbiAgc3RhY2sucHVzaCh2bVtBUkdTXSk7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLlB1c2hFbXB0eUFyZ3MsICh2bSkgPT4ge1xuICBsZXQgeyBzdGFjayB9ID0gdm07XG5cbiAgc3RhY2sucHVzaCh2bVtBUkdTXS5lbXB0eShzdGFjaykpO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5DYXB0dXJlQXJncywgKHZtKSA9PiB7XG4gIGxldCBzdGFjayA9IHZtLnN0YWNrO1xuXG4gIGxldCBhcmdzID0gY2hlY2soc3RhY2sucG9wKCksIENoZWNrSW5zdGFuY2VvZihWTUFyZ3VtZW50c0ltcGwpKTtcbiAgbGV0IGNhcHR1cmVkQXJncyA9IGFyZ3MuY2FwdHVyZSgpO1xuICBzdGFjay5wdXNoKGNhcHR1cmVkQXJncyk7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLlByZXBhcmVBcmdzLCAodm0sIHsgb3AxOiBfc3RhdGUgfSkgPT4ge1xuICBsZXQgc3RhY2sgPSB2bS5zdGFjaztcbiAgbGV0IGluc3RhbmNlID0gdm0uZmV0Y2hWYWx1ZTxDb21wb25lbnRJbnN0YW5jZT4oX3N0YXRlKTtcbiAgbGV0IGFyZ3MgPSBjaGVjayhzdGFjay5wb3AoKSwgQ2hlY2tJbnN0YW5jZW9mKFZNQXJndW1lbnRzSW1wbCkpO1xuXG4gIGxldCB7IGRlZmluaXRpb24gfSA9IGluc3RhbmNlO1xuXG4gIGlmIChpc0N1cnJpZWRUeXBlKGRlZmluaXRpb24sIEN1cnJpZWRUeXBlLkNvbXBvbmVudCkpIHtcbiAgICBhc3NlcnQoXG4gICAgICAhZGVmaW5pdGlvbi5tYW5hZ2VyLFxuICAgICAgXCJJZiB0aGUgY29tcG9uZW50IGRlZmluaXRpb24gd2FzIGN1cnJpZWQsIHdlIGRvbid0IHlldCBoYXZlIGEgbWFuYWdlclwiXG4gICAgKTtcblxuICAgIGxldCBjb25zdGFudHMgPSB2bVtDT05TVEFOVFNdO1xuXG4gICAgbGV0IHtcbiAgICAgIGRlZmluaXRpb246IHJlc29sdmVkRGVmaW5pdGlvbixcbiAgICAgIG93bmVyLFxuICAgICAgcmVzb2x2ZWQsXG4gICAgICBwb3NpdGlvbmFsLFxuICAgICAgbmFtZWQsXG4gICAgfSA9IHJlc29sdmVDdXJyaWVkVmFsdWUoZGVmaW5pdGlvbik7XG5cbiAgICBpZiAocmVzb2x2ZWQgPT09IHRydWUpIHtcbiAgICAgIGRlZmluaXRpb24gPSByZXNvbHZlZERlZmluaXRpb24gYXMgQ29tcG9uZW50RGVmaW5pdGlvbjtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiByZXNvbHZlZERlZmluaXRpb24gPT09ICdzdHJpbmcnKSB7XG4gICAgICBsZXQgcmVzb2x2ZWRWYWx1ZSA9IHZtLnJ1bnRpbWUucmVzb2x2ZXIubG9va3VwQ29tcG9uZW50KHJlc29sdmVkRGVmaW5pdGlvbiwgb3duZXIpO1xuXG4gICAgICBkZWZpbml0aW9uID0gY29uc3RhbnRzLnJlc29sdmVkQ29tcG9uZW50KFxuICAgICAgICBleHBlY3QocmVzb2x2ZWRWYWx1ZSwgJ0JVRzogZXhwZWN0ZWQgcmVzb2x2ZWQgY29tcG9uZW50JyksXG4gICAgICAgIHJlc29sdmVkRGVmaW5pdGlvblxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZGVmaW5pdGlvbiA9IGNvbnN0YW50cy5jb21wb25lbnQocmVzb2x2ZWREZWZpbml0aW9uLCBvd25lcik7XG4gICAgfVxuXG4gICAgaWYgKG5hbWVkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGFyZ3MubmFtZWQubWVyZ2UoYXNzaWduKHt9LCAuLi5uYW1lZCkpO1xuICAgIH1cblxuICAgIGlmIChwb3NpdGlvbmFsICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGFyZ3MucmVhbGxvYyhwb3NpdGlvbmFsLmxlbmd0aCk7XG4gICAgICBhcmdzLnBvc2l0aW9uYWwucHJlcGVuZChwb3NpdGlvbmFsKTtcbiAgICB9XG5cbiAgICBsZXQgeyBtYW5hZ2VyIH0gPSBkZWZpbml0aW9uO1xuXG4gICAgYXNzZXJ0KGluc3RhbmNlLm1hbmFnZXIgPT09IG51bGwsICdjb21wb25lbnQgaW5zdGFuY2UgbWFuYWdlciBzaG91bGQgbm90IGJlIHBvcHVsYXRlZCB5ZXQnKTtcbiAgICBhc3NlcnQoXG4gICAgICBpbnN0YW5jZS5jYXBhYmlsaXRpZXMgPT09IG51bGwsXG4gICAgICAnY29tcG9uZW50IGluc3RhbmNlIG1hbmFnZXIgc2hvdWxkIG5vdCBiZSBwb3B1bGF0ZWQgeWV0J1xuICAgICk7XG5cbiAgICBpbnN0YW5jZS5kZWZpbml0aW9uID0gZGVmaW5pdGlvbjtcbiAgICBpbnN0YW5jZS5tYW5hZ2VyID0gbWFuYWdlcjtcbiAgICBpbnN0YW5jZS5jYXBhYmlsaXRpZXMgPSBkZWZpbml0aW9uLmNhcGFiaWxpdGllcztcblxuICAgIC8vIFNhdmUgb2ZmIHRoZSBvd25lciB0aGF0IHRoaXMgY29tcG9uZW50IHdhcyBjdXJyaWVkIHdpdGguIExhdGVyIG9uLFxuICAgIC8vIHdlJ2xsIGZldGNoIHRoZSB2YWx1ZSBvZiB0aGlzIHJlZ2lzdGVyIGFuZCBzZXQgaXQgYXMgdGhlIG93bmVyIG9uIHRoZVxuICAgIC8vIG5ldyByb290IHNjb3BlLlxuICAgIHZtLmxvYWRWYWx1ZSgkdDEsIG93bmVyKTtcbiAgfVxuXG4gIGxldCB7IG1hbmFnZXIsIHN0YXRlIH0gPSBkZWZpbml0aW9uO1xuICBsZXQgY2FwYWJpbGl0aWVzID0gaW5zdGFuY2UuY2FwYWJpbGl0aWVzO1xuXG4gIGlmICghbWFuYWdlckhhc0NhcGFiaWxpdHkobWFuYWdlciwgY2FwYWJpbGl0aWVzLCBJbnRlcm5hbENvbXBvbmVudENhcGFiaWxpdHkuUHJlcGFyZUFyZ3MpKSB7XG4gICAgc3RhY2sucHVzaChhcmdzKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBsZXQgYmxvY2tzID0gYXJncy5ibG9ja3MudmFsdWVzO1xuICBsZXQgYmxvY2tOYW1lcyA9IGFyZ3MuYmxvY2tzLm5hbWVzO1xuICBsZXQgcHJlcGFyZWRBcmdzID0gbWFuYWdlci5wcmVwYXJlQXJncyhzdGF0ZSwgYXJncyk7XG5cbiAgaWYgKHByZXBhcmVkQXJncykge1xuICAgIGFyZ3MuY2xlYXIoKTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYmxvY2tzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBzdGFjay5wdXNoKGJsb2Nrc1tpXSk7XG4gICAgfVxuXG4gICAgbGV0IHsgcG9zaXRpb25hbCwgbmFtZWQgfSA9IHByZXBhcmVkQXJncztcblxuICAgIGxldCBwb3NpdGlvbmFsQ291bnQgPSBwb3NpdGlvbmFsLmxlbmd0aDtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcG9zaXRpb25hbENvdW50OyBpKyspIHtcbiAgICAgIHN0YWNrLnB1c2gocG9zaXRpb25hbFtpXSk7XG4gICAgfVxuXG4gICAgbGV0IG5hbWVzID0gT2JqZWN0LmtleXMobmFtZWQpO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuYW1lcy5sZW5ndGg7IGkrKykge1xuICAgICAgc3RhY2sucHVzaChuYW1lZFtuYW1lc1tpXV0pO1xuICAgIH1cblxuICAgIGFyZ3Muc2V0dXAoc3RhY2ssIG5hbWVzLCBibG9ja05hbWVzLCBwb3NpdGlvbmFsQ291bnQsIGZhbHNlKTtcbiAgfVxuXG4gIHN0YWNrLnB1c2goYXJncyk7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkNyZWF0ZUNvbXBvbmVudCwgKHZtLCB7IG9wMTogZmxhZ3MsIG9wMjogX3N0YXRlIH0pID0+IHtcbiAgbGV0IGluc3RhbmNlID0gY2hlY2sodm0uZmV0Y2hWYWx1ZShfc3RhdGUpLCBDaGVja0NvbXBvbmVudEluc3RhbmNlKTtcbiAgbGV0IHsgZGVmaW5pdGlvbiwgbWFuYWdlciwgY2FwYWJpbGl0aWVzIH0gPSBpbnN0YW5jZTtcblxuICBpZiAoIW1hbmFnZXJIYXNDYXBhYmlsaXR5KG1hbmFnZXIsIGNhcGFiaWxpdGllcywgSW50ZXJuYWxDb21wb25lbnRDYXBhYmlsaXR5LkNyZWF0ZUluc3RhbmNlKSkge1xuICAgIC8vIFRPRE86IENsb3N1cmUgYW5kIE1haW4gY29tcG9uZW50cyBhcmUgYWx3YXlzIGludm9rZWQgZHluYW1pY2FsbHksIHNvIHRoaXNcbiAgICAvLyBvcGNvZGUgbWF5IHJ1biBldmVuIGlmIHRoaXMgY2FwYWJpbGl0eSBpcyBub3QgZW5hYmxlZC4gSW4gdGhlIGZ1dHVyZSB3ZVxuICAgIC8vIHNob3VsZCBoYW5kbGUgdGhpcyBpbiBhIGJldHRlciB3YXkuXG4gICAgcmV0dXJuO1xuICB9XG5cbiAgbGV0IGR5bmFtaWNTY29wZTogT3B0aW9uPER5bmFtaWNTY29wZT4gPSBudWxsO1xuICBpZiAobWFuYWdlckhhc0NhcGFiaWxpdHkobWFuYWdlciwgY2FwYWJpbGl0aWVzLCBJbnRlcm5hbENvbXBvbmVudENhcGFiaWxpdHkuRHluYW1pY1Njb3BlKSkge1xuICAgIGR5bmFtaWNTY29wZSA9IHZtLmR5bmFtaWNTY29wZSgpO1xuICB9XG5cbiAgbGV0IGhhc0RlZmF1bHRCbG9jayA9IGZsYWdzICYgMTtcbiAgbGV0IGFyZ3M6IE9wdGlvbjxWTUFyZ3VtZW50cz4gPSBudWxsO1xuXG4gIGlmIChtYW5hZ2VySGFzQ2FwYWJpbGl0eShtYW5hZ2VyLCBjYXBhYmlsaXRpZXMsIEludGVybmFsQ29tcG9uZW50Q2FwYWJpbGl0eS5DcmVhdGVBcmdzKSkge1xuICAgIGFyZ3MgPSBjaGVjayh2bS5zdGFjay5wZWVrKCksIENoZWNrQXJndW1lbnRzKTtcbiAgfVxuXG4gIGxldCBzZWxmOiBPcHRpb248UmVmZXJlbmNlPiA9IG51bGw7XG4gIGlmIChtYW5hZ2VySGFzQ2FwYWJpbGl0eShtYW5hZ2VyLCBjYXBhYmlsaXRpZXMsIEludGVybmFsQ29tcG9uZW50Q2FwYWJpbGl0eS5DcmVhdGVDYWxsZXIpKSB7XG4gICAgc2VsZiA9IHZtLmdldFNlbGYoKTtcbiAgfVxuXG4gIGxldCBzdGF0ZSA9IG1hbmFnZXIuY3JlYXRlKFxuICAgIHZtLmdldE93bmVyKCksXG4gICAgZGVmaW5pdGlvbi5zdGF0ZSxcbiAgICBhcmdzLFxuICAgIHZtLmVudixcbiAgICBkeW5hbWljU2NvcGUsXG4gICAgc2VsZixcbiAgICAhIWhhc0RlZmF1bHRCbG9ja1xuICApO1xuXG4gIC8vIFdlIHdhbnQgdG8gcmV1c2UgdGhlIGBzdGF0ZWAgUE9KTyBoZXJlLCBiZWNhdXNlIHdlIGtub3cgdGhhdCB0aGUgb3Bjb2Rlc1xuICAvLyBvbmx5IHRyYW5zaXRpb24gYXQgZXhhY3RseSBvbmUgcGxhY2UuXG4gIGluc3RhbmNlLnN0YXRlID0gc3RhdGU7XG5cbiAgaWYgKG1hbmFnZXJIYXNDYXBhYmlsaXR5KG1hbmFnZXIsIGNhcGFiaWxpdGllcywgSW50ZXJuYWxDb21wb25lbnRDYXBhYmlsaXR5LlVwZGF0ZUhvb2spKSB7XG4gICAgdm0udXBkYXRlV2l0aChuZXcgVXBkYXRlQ29tcG9uZW50T3Bjb2RlKHN0YXRlLCBtYW5hZ2VyLCBkeW5hbWljU2NvcGUpKTtcbiAgfVxufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5SZWdpc3RlckNvbXBvbmVudERlc3RydWN0b3IsICh2bSwgeyBvcDE6IF9zdGF0ZSB9KSA9PiB7XG4gIGxldCB7IG1hbmFnZXIsIHN0YXRlLCBjYXBhYmlsaXRpZXMgfSA9IGNoZWNrKHZtLmZldGNoVmFsdWUoX3N0YXRlKSwgQ2hlY2tDb21wb25lbnRJbnN0YW5jZSk7XG5cbiAgbGV0IGQgPSBtYW5hZ2VyLmdldERlc3Ryb3lhYmxlKHN0YXRlKTtcblxuICBpZiAoXG4gICAgREVCVUcgJiZcbiAgICAhbWFuYWdlckhhc0NhcGFiaWxpdHkobWFuYWdlciwgY2FwYWJpbGl0aWVzLCBJbnRlcm5hbENvbXBvbmVudENhcGFiaWxpdHkuV2lsbERlc3Ryb3kpICYmXG4gICAgZCAhPT0gbnVsbCAmJlxuICAgIHR5cGVvZiAnd2lsbERlc3Ryb3knIGluIGRcbiAgKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgJ0JVRzogRGVzdHJ1Y3RvciBoYXMgd2lsbERlc3Ryb3ksIGJ1dCB0aGUgd2lsbERlc3Ryb3kgY2FwYWJpbGl0eSB3YXMgbm90IGVuYWJsZWQgZm9yIHRoaXMgY29tcG9uZW50LiBQcmUtZGVzdHJ1Y3Rpb24gaG9va3MgbXVzdCBiZSBleHBsaWNpdGx5IG9wdGVkIGludG8nXG4gICAgKTtcbiAgfVxuXG4gIGlmIChkKSB2bS5hc3NvY2lhdGVEZXN0cm95YWJsZShkKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuQmVnaW5Db21wb25lbnRUcmFuc2FjdGlvbiwgKHZtLCB7IG9wMTogX3N0YXRlIH0pID0+IHtcbiAgbGV0IG5hbWU7XG5cbiAgaWYgKERFQlVHKSB7XG4gICAgbGV0IHsgZGVmaW5pdGlvbiwgbWFuYWdlciB9ID0gY2hlY2sodm0uZmV0Y2hWYWx1ZShfc3RhdGUpLCBDaGVja0NvbXBvbmVudEluc3RhbmNlKTtcblxuICAgIG5hbWUgPSBkZWZpbml0aW9uLnJlc29sdmVkTmFtZSA/PyBtYW5hZ2VyLmdldERlYnVnTmFtZShkZWZpbml0aW9uLnN0YXRlKTtcbiAgfVxuXG4gIHZtLmJlZ2luQ2FjaGVHcm91cChuYW1lKTtcbiAgdm0uZWxlbWVudHMoKS5wdXNoU2ltcGxlQmxvY2soKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuUHV0Q29tcG9uZW50T3BlcmF0aW9ucywgKHZtKSA9PiB7XG4gIHZtLmxvYWRWYWx1ZSgkdDAsIG5ldyBDb21wb25lbnRFbGVtZW50T3BlcmF0aW9ucygpKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuQ29tcG9uZW50QXR0ciwgKHZtLCB7IG9wMTogX25hbWUsIG9wMjogX3RydXN0aW5nLCBvcDM6IF9uYW1lc3BhY2UgfSkgPT4ge1xuICBsZXQgbmFtZSA9IHZtW0NPTlNUQU5UU10uZ2V0VmFsdWU8c3RyaW5nPihfbmFtZSk7XG4gIGxldCB0cnVzdGluZyA9IHZtW0NPTlNUQU5UU10uZ2V0VmFsdWU8Ym9vbGVhbj4oX3RydXN0aW5nKTtcbiAgbGV0IHJlZmVyZW5jZSA9IGNoZWNrKHZtLnN0YWNrLnBvcCgpLCBDaGVja1JlZmVyZW5jZSk7XG4gIGxldCBuYW1lc3BhY2UgPSBfbmFtZXNwYWNlID8gdm1bQ09OU1RBTlRTXS5nZXRWYWx1ZTxzdHJpbmc+KF9uYW1lc3BhY2UpIDogbnVsbDtcblxuICBjaGVjayh2bS5mZXRjaFZhbHVlKCR0MCksIENoZWNrSW5zdGFuY2VvZihDb21wb25lbnRFbGVtZW50T3BlcmF0aW9ucykpLnNldEF0dHJpYnV0ZShcbiAgICBuYW1lLFxuICAgIHJlZmVyZW5jZSxcbiAgICB0cnVzdGluZyxcbiAgICBuYW1lc3BhY2VcbiAgKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuU3RhdGljQ29tcG9uZW50QXR0ciwgKHZtLCB7IG9wMTogX25hbWUsIG9wMjogX3ZhbHVlLCBvcDM6IF9uYW1lc3BhY2UgfSkgPT4ge1xuICBsZXQgbmFtZSA9IHZtW0NPTlNUQU5UU10uZ2V0VmFsdWU8c3RyaW5nPihfbmFtZSk7XG4gIGxldCB2YWx1ZSA9IHZtW0NPTlNUQU5UU10uZ2V0VmFsdWU8c3RyaW5nPihfdmFsdWUpO1xuICBsZXQgbmFtZXNwYWNlID0gX25hbWVzcGFjZSA/IHZtW0NPTlNUQU5UU10uZ2V0VmFsdWU8c3RyaW5nPihfbmFtZXNwYWNlKSA6IG51bGw7XG5cbiAgY2hlY2sodm0uZmV0Y2hWYWx1ZSgkdDApLCBDaGVja0luc3RhbmNlb2YoQ29tcG9uZW50RWxlbWVudE9wZXJhdGlvbnMpKS5zZXRTdGF0aWNBdHRyaWJ1dGUoXG4gICAgbmFtZSxcbiAgICB2YWx1ZSxcbiAgICBuYW1lc3BhY2VcbiAgKTtcbn0pO1xuXG50eXBlIERlZmVycmVkQXR0cmlidXRlID0ge1xuICB2YWx1ZTogc3RyaW5nIHwgUmVmZXJlbmNlPHVua25vd24+O1xuICBuYW1lc3BhY2U6IE9wdGlvbjxzdHJpbmc+O1xuICB0cnVzdGluZz86IGJvb2xlYW47XG59O1xuXG5leHBvcnQgY2xhc3MgQ29tcG9uZW50RWxlbWVudE9wZXJhdGlvbnMgaW1wbGVtZW50cyBFbGVtZW50T3BlcmF0aW9ucyB7XG4gIHByaXZhdGUgYXR0cmlidXRlcyA9IGRpY3Q8RGVmZXJyZWRBdHRyaWJ1dGU+KCk7XG4gIHByaXZhdGUgY2xhc3NlczogKHN0cmluZyB8IFJlZmVyZW5jZTx1bmtub3duPilbXSA9IFtdO1xuICBwcml2YXRlIG1vZGlmaWVyczogTW9kaWZpZXJJbnN0YW5jZVtdID0gW107XG5cbiAgc2V0QXR0cmlidXRlKFxuICAgIG5hbWU6IHN0cmluZyxcbiAgICB2YWx1ZTogUmVmZXJlbmNlPHVua25vd24+LFxuICAgIHRydXN0aW5nOiBib29sZWFuLFxuICAgIG5hbWVzcGFjZTogT3B0aW9uPHN0cmluZz5cbiAgKSB7XG4gICAgbGV0IGRlZmVycmVkID0geyB2YWx1ZSwgbmFtZXNwYWNlLCB0cnVzdGluZyB9O1xuXG4gICAgaWYgKG5hbWUgPT09ICdjbGFzcycpIHtcbiAgICAgIHRoaXMuY2xhc3Nlcy5wdXNoKHZhbHVlKTtcbiAgICB9XG5cbiAgICB0aGlzLmF0dHJpYnV0ZXNbbmFtZV0gPSBkZWZlcnJlZDtcbiAgfVxuXG4gIHNldFN0YXRpY0F0dHJpYnV0ZShuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcsIG5hbWVzcGFjZTogT3B0aW9uPHN0cmluZz4pOiB2b2lkIHtcbiAgICBsZXQgZGVmZXJyZWQgPSB7IHZhbHVlLCBuYW1lc3BhY2UgfTtcblxuICAgIGlmIChuYW1lID09PSAnY2xhc3MnKSB7XG4gICAgICB0aGlzLmNsYXNzZXMucHVzaCh2YWx1ZSk7XG4gICAgfVxuXG4gICAgdGhpcy5hdHRyaWJ1dGVzW25hbWVdID0gZGVmZXJyZWQ7XG4gIH1cblxuICBhZGRNb2RpZmllcihtb2RpZmllcjogTW9kaWZpZXJJbnN0YW5jZSk6IHZvaWQge1xuICAgIHRoaXMubW9kaWZpZXJzLnB1c2gobW9kaWZpZXIpO1xuICB9XG5cbiAgZmx1c2godm06IEludGVybmFsVk0pOiBNb2RpZmllckluc3RhbmNlW10ge1xuICAgIGxldCB0eXBlOiBEZWZlcnJlZEF0dHJpYnV0ZSB8IHVuZGVmaW5lZDtcbiAgICBsZXQgYXR0cmlidXRlcyA9IHRoaXMuYXR0cmlidXRlcztcblxuICAgIGZvciAobGV0IG5hbWUgaW4gdGhpcy5hdHRyaWJ1dGVzKSB7XG4gICAgICBpZiAobmFtZSA9PT0gJ3R5cGUnKSB7XG4gICAgICAgIHR5cGUgPSBhdHRyaWJ1dGVzW25hbWVdO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgbGV0IGF0dHIgPSB0aGlzLmF0dHJpYnV0ZXNbbmFtZV07XG4gICAgICBpZiAobmFtZSA9PT0gJ2NsYXNzJykge1xuICAgICAgICBzZXREZWZlcnJlZEF0dHIodm0sICdjbGFzcycsIG1lcmdlQ2xhc3Nlcyh0aGlzLmNsYXNzZXMpLCBhdHRyLm5hbWVzcGFjZSwgYXR0ci50cnVzdGluZyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzZXREZWZlcnJlZEF0dHIodm0sIG5hbWUsIGF0dHIudmFsdWUsIGF0dHIubmFtZXNwYWNlLCBhdHRyLnRydXN0aW5nKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodHlwZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBzZXREZWZlcnJlZEF0dHIodm0sICd0eXBlJywgdHlwZS52YWx1ZSwgdHlwZS5uYW1lc3BhY2UsIHR5cGUudHJ1c3RpbmcpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLm1vZGlmaWVycztcbiAgfVxufVxuXG5mdW5jdGlvbiBtZXJnZUNsYXNzZXMoY2xhc3NlczogKHN0cmluZyB8IFJlZmVyZW5jZSlbXSk6IHN0cmluZyB8IFJlZmVyZW5jZTx1bmtub3duPiB7XG4gIGlmIChjbGFzc2VzLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiAnJztcbiAgfVxuICBpZiAoY2xhc3Nlcy5sZW5ndGggPT09IDEpIHtcbiAgICByZXR1cm4gY2xhc3Nlc1swXTtcbiAgfVxuICBpZiAoYWxsU3RyaW5nQ2xhc3NlcyhjbGFzc2VzKSkge1xuICAgIHJldHVybiBjbGFzc2VzLmpvaW4oJyAnKTtcbiAgfVxuXG4gIHJldHVybiBjcmVhdGVDbGFzc0xpc3RSZWYoY2xhc3NlcyBhcyBSZWZlcmVuY2VbXSk7XG59XG5cbmZ1bmN0aW9uIGFsbFN0cmluZ0NsYXNzZXMoY2xhc3NlczogKHN0cmluZyB8IFJlZmVyZW5jZTx1bmtub3duPilbXSk6IGNsYXNzZXMgaXMgc3RyaW5nW10ge1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGNsYXNzZXMubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAodHlwZW9mIGNsYXNzZXNbaV0gIT09ICdzdHJpbmcnKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG4gIHJldHVybiB0cnVlO1xufVxuXG5mdW5jdGlvbiBzZXREZWZlcnJlZEF0dHIoXG4gIHZtOiBJbnRlcm5hbFZNLFxuICBuYW1lOiBzdHJpbmcsXG4gIHZhbHVlOiBzdHJpbmcgfCBSZWZlcmVuY2U8dW5rbm93bj4sXG4gIG5hbWVzcGFjZTogT3B0aW9uPHN0cmluZz4sXG4gIHRydXN0aW5nID0gZmFsc2Vcbikge1xuICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xuICAgIHZtLmVsZW1lbnRzKCkuc2V0U3RhdGljQXR0cmlidXRlKG5hbWUsIHZhbHVlLCBuYW1lc3BhY2UpO1xuICB9IGVsc2Uge1xuICAgIGxldCBhdHRyaWJ1dGUgPSB2bVxuICAgICAgLmVsZW1lbnRzKClcbiAgICAgIC5zZXREeW5hbWljQXR0cmlidXRlKG5hbWUsIHZhbHVlRm9yUmVmKHZhbHVlKSwgdHJ1c3RpbmcsIG5hbWVzcGFjZSk7XG4gICAgaWYgKCFpc0NvbnN0UmVmKHZhbHVlKSkge1xuICAgICAgdm0udXBkYXRlV2l0aChuZXcgVXBkYXRlRHluYW1pY0F0dHJpYnV0ZU9wY29kZSh2YWx1ZSwgYXR0cmlidXRlLCB2bS5lbnYpKTtcbiAgICB9XG4gIH1cbn1cblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkRpZENyZWF0ZUVsZW1lbnQsICh2bSwgeyBvcDE6IF9zdGF0ZSB9KSA9PiB7XG4gIGxldCB7IGRlZmluaXRpb24sIHN0YXRlIH0gPSBjaGVjayh2bS5mZXRjaFZhbHVlKF9zdGF0ZSksIENoZWNrQ29tcG9uZW50SW5zdGFuY2UpO1xuICBsZXQgeyBtYW5hZ2VyIH0gPSBkZWZpbml0aW9uO1xuXG4gIGxldCBvcGVyYXRpb25zID0gY2hlY2sodm0uZmV0Y2hWYWx1ZSgkdDApLCBDaGVja0luc3RhbmNlb2YoQ29tcG9uZW50RWxlbWVudE9wZXJhdGlvbnMpKTtcblxuICAobWFuYWdlciBhcyBXaXRoRWxlbWVudEhvb2s8dW5rbm93bj4pLmRpZENyZWF0ZUVsZW1lbnQoXG4gICAgc3RhdGUsXG4gICAgZXhwZWN0KHZtLmVsZW1lbnRzKCkuY29uc3RydWN0aW5nLCBgRXhwZWN0ZWQgYSBjb25zdHJ1Y3RpbmcgZWxlbWVudCBpbiBEaWRDcmVhdGVPcGNvZGVgKSxcbiAgICBvcGVyYXRpb25zXG4gICk7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkdldENvbXBvbmVudFNlbGYsICh2bSwgeyBvcDE6IF9zdGF0ZSwgb3AyOiBfbmFtZXMgfSkgPT4ge1xuICBsZXQgaW5zdGFuY2UgPSBjaGVjayh2bS5mZXRjaFZhbHVlKF9zdGF0ZSksIENoZWNrQ29tcG9uZW50SW5zdGFuY2UpO1xuICBsZXQgeyBkZWZpbml0aW9uLCBzdGF0ZSB9ID0gaW5zdGFuY2U7XG4gIGxldCB7IG1hbmFnZXIgfSA9IGRlZmluaXRpb247XG4gIGxldCBzZWxmUmVmID0gbWFuYWdlci5nZXRTZWxmKHN0YXRlKTtcblxuICBpZiAodm0uZW52LmRlYnVnUmVuZGVyVHJlZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgbGV0IGluc3RhbmNlID0gY2hlY2sodm0uZmV0Y2hWYWx1ZShfc3RhdGUpLCBDaGVja0NvbXBvbmVudEluc3RhbmNlKTtcbiAgICBsZXQgeyBkZWZpbml0aW9uLCBtYW5hZ2VyIH0gPSBpbnN0YW5jZTtcblxuICAgIGxldCBhcmdzOiBDYXB0dXJlZEFyZ3VtZW50cztcblxuICAgIGlmICh2bS5zdGFjay5wZWVrKCkgPT09IHZtW0FSR1NdKSB7XG4gICAgICBhcmdzID0gdm1bQVJHU10uY2FwdHVyZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBsZXQgbmFtZXMgPSB2bVtDT05TVEFOVFNdLmdldEFycmF5PHN0cmluZz4oX25hbWVzKTtcbiAgICAgIHZtW0FSR1NdLnNldHVwKHZtLnN0YWNrLCBuYW1lcywgW10sIDAsIHRydWUpO1xuICAgICAgYXJncyA9IHZtW0FSR1NdLmNhcHR1cmUoKTtcbiAgICB9XG5cbiAgICBsZXQgbW9kdWxlTmFtZTogc3RyaW5nO1xuICAgIGxldCBjb21waWxhYmxlOiBDb21waWxhYmxlUHJvZ3JhbSB8IG51bGwgPSBkZWZpbml0aW9uLmNvbXBpbGFibGU7XG5cbiAgICBpZiAoY29tcGlsYWJsZSA9PT0gbnVsbCkge1xuICAgICAgYXNzZXJ0KFxuICAgICAgICBtYW5hZ2VySGFzQ2FwYWJpbGl0eShcbiAgICAgICAgICBtYW5hZ2VyLFxuICAgICAgICAgIGluc3RhbmNlLmNhcGFiaWxpdGllcyxcbiAgICAgICAgICBJbnRlcm5hbENvbXBvbmVudENhcGFiaWxpdHkuRHluYW1pY0xheW91dFxuICAgICAgICApLFxuICAgICAgICAnQlVHOiBObyB0ZW1wbGF0ZSB3YXMgZm91bmQgZm9yIHRoaXMgY29tcG9uZW50LCBhbmQgdGhlIGNvbXBvbmVudCBkaWQgbm90IGhhdmUgdGhlIGR5bmFtaWMgbGF5b3V0IGNhcGFiaWxpdHknXG4gICAgICApO1xuXG4gICAgICBjb21waWxhYmxlID0gbWFuYWdlci5nZXREeW5hbWljTGF5b3V0KHN0YXRlLCB2bS5ydW50aW1lLnJlc29sdmVyKTtcblxuICAgICAgaWYgKGNvbXBpbGFibGUgIT09IG51bGwpIHtcbiAgICAgICAgbW9kdWxlTmFtZSA9IGNvbXBpbGFibGUubW9kdWxlTmFtZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1vZHVsZU5hbWUgPSAnX19kZWZhdWx0X18uaGJzJztcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgbW9kdWxlTmFtZSA9IGNvbXBpbGFibGUubW9kdWxlTmFtZTtcbiAgICB9XG5cbiAgICAvLyBGb3IgdGVhcmluZyBkb3duIHRoZSBkZWJ1Z1JlbmRlclRyZWVcbiAgICB2bS5hc3NvY2lhdGVEZXN0cm95YWJsZShpbnN0YW5jZSk7XG5cbiAgICBpZiAoaGFzQ3VzdG9tRGVidWdSZW5kZXJUcmVlTGlmZWN5Y2xlKG1hbmFnZXIpKSB7XG4gICAgICBsZXQgbm9kZXMgPSBtYW5hZ2VyLmdldERlYnVnQ3VzdG9tUmVuZGVyVHJlZShcbiAgICAgICAgaW5zdGFuY2UuZGVmaW5pdGlvbi5zdGF0ZSxcbiAgICAgICAgaW5zdGFuY2Uuc3RhdGUsXG4gICAgICAgIGFyZ3MsXG4gICAgICAgIG1vZHVsZU5hbWVcbiAgICAgICk7XG5cbiAgICAgIG5vZGVzLmZvckVhY2goKG5vZGUpID0+IHtcbiAgICAgICAgbGV0IHsgYnVja2V0IH0gPSBub2RlO1xuICAgICAgICB2bS5lbnYuZGVidWdSZW5kZXJUcmVlIS5jcmVhdGUoYnVja2V0LCBub2RlKTtcblxuICAgICAgICByZWdpc3RlckRlc3RydWN0b3IoaW5zdGFuY2UsICgpID0+IHtcbiAgICAgICAgICB2bS5lbnYuZGVidWdSZW5kZXJUcmVlPy53aWxsRGVzdHJveShidWNrZXQpO1xuICAgICAgICB9KTtcblxuICAgICAgICB2bS51cGRhdGVXaXRoKG5ldyBEZWJ1Z1JlbmRlclRyZWVVcGRhdGVPcGNvZGUoYnVja2V0KSk7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgbGV0IG5hbWUgPSBkZWZpbml0aW9uLnJlc29sdmVkTmFtZSA/PyBtYW5hZ2VyLmdldERlYnVnTmFtZShkZWZpbml0aW9uLnN0YXRlKTtcblxuICAgICAgdm0uZW52LmRlYnVnUmVuZGVyVHJlZS5jcmVhdGUoaW5zdGFuY2UsIHtcbiAgICAgICAgdHlwZTogJ2NvbXBvbmVudCcsXG4gICAgICAgIG5hbWUsXG4gICAgICAgIGFyZ3MsXG4gICAgICAgIHRlbXBsYXRlOiBtb2R1bGVOYW1lLFxuICAgICAgICBpbnN0YW5jZTogdmFsdWVGb3JSZWYoc2VsZlJlZiksXG4gICAgICB9KTtcblxuICAgICAgdm0uYXNzb2NpYXRlRGVzdHJveWFibGUoaW5zdGFuY2UpO1xuXG4gICAgICByZWdpc3RlckRlc3RydWN0b3IoaW5zdGFuY2UsICgpID0+IHtcbiAgICAgICAgdm0uZW52LmRlYnVnUmVuZGVyVHJlZT8ud2lsbERlc3Ryb3koaW5zdGFuY2UpO1xuICAgICAgfSk7XG5cbiAgICAgIHZtLnVwZGF0ZVdpdGgobmV3IERlYnVnUmVuZGVyVHJlZVVwZGF0ZU9wY29kZShpbnN0YW5jZSkpO1xuICAgIH1cbiAgfVxuXG4gIHZtLnN0YWNrLnB1c2goc2VsZlJlZik7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkdldENvbXBvbmVudFRhZ05hbWUsICh2bSwgeyBvcDE6IF9zdGF0ZSB9KSA9PiB7XG4gIGxldCB7IGRlZmluaXRpb24sIHN0YXRlIH0gPSBjaGVjayh2bS5mZXRjaFZhbHVlKF9zdGF0ZSksIENoZWNrQ29tcG9uZW50SW5zdGFuY2UpO1xuICBsZXQgeyBtYW5hZ2VyIH0gPSBkZWZpbml0aW9uO1xuXG4gIGxldCB0YWdOYW1lID0gKG1hbmFnZXIgYXMgUmVjYXN0PFxuICAgIEludGVybmFsQ29tcG9uZW50TWFuYWdlcixcbiAgICBXaXRoRHluYW1pY1RhZ05hbWU8dW5rbm93bj5cbiAgPikuZ2V0VGFnTmFtZShzdGF0ZSk7XG5cbiAgLy8gVXNlciBwcm92aWRlZCB2YWx1ZSBmcm9tIEpTLCBzbyB3ZSBkb24ndCBib3RoZXIgdG8gZW5jb2RlXG4gIHZtLnN0YWNrLnB1c2godGFnTmFtZSk7XG59KTtcblxuLy8gRHluYW1pYyBJbnZvY2F0aW9uIE9ubHlcbkFQUEVORF9PUENPREVTLmFkZChPcC5HZXRDb21wb25lbnRMYXlvdXQsICh2bSwgeyBvcDE6IF9zdGF0ZSB9KSA9PiB7XG4gIGxldCBpbnN0YW5jZSA9IGNoZWNrKHZtLmZldGNoVmFsdWUoX3N0YXRlKSwgQ2hlY2tDb21wb25lbnRJbnN0YW5jZSk7XG5cbiAgbGV0IHsgbWFuYWdlciwgZGVmaW5pdGlvbiB9ID0gaW5zdGFuY2U7XG4gIGxldCB7IHN0YWNrIH0gPSB2bTtcblxuICBsZXQgeyBjb21waWxhYmxlIH0gPSBkZWZpbml0aW9uO1xuXG4gIGlmIChjb21waWxhYmxlID09PSBudWxsKSB7XG4gICAgbGV0IHsgY2FwYWJpbGl0aWVzIH0gPSBpbnN0YW5jZTtcblxuICAgIGFzc2VydChcbiAgICAgIG1hbmFnZXJIYXNDYXBhYmlsaXR5KG1hbmFnZXIsIGNhcGFiaWxpdGllcywgSW50ZXJuYWxDb21wb25lbnRDYXBhYmlsaXR5LkR5bmFtaWNMYXlvdXQpLFxuICAgICAgJ0JVRzogTm8gdGVtcGxhdGUgd2FzIGZvdW5kIGZvciB0aGlzIGNvbXBvbmVudCwgYW5kIHRoZSBjb21wb25lbnQgZGlkIG5vdCBoYXZlIHRoZSBkeW5hbWljIGxheW91dCBjYXBhYmlsaXR5J1xuICAgICk7XG5cbiAgICBjb21waWxhYmxlID0gbWFuYWdlci5nZXREeW5hbWljTGF5b3V0KGluc3RhbmNlLnN0YXRlLCB2bS5ydW50aW1lLnJlc29sdmVyKTtcblxuICAgIGlmIChjb21waWxhYmxlID09PSBudWxsKSB7XG4gICAgICBpZiAobWFuYWdlckhhc0NhcGFiaWxpdHkobWFuYWdlciwgY2FwYWJpbGl0aWVzLCBJbnRlcm5hbENvbXBvbmVudENhcGFiaWxpdHkuV3JhcHBlZCkpIHtcbiAgICAgICAgY29tcGlsYWJsZSA9IHVud3JhcFRlbXBsYXRlKHZtW0NPTlNUQU5UU10uZGVmYXVsdFRlbXBsYXRlKS5hc1dyYXBwZWRMYXlvdXQoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbXBpbGFibGUgPSB1bndyYXBUZW1wbGF0ZSh2bVtDT05TVEFOVFNdLmRlZmF1bHRUZW1wbGF0ZSkuYXNMYXlvdXQoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBsZXQgaGFuZGxlID0gY29tcGlsYWJsZS5jb21waWxlKHZtLmNvbnRleHQpO1xuXG4gIHN0YWNrLnB1c2goY29tcGlsYWJsZS5zeW1ib2xUYWJsZSk7XG4gIHN0YWNrLnB1c2goaGFuZGxlKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuTWFpbiwgKHZtLCB7IG9wMTogcmVnaXN0ZXIgfSkgPT4ge1xuICBsZXQgZGVmaW5pdGlvbiA9IGNoZWNrKHZtLnN0YWNrLnBvcCgpLCBDaGVja0NvbXBvbmVudERlZmluaXRpb24pO1xuICBsZXQgaW52b2NhdGlvbiA9IGNoZWNrKHZtLnN0YWNrLnBvcCgpLCBDaGVja0ludm9jYXRpb24pO1xuXG4gIGxldCB7IG1hbmFnZXIsIGNhcGFiaWxpdGllcyB9ID0gZGVmaW5pdGlvbjtcblxuICBsZXQgc3RhdGU6IFBvcHVsYXRlZENvbXBvbmVudEluc3RhbmNlID0ge1xuICAgIGRlZmluaXRpb24sXG4gICAgbWFuYWdlcixcbiAgICBjYXBhYmlsaXRpZXMsXG4gICAgc3RhdGU6IG51bGwsXG4gICAgaGFuZGxlOiBpbnZvY2F0aW9uLmhhbmRsZSxcbiAgICB0YWJsZTogaW52b2NhdGlvbi5zeW1ib2xUYWJsZSxcbiAgICBsb29rdXA6IG51bGwsXG4gIH07XG5cbiAgdm0ubG9hZFZhbHVlKHJlZ2lzdGVyLCBzdGF0ZSk7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLlBvcHVsYXRlTGF5b3V0LCAodm0sIHsgb3AxOiBfc3RhdGUgfSkgPT4ge1xuICBsZXQgeyBzdGFjayB9ID0gdm07XG5cbiAgLy8gSW4gREVCVUcgaGFuZGxlcyBjb3VsZCBiZSBFcnJIYW5kbGUgb2JqZWN0c1xuICBsZXQgaGFuZGxlID0gY2hlY2soc3RhY2sucG9wKCksIENoZWNrSGFuZGxlKTtcbiAgbGV0IHRhYmxlID0gY2hlY2soc3RhY2sucG9wKCksIENoZWNrUHJvZ3JhbVN5bWJvbFRhYmxlKTtcblxuICBsZXQgc3RhdGUgPSBjaGVjayh2bS5mZXRjaFZhbHVlKF9zdGF0ZSksIENoZWNrQ29tcG9uZW50SW5zdGFuY2UpO1xuXG4gIHN0YXRlLmhhbmRsZSA9IGhhbmRsZTtcbiAgc3RhdGUudGFibGUgPSB0YWJsZTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuVmlydHVhbFJvb3RTY29wZSwgKHZtLCB7IG9wMTogX3N0YXRlIH0pID0+IHtcbiAgbGV0IHsgdGFibGUsIG1hbmFnZXIsIGNhcGFiaWxpdGllcywgc3RhdGUgfSA9IGNoZWNrKFxuICAgIHZtLmZldGNoVmFsdWUoX3N0YXRlKSxcbiAgICBDaGVja0ZpbmlzaGVkQ29tcG9uZW50SW5zdGFuY2VcbiAgKTtcblxuICBsZXQgb3duZXI7XG5cbiAgaWYgKG1hbmFnZXJIYXNDYXBhYmlsaXR5KG1hbmFnZXIsIGNhcGFiaWxpdGllcywgSW50ZXJuYWxDb21wb25lbnRDYXBhYmlsaXR5Lkhhc1N1Yk93bmVyKSkge1xuICAgIG93bmVyID0gbWFuYWdlci5nZXRPd25lcihzdGF0ZSk7XG4gICAgdm0ubG9hZFZhbHVlKCR0MSwgbnVsbCk7IC8vIENsZWFyIHRoZSB0ZW1wIHJlZ2lzdGVyXG4gIH0gZWxzZSB7XG4gICAgLy8gQ2hlY2sgdGhlIHRlbXAgcmVnaXN0ZXIgdG8gc2VlIGlmIGFuIG93bmVyIHdhcyByZXNvbHZlZCBmcm9tIGN1cnJ5aW5nXG4gICAgb3duZXIgPSB2bS5mZXRjaFZhbHVlPE93bmVyIHwgbnVsbD4oJHQxKTtcblxuICAgIGlmIChvd25lciA9PT0gbnVsbCkge1xuICAgICAgLy8gSWYgYW4gb3duZXIgd2Fzbid0IGZvdW5kLCBkZWZhdWx0IHRvIHVzaW5nIHRoZSBjdXJyZW50IG93bmVyLiBUaGlzXG4gICAgICAvLyB3aWxsIGhhcHBlbiBmb3Igbm9ybWFsIGR5bmFtaWMgY29tcG9uZW50IGludm9jYXRpb24sXG4gICAgICAvLyBlLmcuIDxTb21lQ2xhc3NpY0VtYmVyQ29tcG9uZW50Lz5cbiAgICAgIG93bmVyID0gdm0uZ2V0T3duZXIoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gRWxzZSB0aGUgb3duZXIgd2FzIGZvdW5kLCBzbyBjbGVhciB0aGUgdGVtcCByZWdpc3Rlci4gVGhpcyB3aWxsIGhhcHBlblxuICAgICAgLy8gaWYgd2UgYXJlIGxvYWRpbmcgYSBjdXJyaWVkIGNvbXBvbmVudCwgZS5nLiA8QHNvbWVDdXJyaWVkQ29tcG9uZW50Lz5cbiAgICAgIHZtLmxvYWRWYWx1ZSgkdDEsIG51bGwpO1xuICAgIH1cbiAgfVxuXG4gIHZtLnB1c2hSb290U2NvcGUodGFibGUuc3ltYm9scy5sZW5ndGggKyAxLCBvd25lcik7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLlNldHVwRm9yRXZhbCwgKHZtLCB7IG9wMTogX3N0YXRlIH0pID0+IHtcbiAgbGV0IHN0YXRlID0gY2hlY2sodm0uZmV0Y2hWYWx1ZShfc3RhdGUpLCBDaGVja0ZpbmlzaGVkQ29tcG9uZW50SW5zdGFuY2UpO1xuXG4gIGlmIChzdGF0ZS50YWJsZS5oYXNFdmFsKSB7XG4gICAgbGV0IGxvb2t1cCA9IChzdGF0ZS5sb29rdXAgPSBkaWN0PFNjb3BlU2xvdD4oKSk7XG4gICAgdm0uc2NvcGUoKS5iaW5kRXZhbFNjb3BlKGxvb2t1cCk7XG4gIH1cbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuU2V0TmFtZWRWYXJpYWJsZXMsICh2bSwgeyBvcDE6IF9zdGF0ZSB9KSA9PiB7XG4gIGxldCBzdGF0ZSA9IGNoZWNrKHZtLmZldGNoVmFsdWUoX3N0YXRlKSwgQ2hlY2tGaW5pc2hlZENvbXBvbmVudEluc3RhbmNlKTtcbiAgbGV0IHNjb3BlID0gdm0uc2NvcGUoKTtcblxuICBsZXQgYXJncyA9IGNoZWNrKHZtLnN0YWNrLnBlZWsoKSwgQ2hlY2tBcmd1bWVudHMpO1xuICBsZXQgY2FsbGVyTmFtZXMgPSBhcmdzLm5hbWVkLmF0TmFtZXM7XG5cbiAgZm9yIChsZXQgaSA9IGNhbGxlck5hbWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgbGV0IGF0TmFtZSA9IGNhbGxlck5hbWVzW2ldO1xuICAgIGxldCBzeW1ib2wgPSBzdGF0ZS50YWJsZS5zeW1ib2xzLmluZGV4T2YoY2FsbGVyTmFtZXNbaV0pO1xuICAgIGxldCB2YWx1ZSA9IGFyZ3MubmFtZWQuZ2V0KGF0TmFtZSwgdHJ1ZSk7XG5cbiAgICBpZiAoc3ltYm9sICE9PSAtMSkgc2NvcGUuYmluZFN5bWJvbChzeW1ib2wgKyAxLCB2YWx1ZSk7XG4gICAgaWYgKHN0YXRlLmxvb2t1cCkgc3RhdGUubG9va3VwW2F0TmFtZV0gPSB2YWx1ZTtcbiAgfVxufSk7XG5cbmZ1bmN0aW9uIGJpbmRCbG9jayhcbiAgc3ltYm9sTmFtZTogc3RyaW5nLFxuICBibG9ja05hbWU6IHN0cmluZyxcbiAgc3RhdGU6IENvbXBvbmVudEluc3RhbmNlLFxuICBibG9ja3M6IEJsb2NrQXJndW1lbnRzSW1wbCxcbiAgdm06IEludGVybmFsVk1cbikge1xuICBsZXQgc3ltYm9sID0gc3RhdGUudGFibGUuc3ltYm9scy5pbmRleE9mKHN5bWJvbE5hbWUpO1xuICBsZXQgYmxvY2sgPSBibG9ja3MuZ2V0KGJsb2NrTmFtZSk7XG5cbiAgaWYgKHN5bWJvbCAhPT0gLTEpIHZtLnNjb3BlKCkuYmluZEJsb2NrKHN5bWJvbCArIDEsIGJsb2NrKTtcbiAgaWYgKHN0YXRlLmxvb2t1cCkgc3RhdGUubG9va3VwW3N5bWJvbE5hbWVdID0gYmxvY2s7XG59XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5TZXRCbG9ja3MsICh2bSwgeyBvcDE6IF9zdGF0ZSB9KSA9PiB7XG4gIGxldCBzdGF0ZSA9IGNoZWNrKHZtLmZldGNoVmFsdWUoX3N0YXRlKSwgQ2hlY2tGaW5pc2hlZENvbXBvbmVudEluc3RhbmNlKTtcbiAgbGV0IHsgYmxvY2tzIH0gPSBjaGVjayh2bS5zdGFjay5wZWVrKCksIENoZWNrQXJndW1lbnRzKTtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IGJsb2Nrcy5uYW1lcy5sZW5ndGg7IGkrKykge1xuICAgIGJpbmRCbG9jayhibG9ja3Muc3ltYm9sTmFtZXNbaV0sIGJsb2Nrcy5uYW1lc1tpXSwgc3RhdGUsIGJsb2Nrcywgdm0pO1xuICB9XG59KTtcblxuLy8gRHluYW1pYyBJbnZvY2F0aW9uIE9ubHlcbkFQUEVORF9PUENPREVTLmFkZChPcC5JbnZva2VDb21wb25lbnRMYXlvdXQsICh2bSwgeyBvcDE6IF9zdGF0ZSB9KSA9PiB7XG4gIGxldCBzdGF0ZSA9IGNoZWNrKHZtLmZldGNoVmFsdWUoX3N0YXRlKSwgQ2hlY2tGaW5pc2hlZENvbXBvbmVudEluc3RhbmNlKTtcblxuICB2bS5jYWxsKHN0YXRlLmhhbmRsZSEpO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5EaWRSZW5kZXJMYXlvdXQsICh2bSwgeyBvcDE6IF9zdGF0ZSB9KSA9PiB7XG4gIGxldCBpbnN0YW5jZSA9IGNoZWNrKHZtLmZldGNoVmFsdWUoX3N0YXRlKSwgQ2hlY2tDb21wb25lbnRJbnN0YW5jZSk7XG4gIGxldCB7IG1hbmFnZXIsIHN0YXRlLCBjYXBhYmlsaXRpZXMgfSA9IGluc3RhbmNlO1xuICBsZXQgYm91bmRzID0gdm0uZWxlbWVudHMoKS5wb3BCbG9jaygpO1xuXG4gIGlmICh2bS5lbnYuZGVidWdSZW5kZXJUcmVlICE9PSB1bmRlZmluZWQpIHtcbiAgICBpZiAoaGFzQ3VzdG9tRGVidWdSZW5kZXJUcmVlTGlmZWN5Y2xlKG1hbmFnZXIpKSB7XG4gICAgICBsZXQgbm9kZXMgPSBtYW5hZ2VyLmdldERlYnVnQ3VzdG9tUmVuZGVyVHJlZShpbnN0YW5jZS5kZWZpbml0aW9uLnN0YXRlLCBzdGF0ZSwgRU1QVFlfQVJHUyk7XG5cbiAgICAgIG5vZGVzLnJldmVyc2UoKS5mb3JFYWNoKChub2RlKSA9PiB7XG4gICAgICAgIGxldCB7IGJ1Y2tldCB9ID0gbm9kZTtcblxuICAgICAgICB2bS5lbnYuZGVidWdSZW5kZXJUcmVlIS5kaWRSZW5kZXIoYnVja2V0LCBib3VuZHMpO1xuXG4gICAgICAgIHZtLnVwZGF0ZVdpdGgobmV3IERlYnVnUmVuZGVyVHJlZURpZFJlbmRlck9wY29kZShidWNrZXQsIGJvdW5kcykpO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZtLmVudi5kZWJ1Z1JlbmRlclRyZWUuZGlkUmVuZGVyKGluc3RhbmNlLCBib3VuZHMpO1xuXG4gICAgICB2bS51cGRhdGVXaXRoKG5ldyBEZWJ1Z1JlbmRlclRyZWVEaWRSZW5kZXJPcGNvZGUoaW5zdGFuY2UsIGJvdW5kcykpO1xuICAgIH1cbiAgfVxuXG4gIGlmIChtYW5hZ2VySGFzQ2FwYWJpbGl0eShtYW5hZ2VyLCBjYXBhYmlsaXRpZXMsIEludGVybmFsQ29tcG9uZW50Q2FwYWJpbGl0eS5DcmVhdGVJbnN0YW5jZSkpIHtcbiAgICBsZXQgbWdyID0gY2hlY2sobWFuYWdlciwgQ2hlY2tJbnRlcmZhY2UoeyBkaWRSZW5kZXJMYXlvdXQ6IENoZWNrRnVuY3Rpb24gfSkpO1xuICAgIG1nci5kaWRSZW5kZXJMYXlvdXQoc3RhdGUsIGJvdW5kcyk7XG5cbiAgICB2bS5lbnYuZGlkQ3JlYXRlKGluc3RhbmNlIGFzIENvbXBvbmVudEluc3RhbmNlV2l0aENyZWF0ZSk7XG4gICAgdm0udXBkYXRlV2l0aChuZXcgRGlkVXBkYXRlTGF5b3V0T3Bjb2RlKGluc3RhbmNlIGFzIENvbXBvbmVudEluc3RhbmNlV2l0aENyZWF0ZSwgYm91bmRzKSk7XG4gIH1cbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuQ29tbWl0Q29tcG9uZW50VHJhbnNhY3Rpb24sICh2bSkgPT4ge1xuICB2bS5jb21taXRDYWNoZUdyb3VwKCk7XG59KTtcblxuZXhwb3J0IGNsYXNzIFVwZGF0ZUNvbXBvbmVudE9wY29kZSBpbXBsZW1lbnRzIFVwZGF0aW5nT3Bjb2RlIHtcbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSBjb21wb25lbnQ6IENvbXBvbmVudEluc3RhbmNlU3RhdGUsXG4gICAgcHJpdmF0ZSBtYW5hZ2VyOiBXaXRoVXBkYXRlSG9vayxcbiAgICBwcml2YXRlIGR5bmFtaWNTY29wZTogT3B0aW9uPER5bmFtaWNTY29wZT5cbiAgKSB7fVxuXG4gIGV2YWx1YXRlKF92bTogVXBkYXRpbmdWTSkge1xuICAgIGxldCB7IGNvbXBvbmVudCwgbWFuYWdlciwgZHluYW1pY1Njb3BlIH0gPSB0aGlzO1xuXG4gICAgbWFuYWdlci51cGRhdGUoY29tcG9uZW50LCBkeW5hbWljU2NvcGUpO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBEaWRVcGRhdGVMYXlvdXRPcGNvZGUgaW1wbGVtZW50cyBVcGRhdGluZ09wY29kZSB7XG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgY29tcG9uZW50OiBDb21wb25lbnRJbnN0YW5jZVdpdGhDcmVhdGUsIHByaXZhdGUgYm91bmRzOiBCb3VuZHMpIHt9XG5cbiAgZXZhbHVhdGUodm06IFVwZGF0aW5nVk0pIHtcbiAgICBsZXQgeyBjb21wb25lbnQsIGJvdW5kcyB9ID0gdGhpcztcbiAgICBsZXQgeyBtYW5hZ2VyLCBzdGF0ZSB9ID0gY29tcG9uZW50O1xuXG4gICAgbWFuYWdlci5kaWRVcGRhdGVMYXlvdXQoc3RhdGUsIGJvdW5kcyk7XG5cbiAgICB2bS5lbnYuZGlkVXBkYXRlKGNvbXBvbmVudCk7XG4gIH1cbn1cblxuY2xhc3MgRGVidWdSZW5kZXJUcmVlVXBkYXRlT3Bjb2RlIGltcGxlbWVudHMgVXBkYXRpbmdPcGNvZGUge1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGJ1Y2tldDogb2JqZWN0KSB7fVxuXG4gIGV2YWx1YXRlKHZtOiBVcGRhdGluZ1ZNKSB7XG4gICAgdm0uZW52LmRlYnVnUmVuZGVyVHJlZT8udXBkYXRlKHRoaXMuYnVja2V0KTtcbiAgfVxufVxuXG5jbGFzcyBEZWJ1Z1JlbmRlclRyZWVEaWRSZW5kZXJPcGNvZGUgaW1wbGVtZW50cyBVcGRhdGluZ09wY29kZSB7XG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgYnVja2V0OiBvYmplY3QsIHByaXZhdGUgYm91bmRzOiBCb3VuZHMpIHt9XG5cbiAgZXZhbHVhdGUodm06IFVwZGF0aW5nVk0pIHtcbiAgICB2bS5lbnYuZGVidWdSZW5kZXJUcmVlPy5kaWRSZW5kZXIodGhpcy5idWNrZXQsIHRoaXMuYm91bmRzKTtcbiAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==