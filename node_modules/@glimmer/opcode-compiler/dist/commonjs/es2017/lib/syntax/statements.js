"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.inflateTagName = inflateTagName;
exports.inflateAttrName = inflateAttrName;
exports.STATEMENTS = void 0;

var _vm = require("@glimmer/vm");

var _blocks = require("../opcode-builder/helpers/blocks");

var _components = require("../opcode-builder/helpers/components");

var _conditional = require("../opcode-builder/helpers/conditional");

var _expr = require("../opcode-builder/helpers/expr");

var _shared = require("../opcode-builder/helpers/shared");

var _vm2 = require("../opcode-builder/helpers/vm");

var _operands = require("../opcode-builder/operands");

var _compilers = require("./compilers");

var _resolution = require("../opcode-builder/helpers/resolution");

var _utils = require("../utils");

const STATEMENTS = new _compilers.Compilers();
exports.STATEMENTS = STATEMENTS;
const INFLATE_ATTR_TABLE = ['class', 'id', 'value', 'name', 'type', 'style', 'href'];
const INFLATE_TAG_TABLE = ['div', 'span', 'p', 'a'];

function inflateTagName(tagName) {
  return typeof tagName === 'string' ? tagName : INFLATE_TAG_TABLE[tagName];
}

function inflateAttrName(attrName) {
  return typeof attrName === 'string' ? attrName : INFLATE_ATTR_TABLE[attrName];
}

STATEMENTS.add(3
/* Comment */
, (op, sexp) => op(42
/* Comment */
, sexp[1]));
STATEMENTS.add(13
/* CloseElement */
, op => op(55
/* CloseElement */
));
STATEMENTS.add(12
/* FlushElement */
, op => op(54
/* FlushElement */
));
STATEMENTS.add(4
/* Modifier */
, (op, [, expression, positional, named]) => {
  if ((0, _resolution.isGetFreeModifier)(expression)) {
    op(1003
    /* ResolveModifier */
    , expression, handle => {
      op(0
      /* PushFrame */
      );
      (0, _shared.SimpleArgs)(op, positional, named, false);
      op(57
      /* Modifier */
      , handle);
      op(1
      /* PopFrame */
      );
    });
  } else {
    (0, _expr.expr)(op, expression);
    op(0
    /* PushFrame */
    );
    (0, _shared.SimpleArgs)(op, positional, named, false);
    op(33
    /* Dup */
    , _vm.$fp, 1);
    op(108
    /* DynamicModifier */
    );
    op(1
    /* PopFrame */
    );
  }
});
STATEMENTS.add(14
/* StaticAttr */
, (op, [, name, value, namespace]) => {
  op(51
  /* StaticAttr */
  , inflateAttrName(name), value, namespace !== null && namespace !== void 0 ? namespace : null);
});
STATEMENTS.add(24
/* StaticComponentAttr */
, (op, [, name, value, namespace]) => {
  op(105
  /* StaticComponentAttr */
  , inflateAttrName(name), value, namespace !== null && namespace !== void 0 ? namespace : null);
});
STATEMENTS.add(15
/* DynamicAttr */
, (op, [, name, value, namespace]) => {
  (0, _expr.expr)(op, value);
  op(52
  /* DynamicAttr */
  , inflateAttrName(name), false, namespace !== null && namespace !== void 0 ? namespace : null);
});
STATEMENTS.add(22
/* TrustingDynamicAttr */
, (op, [, name, value, namespace]) => {
  (0, _expr.expr)(op, value);
  op(52
  /* DynamicAttr */
  , inflateAttrName(name), true, namespace !== null && namespace !== void 0 ? namespace : null);
});
STATEMENTS.add(16
/* ComponentAttr */
, (op, [, name, value, namespace]) => {
  (0, _expr.expr)(op, value);
  op(53
  /* ComponentAttr */
  , inflateAttrName(name), false, namespace !== null && namespace !== void 0 ? namespace : null);
});
STATEMENTS.add(23
/* TrustingComponentAttr */
, (op, [, name, value, namespace]) => {
  (0, _expr.expr)(op, value);
  op(53
  /* ComponentAttr */
  , inflateAttrName(name), true, namespace !== null && namespace !== void 0 ? namespace : null);
});
STATEMENTS.add(10
/* OpenElement */
, (op, [, tag]) => {
  op(48
  /* OpenElement */
  , inflateTagName(tag));
});
STATEMENTS.add(11
/* OpenElementWithSplat */
, (op, [, tag]) => {
  op(89
  /* PutComponentOperations */
  );
  op(48
  /* OpenElement */
  , inflateTagName(tag));
});
STATEMENTS.add(8
/* Component */
, (op, [, expr, elementBlock, named, blocks]) => {
  if ((0, _resolution.isGetFreeComponent)(expr)) {
    op(1004
    /* ResolveComponent */
    , expr, component => {
      (0, _components.InvokeComponent)(op, component, elementBlock, null, named, blocks);
    });
  } else {
    // otherwise, the component name was an expression, so resolve the expression
    // and invoke it as a dynamic component
    (0, _components.InvokeDynamicComponent)(op, expr, elementBlock, null, named, blocks, true, true);
  }
});
STATEMENTS.add(18
/* Yield */
, (op, [, to, params]) => (0, _blocks.YieldBlock)(op, to, params));
STATEMENTS.add(17
/* AttrSplat */
, (op, [, to]) => (0, _blocks.YieldBlock)(op, to, null));
STATEMENTS.add(26
/* Debugger */
, (op, [, evalInfo]) => op(103
/* Debugger */
, (0, _operands.evalSymbolsOperand)(), evalInfo));
STATEMENTS.add(1
/* Append */
, (op, [, value]) => {
  // Special case for static values
  if (!Array.isArray(value)) {
    op(41
    /* Text */
    , value === null || value === undefined ? '' : String(value));
  } else if ((0, _resolution.isGetFreeOptionalComponentOrHelper)(value)) {
    op(1008
    /* ResolveOptionalComponentOrHelper */
    , value, {
      ifComponent(component) {
        (0, _components.InvokeComponent)(op, component, null, null, null, null);
      },

      ifHelper(handle) {
        op(0
        /* PushFrame */
        );
        (0, _vm2.Call)(op, handle, null, null);
        op(3
        /* InvokeStatic */
        , (0, _operands.stdlibOperand)('cautious-non-dynamic-append'));
        op(1
        /* PopFrame */
        );
      },

      ifValue(handle) {
        op(0
        /* PushFrame */
        );
        op(29
        /* ConstantReference */
        , handle);
        op(3
        /* InvokeStatic */
        , (0, _operands.stdlibOperand)('cautious-non-dynamic-append'));
        op(1
        /* PopFrame */
        );
      }

    });
  } else if (value[0] === 28
  /* Call */
  ) {
      let [, expression, positional, named] = value;

      if ((0, _resolution.isGetFreeComponentOrHelper)(expression)) {
        op(1007
        /* ResolveComponentOrHelper */
        , expression, {
          ifComponent(component) {
            (0, _components.InvokeComponent)(op, component, null, positional, hashToArgs(named), null);
          },

          ifHelper(handle) {
            op(0
            /* PushFrame */
            );
            (0, _vm2.Call)(op, handle, positional, named);
            op(3
            /* InvokeStatic */
            , (0, _operands.stdlibOperand)('cautious-non-dynamic-append'));
            op(1
            /* PopFrame */
            );
          }

        });
      } else {
        (0, _conditional.SwitchCases)(op, () => {
          (0, _expr.expr)(op, expression);
          op(106
          /* DynamicContentType */
          );
        }, when => {
          when(0
          /* Component */
          , () => {
            op(81
            /* ResolveCurriedComponent */
            );
            op(79
            /* PushDynamicComponentInstance */
            );
            (0, _components.InvokeNonStaticComponent)(op, {
              capabilities: true,
              elementBlock: null,
              positional,
              named,
              atNames: false,
              blocks: (0, _utils.namedBlocks)(null)
            });
          });
          when(1
          /* Helper */
          , () => {
            (0, _vm2.CallDynamic)(op, positional, named, () => {
              op(3
              /* InvokeStatic */
              , (0, _operands.stdlibOperand)('cautious-non-dynamic-append'));
            });
          });
        });
      }
    } else {
    op(0
    /* PushFrame */
    );
    (0, _expr.expr)(op, value);
    op(3
    /* InvokeStatic */
    , (0, _operands.stdlibOperand)('cautious-append'));
    op(1
    /* PopFrame */
    );
  }
});
STATEMENTS.add(2
/* TrustingAppend */
, (op, [, value]) => {
  if (!Array.isArray(value)) {
    op(41
    /* Text */
    , value === null || value === undefined ? '' : String(value));
  } else {
    op(0
    /* PushFrame */
    );
    (0, _expr.expr)(op, value);
    op(3
    /* InvokeStatic */
    , (0, _operands.stdlibOperand)('trusting-append'));
    op(1
    /* PopFrame */
    );
  }
});
STATEMENTS.add(6
/* Block */
, (op, [, expr, positional, named, blocks]) => {
  if ((0, _resolution.isGetFreeComponent)(expr)) {
    op(1004
    /* ResolveComponent */
    , expr, component => {
      (0, _components.InvokeComponent)(op, component, null, positional, hashToArgs(named), blocks);
    });
  } else {
    (0, _components.InvokeDynamicComponent)(op, expr, null, positional, named, blocks, false, false);
  }
});
STATEMENTS.add(40
/* InElement */
, (op, [, block, guid, destination, insertBefore]) => {
  (0, _conditional.ReplayableIf)(op, () => {
    (0, _expr.expr)(op, guid);

    if (insertBefore === undefined) {
      (0, _vm2.PushPrimitiveReference)(op, undefined);
    } else {
      (0, _expr.expr)(op, insertBefore);
    }

    (0, _expr.expr)(op, destination);
    op(33
    /* Dup */
    , _vm.$sp, 0);
    return 4;
  }, () => {
    op(50
    /* PushRemoteElement */
    );
    (0, _blocks.InvokeStaticBlock)(op, block);
    op(56
    /* PopRemoteElement */
    );
  });
});
STATEMENTS.add(41
/* If */
, (op, [, condition, block, inverse]) => (0, _conditional.ReplayableIf)(op, () => {
  (0, _expr.expr)(op, condition);
  op(71
  /* ToBoolean */
  );
  return 1;
}, () => {
  (0, _blocks.InvokeStaticBlock)(op, block);
}, inverse ? () => {
  (0, _blocks.InvokeStaticBlock)(op, inverse);
} : undefined));
STATEMENTS.add(42
/* Each */
, (op, [, value, key, block, inverse]) => (0, _conditional.Replayable)(op, () => {
  if (key) {
    (0, _expr.expr)(op, key);
  } else {
    (0, _vm2.PushPrimitiveReference)(op, null);
  }

  (0, _expr.expr)(op, value);
  return 2;
}, () => {
  op(72
  /* EnterList */
  , (0, _operands.labelOperand)('BODY'), (0, _operands.labelOperand)('ELSE'));
  op(0
  /* PushFrame */
  );
  op(33
  /* Dup */
  , _vm.$fp, 1);
  op(6
  /* ReturnTo */
  , (0, _operands.labelOperand)('ITER'));
  op(1000
  /* Label */
  , 'ITER');
  op(74
  /* Iterate */
  , (0, _operands.labelOperand)('BREAK'));
  op(1000
  /* Label */
  , 'BODY');
  (0, _blocks.InvokeStaticBlockWithStack)(op, block, 2);
  op(34
  /* Pop */
  , 2);
  op(4
  /* Jump */
  , (0, _operands.labelOperand)('FINALLY'));
  op(1000
  /* Label */
  , 'BREAK');
  op(1
  /* PopFrame */
  );
  op(73
  /* ExitList */
  );
  op(4
  /* Jump */
  , (0, _operands.labelOperand)('FINALLY'));
  op(1000
  /* Label */
  , 'ELSE');

  if (inverse) {
    (0, _blocks.InvokeStaticBlock)(op, inverse);
  }
}));
STATEMENTS.add(43
/* With */
, (op, [, value, block, inverse]) => {
  (0, _conditional.ReplayableIf)(op, () => {
    (0, _expr.expr)(op, value);
    op(33
    /* Dup */
    , _vm.$sp, 0);
    op(71
    /* ToBoolean */
    );
    return 2;
  }, () => {
    (0, _blocks.InvokeStaticBlockWithStack)(op, block, 1);
  }, () => {
    if (inverse) {
      (0, _blocks.InvokeStaticBlock)(op, inverse);
    }
  });
});
STATEMENTS.add(44
/* Let */
, (op, [, positional, block]) => {
  let count = (0, _shared.CompilePositional)(op, positional);
  (0, _blocks.InvokeStaticBlockWithStack)(op, block, count);
});
STATEMENTS.add(45
/* WithDynamicVars */
, (op, [, named, block]) => {
  if (named) {
    let [names, expressions] = named;
    (0, _shared.CompilePositional)(op, expressions);
    (0, _vm2.DynamicScope)(op, names, () => {
      (0, _blocks.InvokeStaticBlock)(op, block);
    });
  } else {
    (0, _blocks.InvokeStaticBlock)(op, block);
  }
});
STATEMENTS.add(46
/* InvokeComponent */
, (op, [, expr, positional, named, blocks]) => {
  if ((0, _resolution.isGetFreeComponent)(expr)) {
    op(1004
    /* ResolveComponent */
    , expr, component => {
      (0, _components.InvokeComponent)(op, component, null, positional, hashToArgs(named), blocks);
    });
  } else {
    (0, _components.InvokeDynamicComponent)(op, expr, null, positional, named, blocks, false, false);
  }
});

function hashToArgs(hash) {
  if (hash === null) return null;
  let names = hash[0].map(key => `@${key}`);
  return [names, hash[1]];
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL29wY29kZS1jb21waWxlci9saWIvc3ludGF4L3N0YXRlbWVudHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBYUE7O0FBQ0E7O0FBS0E7O0FBS0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBTUE7O0FBQ0E7O0FBQ0E7O0FBTUE7O0FBRU8sTUFBTSxVQUFVLEdBQUcsSUFBbkIsb0JBQW1CLEVBQW5COztBQUVQLE1BQU0sa0JBQWtCLEdBRXBCLENBQUEsT0FBQSxFQUFBLElBQUEsRUFBQSxPQUFBLEVBQUEsTUFBQSxFQUFBLE1BQUEsRUFBQSxPQUFBLEVBRkosTUFFSSxDQUZKO0FBR0EsTUFBTSxpQkFBaUIsR0FFbkIsQ0FBQSxLQUFBLEVBQUEsTUFBQSxFQUFBLEdBQUEsRUFGSixHQUVJLENBRko7O0FBSU0sU0FBQSxjQUFBLENBQUEsT0FBQSxFQUEyRDtBQUMvRCxTQUFPLE9BQUEsT0FBQSxLQUFBLFFBQUEsR0FBQSxPQUFBLEdBQXdDLGlCQUFpQixDQUFoRSxPQUFnRSxDQUFoRTtBQUNEOztBQUVLLFNBQUEsZUFBQSxDQUFBLFFBQUEsRUFBOEQ7QUFDbEUsU0FBTyxPQUFBLFFBQUEsS0FBQSxRQUFBLEdBQUEsUUFBQSxHQUEwQyxrQkFBa0IsQ0FBbkUsUUFBbUUsQ0FBbkU7QUFDRDs7QUFFRCxVQUFVLENBQVYsR0FBQSxDQUFjO0FBQUE7QUFBZCxFQUFvQyxDQUFBLEVBQUEsRUFBQSxJQUFBLEtBQWMsRUFBRSxDQUFBO0FBQUE7QUFBQSxFQUFhLElBQUksQ0FBckUsQ0FBcUUsQ0FBakIsQ0FBcEQ7QUFDQSxVQUFVLENBQVYsR0FBQSxDQUFjO0FBQUE7QUFBZCxFQUEwQyxFQUFELElBQVEsRUFBRSxDQUFBO0FBQUE7QUFBQSxDQUFuRDtBQUNBLFVBQVUsQ0FBVixHQUFBLENBQWM7QUFBQTtBQUFkLEVBQTBDLEVBQUQsSUFBUSxFQUFFLENBQUE7QUFBQTtBQUFBLENBQW5EO0FB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RUFBWSxDQUFaO0FBQ0EsU0FBTyxDQUFBLEtBQUEsRUFBaUMsSUFBSSxDQUE1QyxDQUE0QyxDQUFyQyxDQUFQO0FBQ0QiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBDb21waWxlVGltZUNvbXBvbmVudCxcbiAgQ29udGVudFR5cGUsXG4gIEhpZ2hMZXZlbEJ1aWxkZXJPcGNvZGUsXG4gIEhpZ2hMZXZlbFJlc29sdXRpb25PcGNvZGUsXG4gIE1hY2hpbmVPcCxcbiAgT3AsXG4gIFNleHBPcGNvZGVzLFxuICBTdGF0ZW1lbnRTZXhwT3Bjb2RlLFxuICBXZWxsS25vd25BdHRyTmFtZSxcbiAgV2VsbEtub3duVGFnTmFtZSxcbiAgV2lyZUZvcm1hdCxcbn0gZnJvbSAnQGdsaW1tZXIvaW50ZXJmYWNlcyc7XG5pbXBvcnQgeyAkZnAsICRzcCB9IGZyb20gJ0BnbGltbWVyL3ZtJztcbmltcG9ydCB7XG4gIEludm9rZVN0YXRpY0Jsb2NrLFxuICBJbnZva2VTdGF0aWNCbG9ja1dpdGhTdGFjayxcbiAgWWllbGRCbG9jayxcbn0gZnJvbSAnLi4vb3Bjb2RlLWJ1aWxkZXIvaGVscGVycy9ibG9ja3MnO1xuaW1wb3J0IHtcbiAgSW52b2tlQ29tcG9uZW50LFxuICBJbnZva2VEeW5hbWljQ29tcG9uZW50LFxuICBJbnZva2VOb25TdGF0aWNDb21wb25lbnQsXG59IGZyb20gJy4uL29wY29kZS1idWlsZGVyL2hlbHBlcnMvY29tcG9uZW50cyc7XG5pbXBvcnQgeyBTd2l0Y2hDYXNlcywgUmVwbGF5YWJsZSwgUmVwbGF5YWJsZUlmIH0gZnJvbSAnLi4vb3Bjb2RlLWJ1aWxkZXIvaGVscGVycy9jb25kaXRpb25hbCc7XG5pbXBvcnQgeyBleHByIH0gZnJvbSAnLi4vb3Bjb2RlLWJ1aWxkZXIvaGVscGVycy9leHByJztcbmltcG9ydCB7IENvbXBpbGVQb3NpdGlvbmFsLCBTaW1wbGVBcmdzIH0gZnJvbSAnLi4vb3Bjb2RlLWJ1aWxkZXIvaGVscGVycy9zaGFyZWQnO1xuaW1wb3J0IHtcbiAgQ2FsbCxcbiAgQ2FsbER5bmFtaWMsXG4gIER5bmFtaWNTY29wZSxcbiAgUHVzaFByaW1pdGl2ZVJlZmVyZW5jZSxcbn0gZnJvbSAnLi4vb3Bjb2RlLWJ1aWxkZXIvaGVscGVycy92bSc7XG5pbXBvcnQgeyBldmFsU3ltYm9sc09wZXJhbmQsIGxhYmVsT3BlcmFuZCwgc3RkbGliT3BlcmFuZCB9IGZyb20gJy4uL29wY29kZS1idWlsZGVyL29wZXJhbmRzJztcbmltcG9ydCB7IENvbXBpbGVycywgUHVzaFN0YXRlbWVudE9wIH0gZnJvbSAnLi9jb21waWxlcnMnO1xuaW1wb3J0IHtcbiAgaXNHZXRGcmVlQ29tcG9uZW50LFxuICBpc0dldEZyZWVDb21wb25lbnRPckhlbHBlcixcbiAgaXNHZXRGcmVlTW9kaWZpZXIsXG4gIGlzR2V0RnJlZU9wdGlvbmFsQ29tcG9uZW50T3JIZWxwZXIsXG59IGZyb20gJy4uL29wY29kZS1idWlsZGVyL2hlbHBlcnMvcmVzb2x1dGlvbic7XG5pbXBvcnQgeyBuYW1lZEJsb2NrcyB9IGZyb20gJy4uL3V0aWxzJztcblxuZXhwb3J0IGNvbnN0IFNUQVRFTUVOVFMgPSBuZXcgQ29tcGlsZXJzPFB1c2hTdGF0ZW1lbnRPcCwgU3RhdGVtZW50U2V4cE9wY29kZT4oKTtcblxuY29uc3QgSU5GTEFURV9BVFRSX1RBQkxFOiB7XG4gIFtJIGluIFdlbGxLbm93bkF0dHJOYW1lXTogc3RyaW5nO1xufSA9IFsnY2xhc3MnLCAnaWQnLCAndmFsdWUnLCAnbmFtZScsICd0eXBlJywgJ3N0eWxlJywgJ2hyZWYnXTtcbmNvbnN0IElORkxBVEVfVEFHX1RBQkxFOiB7XG4gIFtJIGluIFdlbGxLbm93blRhZ05hbWVdOiBzdHJpbmc7XG59ID0gWydkaXYnLCAnc3BhbicsICdwJywgJ2EnXTtcblxuZXhwb3J0IGZ1bmN0aW9uIGluZmxhdGVUYWdOYW1lKHRhZ05hbWU6IHN0cmluZyB8IFdlbGxLbm93blRhZ05hbWUpOiBzdHJpbmcge1xuICByZXR1cm4gdHlwZW9mIHRhZ05hbWUgPT09ICdzdHJpbmcnID8gdGFnTmFtZSA6IElORkxBVEVfVEFHX1RBQkxFW3RhZ05hbWVdO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaW5mbGF0ZUF0dHJOYW1lKGF0dHJOYW1lOiBzdHJpbmcgfCBXZWxsS25vd25BdHRyTmFtZSk6IHN0cmluZyB7XG4gIHJldHVybiB0eXBlb2YgYXR0ck5hbWUgPT09ICdzdHJpbmcnID8gYXR0ck5hbWUgOiBJTkZMQVRFX0FUVFJfVEFCTEVbYXR0ck5hbWVdO1xufVxuXG5TVEFURU1FTlRTLmFkZChTZXhwT3Bjb2Rlcy5Db21tZW50LCAob3AsIHNleHApID0+IG9wKE9wLkNvbW1lbnQsIHNleHBbMV0pKTtcblNUQVRFTUVOVFMuYWRkKFNleHBPcGNvZGVzLkNsb3NlRWxlbWVudCwgKG9wKSA9PiBvcChPcC5DbG9zZUVsZW1lbnQpKTtcblNUQVRFTUVOVFMuYWRkKFNleHBPcGNvZGVzLkZsdXNoRWxlbWVudCwgKG9wKSA9PiBvcChPcC5GbHVzaEVsZW1lbnQpKTtcblxuU1RBVEVNRU5UUy5hZGQoU2V4cE9wY29kZXMuTW9kaWZpZXIsIChvcCwgWywgZXhwcmVzc2lvbiwgcG9zaXRpb25hbCwgbmFtZWRdKSA9PiB7XG4gIGlmIChpc0dldEZyZWVNb2RpZmllcihleHByZXNzaW9uKSkge1xuICAgIG9wKEhpZ2hMZXZlbFJlc29sdXRpb25PcGNvZGUuUmVzb2x2ZU1vZGlmaWVyLCBleHByZXNzaW9uLCAoaGFuZGxlOiBudW1iZXIpID0+IHtcbiAgICAgIG9wKE1hY2hpbmVPcC5QdXNoRnJhbWUpO1xuICAgICAgU2ltcGxlQXJncyhvcCwgcG9zaXRpb25hbCwgbmFtZWQsIGZhbHNlKTtcbiAgICAgIG9wKE9wLk1vZGlmaWVyLCBoYW5kbGUpO1xuICAgICAgb3AoTWFjaGluZU9wLlBvcEZyYW1lKTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBleHByKG9wLCBleHByZXNzaW9uKTtcbiAgICBvcChNYWNoaW5lT3AuUHVzaEZyYW1lKTtcbiAgICBTaW1wbGVBcmdzKG9wLCBwb3NpdGlvbmFsLCBuYW1lZCwgZmFsc2UpO1xuICAgIG9wKE9wLkR1cCwgJGZwLCAxKTtcbiAgICBvcChPcC5EeW5hbWljTW9kaWZpZXIpO1xuICAgIG9wKE1hY2hpbmVPcC5Qb3BGcmFtZSk7XG4gIH1cbn0pO1xuXG5TVEFURU1FTlRTLmFkZChTZXhwT3Bjb2Rlcy5TdGF0aWNBdHRyLCAob3AsIFssIG5hbWUsIHZhbHVlLCBuYW1lc3BhY2VdKSA9PiB7XG4gIG9wKE9wLlN0YXRpY0F0dHIsIGluZmxhdGVBdHRyTmFtZShuYW1lKSwgdmFsdWUgYXMgc3RyaW5nLCBuYW1lc3BhY2UgPz8gbnVsbCk7XG59KTtcblxuU1RBVEVNRU5UUy5hZGQoU2V4cE9wY29kZXMuU3RhdGljQ29tcG9uZW50QXR0ciwgKG9wLCBbLCBuYW1lLCB2YWx1ZSwgbmFtZXNwYWNlXSkgPT4ge1xuICBvcChPcC5TdGF0aWNDb21wb25lbnRBdHRyLCBpbmZsYXRlQXR0ck5hbWUobmFtZSksIHZhbHVlIGFzIHN0cmluZywgbmFtZXNwYWNlID8/IG51bGwpO1xufSk7XG5cblNUQVRFTUVOVFMuYWRkKFNleHBPcGNvZGVzLkR5bmFtaWNBdHRyLCAob3AsIFssIG5hbWUsIHZhbHVlLCBuYW1lc3BhY2VdKSA9PiB7XG4gIGV4cHIob3AsIHZhbHVlKTtcbiAgb3AoT3AuRHluYW1pY0F0dHIsIGluZmxhdGVBdHRyTmFtZShuYW1lKSwgZmFsc2UsIG5hbWVzcGFjZSA/PyBudWxsKTtcbn0pO1xuXG5TVEFURU1FTlRTLmFkZChTZXhwT3Bjb2Rlcy5UcnVzdGluZ0R5bmFtaWNBdHRyLCAob3AsIFssIG5hbWUsIHZhbHVlLCBuYW1lc3BhY2VdKSA9PiB7XG4gIGV4cHIob3AsIHZhbHVlKTtcbiAgb3AoT3AuRHluYW1pY0F0dHIsIGluZmxhdGVBdHRyTmFtZShuYW1lKSwgdHJ1ZSwgbmFtZXNwYWNlID8/IG51bGwpO1xufSk7XG5cblNUQVRFTUVOVFMuYWRkKFNleHBPcGNvZGVzLkNvbXBvbmVudEF0dHIsIChvcCwgWywgbmFtZSwgdmFsdWUsIG5hbWVzcGFjZV0pID0+IHtcbiAgZXhwcihvcCwgdmFsdWUpO1xuICBvcChPcC5Db21wb25lbnRBdHRyLCBpbmZsYXRlQXR0ck5hbWUobmFtZSksIGZhbHNlLCBuYW1lc3BhY2UgPz8gbnVsbCk7XG59KTtcblxuU1RBVEVNRU5UUy5hZGQoU2V4cE9wY29kZXMuVHJ1c3RpbmdDb21wb25lbnRBdHRyLCAob3AsIFssIG5hbWUsIHZhbHVlLCBuYW1lc3BhY2VdKSA9PiB7XG4gIGV4cHIob3AsIHZhbHVlKTtcbiAgb3AoT3AuQ29tcG9uZW50QXR0ciwgaW5mbGF0ZUF0dHJOYW1lKG5hbWUpLCB0cnVlLCBuYW1lc3BhY2UgPz8gbnVsbCk7XG59KTtcblxuU1RBVEVNRU5UUy5hZGQoU2V4cE9wY29kZXMuT3BlbkVsZW1lbnQsIChvcCwgWywgdGFnXSkgPT4ge1xuICBvcChPcC5PcGVuRWxlbWVudCwgaW5mbGF0ZVRhZ05hbWUodGFnKSk7XG59KTtcblxuU1RBVEVNRU5UUy5hZGQoU2V4cE9wY29kZXMuT3BlbkVsZW1lbnRXaXRoU3BsYXQsIChvcCwgWywgdGFnXSkgPT4ge1xuICBvcChPcC5QdXRDb21wb25lbnRPcGVyYXRpb25zKTtcbiAgb3AoT3AuT3BlbkVsZW1lbnQsIGluZmxhdGVUYWdOYW1lKHRhZykpO1xufSk7XG5cblNUQVRFTUVOVFMuYWRkKFNleHBPcGNvZGVzLkNvbXBvbmVudCwgKG9wLCBbLCBleHByLCBlbGVtZW50QmxvY2ssIG5hbWVkLCBibG9ja3NdKSA9PiB7XG4gIGlmIChpc0dldEZyZWVDb21wb25lbnQoZXhwcikpIHtcbiAgICBvcChIaWdoTGV2ZWxSZXNvbHV0aW9uT3Bjb2RlLlJlc29sdmVDb21wb25lbnQsIGV4cHIsIChjb21wb25lbnQ6IENvbXBpbGVUaW1lQ29tcG9uZW50KSA9PiB7XG4gICAgICBJbnZva2VDb21wb25lbnQob3AsIGNvbXBvbmVudCwgZWxlbWVudEJsb2NrLCBudWxsLCBuYW1lZCwgYmxvY2tzKTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICAvLyBvdGhlcndpc2UsIHRoZSBjb21wb25lbnQgbmFtZSB3YXMgYW4gZXhwcmVzc2lvbiwgc28gcmVzb2x2ZSB0aGUgZXhwcmVzc2lvblxuICAgIC8vIGFuZCBpbnZva2UgaXQgYXMgYSBkeW5hbWljIGNvbXBvbmVudFxuICAgIEludm9rZUR5bmFtaWNDb21wb25lbnQob3AsIGV4cHIsIGVsZW1lbnRCbG9jaywgbnVsbCwgbmFtZWQsIGJsb2NrcywgdHJ1ZSwgdHJ1ZSk7XG4gIH1cbn0pO1xuXG5TVEFURU1FTlRTLmFkZChTZXhwT3Bjb2Rlcy5ZaWVsZCwgKG9wLCBbLCB0bywgcGFyYW1zXSkgPT4gWWllbGRCbG9jayhvcCwgdG8sIHBhcmFtcykpO1xuXG5TVEFURU1FTlRTLmFkZChTZXhwT3Bjb2Rlcy5BdHRyU3BsYXQsIChvcCwgWywgdG9dKSA9PiBZaWVsZEJsb2NrKG9wLCB0bywgbnVsbCkpO1xuXG5TVEFURU1FTlRTLmFkZChTZXhwT3Bjb2Rlcy5EZWJ1Z2dlciwgKG9wLCBbLCBldmFsSW5mb10pID0+XG4gIG9wKE9wLkRlYnVnZ2VyLCBldmFsU3ltYm9sc09wZXJhbmQoKSwgZXZhbEluZm8pXG4pO1xuXG5TVEFURU1FTlRTLmFkZChTZXhwT3Bjb2Rlcy5BcHBlbmQsIChvcCwgWywgdmFsdWVdKSA9PiB7XG4gIC8vIFNwZWNpYWwgY2FzZSBmb3Igc3RhdGljIHZhbHVlc1xuICBpZiAoIUFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgb3AoT3AuVGV4dCwgdmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCA/ICcnIDogU3RyaW5nKHZhbHVlKSk7XG4gIH0gZWxzZSBpZiAoaXNHZXRGcmVlT3B0aW9uYWxDb21wb25lbnRPckhlbHBlcih2YWx1ZSkpIHtcbiAgICBvcChIaWdoTGV2ZWxSZXNvbHV0aW9uT3Bjb2RlLlJlc29sdmVPcHRpb25hbENvbXBvbmVudE9ySGVscGVyLCB2YWx1ZSwge1xuICAgICAgaWZDb21wb25lbnQoY29tcG9uZW50OiBDb21waWxlVGltZUNvbXBvbmVudCkge1xuICAgICAgICBJbnZva2VDb21wb25lbnQob3AsIGNvbXBvbmVudCwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCk7XG4gICAgICB9LFxuXG4gICAgICBpZkhlbHBlcihoYW5kbGU6IG51bWJlcikge1xuICAgICAgICBvcChNYWNoaW5lT3AuUHVzaEZyYW1lKTtcbiAgICAgICAgQ2FsbChvcCwgaGFuZGxlLCBudWxsLCBudWxsKTtcbiAgICAgICAgb3AoTWFjaGluZU9wLkludm9rZVN0YXRpYywgc3RkbGliT3BlcmFuZCgnY2F1dGlvdXMtbm9uLWR5bmFtaWMtYXBwZW5kJykpO1xuICAgICAgICBvcChNYWNoaW5lT3AuUG9wRnJhbWUpO1xuICAgICAgfSxcblxuICAgICAgaWZWYWx1ZShoYW5kbGU6IG51bWJlcikge1xuICAgICAgICBvcChNYWNoaW5lT3AuUHVzaEZyYW1lKTtcbiAgICAgICAgb3AoT3AuQ29uc3RhbnRSZWZlcmVuY2UsIGhhbmRsZSk7XG4gICAgICAgIG9wKE1hY2hpbmVPcC5JbnZva2VTdGF0aWMsIHN0ZGxpYk9wZXJhbmQoJ2NhdXRpb3VzLW5vbi1keW5hbWljLWFwcGVuZCcpKTtcbiAgICAgICAgb3AoTWFjaGluZU9wLlBvcEZyYW1lKTtcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0gZWxzZSBpZiAodmFsdWVbMF0gPT09IFNleHBPcGNvZGVzLkNhbGwpIHtcbiAgICBsZXQgWywgZXhwcmVzc2lvbiwgcG9zaXRpb25hbCwgbmFtZWRdID0gdmFsdWU7XG5cbiAgICBpZiAoaXNHZXRGcmVlQ29tcG9uZW50T3JIZWxwZXIoZXhwcmVzc2lvbikpIHtcbiAgICAgIG9wKEhpZ2hMZXZlbFJlc29sdXRpb25PcGNvZGUuUmVzb2x2ZUNvbXBvbmVudE9ySGVscGVyLCBleHByZXNzaW9uLCB7XG4gICAgICAgIGlmQ29tcG9uZW50KGNvbXBvbmVudDogQ29tcGlsZVRpbWVDb21wb25lbnQpIHtcbiAgICAgICAgICBJbnZva2VDb21wb25lbnQob3AsIGNvbXBvbmVudCwgbnVsbCwgcG9zaXRpb25hbCwgaGFzaFRvQXJncyhuYW1lZCksIG51bGwpO1xuICAgICAgICB9LFxuICAgICAgICBpZkhlbHBlcihoYW5kbGU6IG51bWJlcikge1xuICAgICAgICAgIG9wKE1hY2hpbmVPcC5QdXNoRnJhbWUpO1xuICAgICAgICAgIENhbGwob3AsIGhhbmRsZSwgcG9zaXRpb25hbCwgbmFtZWQpO1xuICAgICAgICAgIG9wKE1hY2hpbmVPcC5JbnZva2VTdGF0aWMsIHN0ZGxpYk9wZXJhbmQoJ2NhdXRpb3VzLW5vbi1keW5hbWljLWFwcGVuZCcpKTtcbiAgICAgICAgICBvcChNYWNoaW5lT3AuUG9wRnJhbWUpO1xuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIFN3aXRjaENhc2VzKFxuICAgICAgICBvcCxcbiAgICAgICAgKCkgPT4ge1xuICAgICAgICAgIGV4cHIob3AsIGV4cHJlc3Npb24pO1xuICAgICAgICAgIG9wKE9wLkR5bmFtaWNDb250ZW50VHlwZSk7XG4gICAgICAgIH0sXG4gICAgICAgICh3aGVuKSA9PiB7XG4gICAgICAgICAgd2hlbihDb250ZW50VHlwZS5Db21wb25lbnQsICgpID0+IHtcbiAgICAgICAgICAgIG9wKE9wLlJlc29sdmVDdXJyaWVkQ29tcG9uZW50KTtcbiAgICAgICAgICAgIG9wKE9wLlB1c2hEeW5hbWljQ29tcG9uZW50SW5zdGFuY2UpO1xuICAgICAgICAgICAgSW52b2tlTm9uU3RhdGljQ29tcG9uZW50KG9wLCB7XG4gICAgICAgICAgICAgIGNhcGFiaWxpdGllczogdHJ1ZSxcbiAgICAgICAgICAgICAgZWxlbWVudEJsb2NrOiBudWxsLFxuICAgICAgICAgICAgICBwb3NpdGlvbmFsLFxuICAgICAgICAgICAgICBuYW1lZCxcbiAgICAgICAgICAgICAgYXROYW1lczogZmFsc2UsXG4gICAgICAgICAgICAgIGJsb2NrczogbmFtZWRCbG9ja3MobnVsbCksXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHdoZW4oQ29udGVudFR5cGUuSGVscGVyLCAoKSA9PiB7XG4gICAgICAgICAgICBDYWxsRHluYW1pYyhvcCwgcG9zaXRpb25hbCwgbmFtZWQsICgpID0+IHtcbiAgICAgICAgICAgICAgb3AoTWFjaGluZU9wLkludm9rZVN0YXRpYywgc3RkbGliT3BlcmFuZCgnY2F1dGlvdXMtbm9uLWR5bmFtaWMtYXBwZW5kJykpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIG9wKE1hY2hpbmVPcC5QdXNoRnJhbWUpO1xuICAgIGV4cHIob3AsIHZhbHVlKTtcbiAgICBvcChNYWNoaW5lT3AuSW52b2tlU3RhdGljLCBzdGRsaWJPcGVyYW5kKCdjYXV0aW91cy1hcHBlbmQnKSk7XG4gICAgb3AoTWFjaGluZU9wLlBvcEZyYW1lKTtcbiAgfVxufSk7XG5cblNUQVRFTUVOVFMuYWRkKFNleHBPcGNvZGVzLlRydXN0aW5nQXBwZW5kLCAob3AsIFssIHZhbHVlXSkgPT4ge1xuICBpZiAoIUFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgb3AoT3AuVGV4dCwgdmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCA/ICcnIDogU3RyaW5nKHZhbHVlKSk7XG4gIH0gZWxzZSB7XG4gICAgb3AoTWFjaGluZU9wLlB1c2hGcmFtZSk7XG4gICAgZXhwcihvcCwgdmFsdWUpO1xuICAgIG9wKE1hY2hpbmVPcC5JbnZva2VTdGF0aWMsIHN0ZGxpYk9wZXJhbmQoJ3RydXN0aW5nLWFwcGVuZCcpKTtcbiAgICBvcChNYWNoaW5lT3AuUG9wRnJhbWUpO1xuICB9XG59KTtcblxuU1RBVEVNRU5UUy5hZGQoU2V4cE9wY29kZXMuQmxvY2ssIChvcCwgWywgZXhwciwgcG9zaXRpb25hbCwgbmFtZWQsIGJsb2Nrc10pID0+IHtcbiAgaWYgKGlzR2V0RnJlZUNvbXBvbmVudChleHByKSkge1xuICAgIG9wKEhpZ2hMZXZlbFJlc29sdXRpb25PcGNvZGUuUmVzb2x2ZUNvbXBvbmVudCwgZXhwciwgKGNvbXBvbmVudDogQ29tcGlsZVRpbWVDb21wb25lbnQpID0+IHtcbiAgICAgIEludm9rZUNvbXBvbmVudChvcCwgY29tcG9uZW50LCBudWxsLCBwb3NpdGlvbmFsLCBoYXNoVG9BcmdzKG5hbWVkKSwgYmxvY2tzKTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBJbnZva2VEeW5hbWljQ29tcG9uZW50KG9wLCBleHByLCBudWxsLCBwb3NpdGlvbmFsLCBuYW1lZCwgYmxvY2tzLCBmYWxzZSwgZmFsc2UpO1xuICB9XG59KTtcblxuU1RBVEVNRU5UUy5hZGQoU2V4cE9wY29kZXMuSW5FbGVtZW50LCAob3AsIFssIGJsb2NrLCBndWlkLCBkZXN0aW5hdGlvbiwgaW5zZXJ0QmVmb3JlXSkgPT4ge1xuICBSZXBsYXlhYmxlSWYoXG4gICAgb3AsXG5cbiAgICAoKSA9PiB7XG4gICAgICBleHByKG9wLCBndWlkKTtcblxuICAgICAgaWYgKGluc2VydEJlZm9yZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIFB1c2hQcmltaXRpdmVSZWZlcmVuY2Uob3AsIHVuZGVmaW5lZCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBleHByKG9wLCBpbnNlcnRCZWZvcmUpO1xuICAgICAgfVxuXG4gICAgICBleHByKG9wLCBkZXN0aW5hdGlvbik7XG4gICAgICBvcChPcC5EdXAsICRzcCwgMCk7XG5cbiAgICAgIHJldHVybiA0O1xuICAgIH0sXG5cbiAgICAoKSA9PiB7XG4gICAgICBvcChPcC5QdXNoUmVtb3RlRWxlbWVudCk7XG4gICAgICBJbnZva2VTdGF0aWNCbG9jayhvcCwgYmxvY2spO1xuICAgICAgb3AoT3AuUG9wUmVtb3RlRWxlbWVudCk7XG4gICAgfVxuICApO1xufSk7XG5cblNUQVRFTUVOVFMuYWRkKFNleHBPcGNvZGVzLklmLCAob3AsIFssIGNvbmRpdGlvbiwgYmxvY2ssIGludmVyc2VdKSA9PlxuICBSZXBsYXlhYmxlSWYoXG4gICAgb3AsXG4gICAgKCkgPT4ge1xuICAgICAgZXhwcihvcCwgY29uZGl0aW9uKTtcbiAgICAgIG9wKE9wLlRvQm9vbGVhbik7XG5cbiAgICAgIHJldHVybiAxO1xuICAgIH0sXG5cbiAgICAoKSA9PiB7XG4gICAgICBJbnZva2VTdGF0aWNCbG9jayhvcCwgYmxvY2spO1xuICAgIH0sXG5cbiAgICBpbnZlcnNlXG4gICAgICA/ICgpID0+IHtcbiAgICAgICAgICBJbnZva2VTdGF0aWNCbG9jayhvcCwgaW52ZXJzZSk7XG4gICAgICAgIH1cbiAgICAgIDogdW5kZWZpbmVkXG4gIClcbik7XG5cblNUQVRFTUVOVFMuYWRkKFNleHBPcGNvZGVzLkVhY2gsIChvcCwgWywgdmFsdWUsIGtleSwgYmxvY2ssIGludmVyc2VdKSA9PlxuICBSZXBsYXlhYmxlKFxuICAgIG9wLFxuXG4gICAgKCkgPT4ge1xuICAgICAgaWYgKGtleSkge1xuICAgICAgICBleHByKG9wLCBrZXkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgUHVzaFByaW1pdGl2ZVJlZmVyZW5jZShvcCwgbnVsbCk7XG4gICAgICB9XG5cbiAgICAgIGV4cHIob3AsIHZhbHVlKTtcblxuICAgICAgcmV0dXJuIDI7XG4gICAgfSxcblxuICAgICgpID0+IHtcbiAgICAgIG9wKE9wLkVudGVyTGlzdCwgbGFiZWxPcGVyYW5kKCdCT0RZJyksIGxhYmVsT3BlcmFuZCgnRUxTRScpKTtcbiAgICAgIG9wKE1hY2hpbmVPcC5QdXNoRnJhbWUpO1xuICAgICAgb3AoT3AuRHVwLCAkZnAsIDEpO1xuICAgICAgb3AoTWFjaGluZU9wLlJldHVyblRvLCBsYWJlbE9wZXJhbmQoJ0lURVInKSk7XG4gICAgICBvcChIaWdoTGV2ZWxCdWlsZGVyT3Bjb2RlLkxhYmVsLCAnSVRFUicpO1xuICAgICAgb3AoT3AuSXRlcmF0ZSwgbGFiZWxPcGVyYW5kKCdCUkVBSycpKTtcbiAgICAgIG9wKEhpZ2hMZXZlbEJ1aWxkZXJPcGNvZGUuTGFiZWwsICdCT0RZJyk7XG4gICAgICBJbnZva2VTdGF0aWNCbG9ja1dpdGhTdGFjayhvcCwgYmxvY2ssIDIpO1xuICAgICAgb3AoT3AuUG9wLCAyKTtcbiAgICAgIG9wKE1hY2hpbmVPcC5KdW1wLCBsYWJlbE9wZXJhbmQoJ0ZJTkFMTFknKSk7XG4gICAgICBvcChIaWdoTGV2ZWxCdWlsZGVyT3Bjb2RlLkxhYmVsLCAnQlJFQUsnKTtcbiAgICAgIG9wKE1hY2hpbmVPcC5Qb3BGcmFtZSk7XG4gICAgICBvcChPcC5FeGl0TGlzdCk7XG4gICAgICBvcChNYWNoaW5lT3AuSnVtcCwgbGFiZWxPcGVyYW5kKCdGSU5BTExZJykpO1xuICAgICAgb3AoSGlnaExldmVsQnVpbGRlck9wY29kZS5MYWJlbCwgJ0VMU0UnKTtcblxuICAgICAgaWYgKGludmVyc2UpIHtcbiAgICAgICAgSW52b2tlU3RhdGljQmxvY2sob3AsIGludmVyc2UpO1xuICAgICAgfVxuICAgIH1cbiAgKVxuKTtcblxuU1RBVEVNRU5UUy5hZGQoU2V4cE9wY29kZXMuV2l0aCwgKG9wLCBbLCB2YWx1ZSwgYmxvY2ssIGludmVyc2VdKSA9PiB7XG4gIFJlcGxheWFibGVJZihcbiAgICBvcCxcblxuICAgICgpID0+IHtcbiAgICAgIGV4cHIob3AsIHZhbHVlKTtcbiAgICAgIG9wKE9wLkR1cCwgJHNwLCAwKTtcbiAgICAgIG9wKE9wLlRvQm9vbGVhbik7XG5cbiAgICAgIHJldHVybiAyO1xuICAgIH0sXG5cbiAgICAoKSA9PiB7XG4gICAgICBJbnZva2VTdGF0aWNCbG9ja1dpdGhTdGFjayhvcCwgYmxvY2ssIDEpO1xuICAgIH0sXG5cbiAgICAoKSA9PiB7XG4gICAgICBpZiAoaW52ZXJzZSkge1xuICAgICAgICBJbnZva2VTdGF0aWNCbG9jayhvcCwgaW52ZXJzZSk7XG4gICAgICB9XG4gICAgfVxuICApO1xufSk7XG5cblNUQVRFTUVOVFMuYWRkKFNleHBPcGNvZGVzLkxldCwgKG9wLCBbLCBwb3NpdGlvbmFsLCBibG9ja10pID0+IHtcbiAgbGV0IGNvdW50ID0gQ29tcGlsZVBvc2l0aW9uYWwob3AsIHBvc2l0aW9uYWwpO1xuICBJbnZva2VTdGF0aWNCbG9ja1dpdGhTdGFjayhvcCwgYmxvY2ssIGNvdW50KTtcbn0pO1xuXG5TVEFURU1FTlRTLmFkZChTZXhwT3Bjb2Rlcy5XaXRoRHluYW1pY1ZhcnMsIChvcCwgWywgbmFtZWQsIGJsb2NrXSkgPT4ge1xuICBpZiAobmFtZWQpIHtcbiAgICBsZXQgW25hbWVzLCBleHByZXNzaW9uc10gPSBuYW1lZDtcblxuICAgIENvbXBpbGVQb3NpdGlvbmFsKG9wLCBleHByZXNzaW9ucyk7XG4gICAgRHluYW1pY1Njb3BlKG9wLCBuYW1lcywgKCkgPT4ge1xuICAgICAgSW52b2tlU3RhdGljQmxvY2sob3AsIGJsb2NrKTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBJbnZva2VTdGF0aWNCbG9jayhvcCwgYmxvY2spO1xuICB9XG59KTtcblxuU1RBVEVNRU5UUy5hZGQoU2V4cE9wY29kZXMuSW52b2tlQ29tcG9uZW50LCAob3AsIFssIGV4cHIsIHBvc2l0aW9uYWwsIG5hbWVkLCBibG9ja3NdKSA9PiB7XG4gIGlmIChpc0dldEZyZWVDb21wb25lbnQoZXhwcikpIHtcbiAgICBvcChIaWdoTGV2ZWxSZXNvbHV0aW9uT3Bjb2RlLlJlc29sdmVDb21wb25lbnQsIGV4cHIsIChjb21wb25lbnQ6IENvbXBpbGVUaW1lQ29tcG9uZW50KSA9PiB7XG4gICAgICBJbnZva2VDb21wb25lbnQob3AsIGNvbXBvbmVudCwgbnVsbCwgcG9zaXRpb25hbCwgaGFzaFRvQXJncyhuYW1lZCksIGJsb2Nrcyk7XG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgSW52b2tlRHluYW1pY0NvbXBvbmVudChvcCwgZXhwciwgbnVsbCwgcG9zaXRpb25hbCwgbmFtZWQsIGJsb2NrcywgZmFsc2UsIGZhbHNlKTtcbiAgfVxufSk7XG5cbmZ1bmN0aW9uIGhhc2hUb0FyZ3MoaGFzaDogV2lyZUZvcm1hdC5Db3JlLkhhc2ggfCBudWxsKTogV2lyZUZvcm1hdC5Db3JlLkhhc2ggfCBudWxsIHtcbiAgaWYgKGhhc2ggPT09IG51bGwpIHJldHVybiBudWxsO1xuICBsZXQgbmFtZXMgPSBoYXNoWzBdLm1hcCgoa2V5KSA9PiBgQCR7a2V5fWApO1xuICByZXR1cm4gW25hbWVzIGFzIFtzdHJpbmcsIC4uLnN0cmluZ1tdXSwgaGFzaFsxXV07XG59XG4iXSwic291cmNlUm9vdCI6IiJ9