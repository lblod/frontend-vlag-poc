import { $fp, $sp } from '@glimmer/vm';
import { InvokeStaticBlock, InvokeStaticBlockWithStack, YieldBlock } from '../opcode-builder/helpers/blocks';
import { InvokeComponent, InvokeDynamicComponent, InvokeNonStaticComponent } from '../opcode-builder/helpers/components';
import { SwitchCases, Replayable, ReplayableIf } from '../opcode-builder/helpers/conditional';
import { expr } from '../opcode-builder/helpers/expr';
import { CompilePositional, SimpleArgs } from '../opcode-builder/helpers/shared';
import { Call, CallDynamic, DynamicScope, PushPrimitiveReference } from '../opcode-builder/helpers/vm';
import { evalSymbolsOperand, labelOperand, stdlibOperand } from '../opcode-builder/operands';
import { Compilers } from './compilers';
import { isGetFreeComponent, isGetFreeComponentOrHelper, isGetFreeModifier, isGetFreeOptionalComponentOrHelper } from '../opcode-builder/helpers/resolution';
import { namedBlocks } from '../utils';
export var STATEMENTS = new Compilers();
var INFLATE_ATTR_TABLE = ['class', 'id', 'value', 'name', 'type', 'style', 'href'];
var INFLATE_TAG_TABLE = ['div', 'span', 'p', 'a'];
export function inflateTagName(tagName) {
  return typeof tagName === 'string' ? tagName : INFLATE_TAG_TABLE[tagName];
}
export function inflateAttrName(attrName) {
  return typeof attrName === 'string' ? attrName : INFLATE_ATTR_TABLE[attrName];
}
STATEMENTS.add(3
/* Comment */
, function (op, sexp) {
  return op(42
  /* Comment */
  , sexp[1]);
});
STATEMENTS.add(13
/* CloseElement */
, function (op) {
  return op(55
  /* CloseElement */
  );
});
STATEMENTS.add(12
/* FlushElement */
, function (op) {
  return op(54
  /* FlushElement */
  );
});
STATEMENTS.add(4
/* Modifier */
, function (op, _ref) {
  var expression = _ref[1],
      positional = _ref[2],
      named = _ref[3];

  if (isGetFreeModifier(expression)) {
    op(1003
    /* ResolveModifier */
    , expression, function (handle) {
      op(0
      /* PushFrame */
      );
      SimpleArgs(op, positional, named, false);
      op(57
      /* Modifier */
      , handle);
      op(1
      /* PopFrame */
      );
    });
  } else {
    expr(op, expression);
    op(0
    /* PushFrame */
    );
    SimpleArgs(op, positional, named, false);
    op(33
    /* Dup */
    , $fp, 1);
    op(108
    /* DynamicModifier */
    );
    op(1
    /* PopFrame */
    );
  }
});
STATEMENTS.add(14
/* StaticAttr */
, function (op, _ref2) {
  var name = _ref2[1],
      value = _ref2[2],
      namespace = _ref2[3];
  op(51
  /* StaticAttr */
  , inflateAttrName(name), value, namespace !== null && namespace !== void 0 ? namespace : null);
});
STATEMENTS.add(24
/* StaticComponentAttr */
, function (op, _ref3) {
  var name = _ref3[1],
      value = _ref3[2],
      namespace = _ref3[3];
  op(105
  /* StaticComponentAttr */
  , inflateAttrName(name), value, namespace !== null && namespace !== void 0 ? namespace : null);
});
STATEMENTS.add(15
/* DynamicAttr */
, function (op, _ref4) {
  var name = _ref4[1],
      value = _ref4[2],
      namespace = _ref4[3];
  expr(op, value);
  op(52
  /* DynamicAttr */
  , inflateAttrName(name), false, namespace !== null && namespace !== void 0 ? namespace : null);
});
STATEMENTS.add(22
/* TrustingDynamicAttr */
, function (op, _ref5) {
  var name = _ref5[1],
      value = _ref5[2],
      namespace = _ref5[3];
  expr(op, value);
  op(52
  /* DynamicAttr */
  , inflateAttrName(name), true, namespace !== null && namespace !== void 0 ? namespace : null);
});
STATEMENTS.add(16
/* ComponentAttr */
, function (op, _ref6) {
  var name = _ref6[1],
      value = _ref6[2],
      namespace = _ref6[3];
  expr(op, value);
  op(53
  /* ComponentAttr */
  , inflateAttrName(name), false, namespace !== null && namespace !== void 0 ? namespace : null);
});
STATEMENTS.add(23
/* TrustingComponentAttr */
, function (op, _ref7) {
  var name = _ref7[1],
      value = _ref7[2],
      namespace = _ref7[3];
  expr(op, value);
  op(53
  /* ComponentAttr */
  , inflateAttrName(name), true, namespace !== null && namespace !== void 0 ? namespace : null);
});
STATEMENTS.add(10
/* OpenElement */
, function (op, _ref8) {
  var tag = _ref8[1];
  op(48
  /* OpenElement */
  , inflateTagName(tag));
});
STATEMENTS.add(11
/* OpenElementWithSplat */
, function (op, _ref9) {
  var tag = _ref9[1];
  op(89
  /* PutComponentOperations */
  );
  op(48
  /* OpenElement */
  , inflateTagName(tag));
});
STATEMENTS.add(8
/* Component */
, function (op, _ref10) {
  var expr = _ref10[1],
      elementBlock = _ref10[2],
      named = _ref10[3],
      blocks = _ref10[4];

  if (isGetFreeComponent(expr)) {
    op(1004
    /* ResolveComponent */
    , expr, function (component) {
      InvokeComponent(op, component, elementBlock, null, named, blocks);
    });
  } else {
    // otherwise, the component name was an expression, so resolve the expression
    // and invoke it as a dynamic component
    InvokeDynamicComponent(op, expr, elementBlock, null, named, blocks, true, true);
  }
});
STATEMENTS.add(18
/* Yield */
, function (op, _ref11) {
  var to = _ref11[1],
      params = _ref11[2];
  return YieldBlock(op, to, params);
});
STATEMENTS.add(17
/* AttrSplat */
, function (op, _ref12) {
  var to = _ref12[1];
  return YieldBlock(op, to, null);
});
STATEMENTS.add(26
/* Debugger */
, function (op, _ref13) {
  var evalInfo = _ref13[1];
  return op(103
  /* Debugger */
  , evalSymbolsOperand(), evalInfo);
});
STATEMENTS.add(1
/* Append */
, function (op, _ref14) {
  var value = _ref14[1];

  // Special case for static values
  if (!Array.isArray(value)) {
    op(41
    /* Text */
    , value === null || value === undefined ? '' : String(value));
  } else if (isGetFreeOptionalComponentOrHelper(value)) {
    op(1008
    /* ResolveOptionalComponentOrHelper */
    , value, {
      ifComponent: function ifComponent(component) {
        InvokeComponent(op, component, null, null, null, null);
      },
      ifHelper: function ifHelper(handle) {
        op(0
        /* PushFrame */
        );
        Call(op, handle, null, null);
        op(3
        /* InvokeStatic */
        , stdlibOperand('cautious-non-dynamic-append'));
        op(1
        /* PopFrame */
        );
      },
      ifValue: function ifValue(handle) {
        op(0
        /* PushFrame */
        );
        op(29
        /* ConstantReference */
        , handle);
        op(3
        /* InvokeStatic */
        , stdlibOperand('cautious-non-dynamic-append'));
        op(1
        /* PopFrame */
        );
      }
    });
  } else if (value[0] === 28
  /* Call */
  ) {
      var expression = value[1],
          positional = value[2],
          named = value[3];

      if (isGetFreeComponentOrHelper(expression)) {
        op(1007
        /* ResolveComponentOrHelper */
        , expression, {
          ifComponent: function ifComponent(component) {
            InvokeComponent(op, component, null, positional, hashToArgs(named), null);
          },
          ifHelper: function ifHelper(handle) {
            op(0
            /* PushFrame */
            );
            Call(op, handle, positional, named);
            op(3
            /* InvokeStatic */
            , stdlibOperand('cautious-non-dynamic-append'));
            op(1
            /* PopFrame */
            );
          }
        });
      } else {
        SwitchCases(op, function () {
          expr(op, expression);
          op(106
          /* DynamicContentType */
          );
        }, function (when) {
          when(0
          /* Component */
          , function () {
            op(81
            /* ResolveCurriedComponent */
            );
            op(79
            /* PushDynamicComponentInstance */
            );
            InvokeNonStaticComponent(op, {
              capabilities: true,
              elementBlock: null,
              positional: positional,
              named: named,
              atNames: false,
              blocks: namedBlocks(null)
            });
          });
          when(1
          /* Helper */
          , function () {
            CallDynamic(op, positional, named, function () {
              op(3
              /* InvokeStatic */
              , stdlibOperand('cautious-non-dynamic-append'));
            });
          });
        });
      }
    } else {
    op(0
    /* PushFrame */
    );
    expr(op, value);
    op(3
    /* InvokeStatic */
    , stdlibOperand('cautious-append'));
    op(1
    /* PopFrame */
    );
  }
});
STATEMENTS.add(2
/* TrustingAppend */
, function (op, _ref15) {
  var value = _ref15[1];

  if (!Array.isArray(value)) {
    op(41
    /* Text */
    , value === null || value === undefined ? '' : String(value));
  } else {
    op(0
    /* PushFrame */
    );
    expr(op, value);
    op(3
    /* InvokeStatic */
    , stdlibOperand('trusting-append'));
    op(1
    /* PopFrame */
    );
  }
});
STATEMENTS.add(6
/* Block */
, function (op, _ref16) {
  var expr = _ref16[1],
      positional = _ref16[2],
      named = _ref16[3],
      blocks = _ref16[4];

  if (isGetFreeComponent(expr)) {
    op(1004
    /* ResolveComponent */
    , expr, function (component) {
      InvokeComponent(op, component, null, positional, hashToArgs(named), blocks);
    });
  } else {
    InvokeDynamicComponent(op, expr, null, positional, named, blocks, false, false);
  }
});
STATEMENTS.add(40
/* InElement */
, function (op, _ref17) {
  var block = _ref17[1],
      guid = _ref17[2],
      destination = _ref17[3],
      insertBefore = _ref17[4];
  ReplayableIf(op, function () {
    expr(op, guid);

    if (insertBefore === undefined) {
      PushPrimitiveReference(op, undefined);
    } else {
      expr(op, insertBefore);
    }

    expr(op, destination);
    op(33
    /* Dup */
    , $sp, 0);
    return 4;
  }, function () {
    op(50
    /* PushRemoteElement */
    );
    InvokeStaticBlock(op, block);
    op(56
    /* PopRemoteElement */
    );
  });
});
STATEMENTS.add(41
/* If */
, function (op, _ref18) {
  var condition = _ref18[1],
      block = _ref18[2],
      inverse = _ref18[3];
  return ReplayableIf(op, function () {
    expr(op, condition);
    op(71
    /* ToBoolean */
    );
    return 1;
  }, function () {
    InvokeStaticBlock(op, block);
  }, inverse ? function () {
    InvokeStaticBlock(op, inverse);
  } : undefined);
});
STATEMENTS.add(42
/* Each */
, function (op, _ref19) {
  var value = _ref19[1],
      key = _ref19[2],
      block = _ref19[3],
      inverse = _ref19[4];
  return Replayable(op, function () {
    if (key) {
      expr(op, key);
    } else {
      PushPrimitiveReference(op, null);
    }

    expr(op, value);
    return 2;
  }, function () {
    op(72
    /* EnterList */
    , labelOperand('BODY'), labelOperand('ELSE'));
    op(0
    /* PushFrame */
    );
    op(33
    /* Dup */
    , $fp, 1);
    op(6
    /* ReturnTo */
    , labelOperand('ITER'));
    op(1000
    /* Label */
    , 'ITER');
    op(74
    /* Iterate */
    , labelOperand('BREAK'));
    op(1000
    /* Label */
    , 'BODY');
    InvokeStaticBlockWithStack(op, block, 2);
    op(34
    /* Pop */
    , 2);
    op(4
    /* Jump */
    , labelOperand('FINALLY'));
    op(1000
    /* Label */
    , 'BREAK');
    op(1
    /* PopFrame */
    );
    op(73
    /* ExitList */
    );
    op(4
    /* Jump */
    , labelOperand('FINALLY'));
    op(1000
    /* Label */
    , 'ELSE');

    if (inverse) {
      InvokeStaticBlock(op, inverse);
    }
  });
});
STATEMENTS.add(43
/* With */
, function (op, _ref20) {
  var value = _ref20[1],
      block = _ref20[2],
      inverse = _ref20[3];
  ReplayableIf(op, function () {
    expr(op, value);
    op(33
    /* Dup */
    , $sp, 0);
    op(71
    /* ToBoolean */
    );
    return 2;
  }, function () {
    InvokeStaticBlockWithStack(op, block, 1);
  }, function () {
    if (inverse) {
      InvokeStaticBlock(op, inverse);
    }
  });
});
STATEMENTS.add(44
/* Let */
, function (op, _ref21) {
  var positional = _ref21[1],
      block = _ref21[2];
  var count = CompilePositional(op, positional);
  InvokeStaticBlockWithStack(op, block, count);
});
STATEMENTS.add(45
/* WithDynamicVars */
, function (op, _ref22) {
  var named = _ref22[1],
      block = _ref22[2];

  if (named) {
    var names = named[0],
        expressions = named[1];
    CompilePositional(op, expressions);
    DynamicScope(op, names, function () {
      InvokeStaticBlock(op, block);
    });
  } else {
    InvokeStaticBlock(op, block);
  }
});
STATEMENTS.add(46
/* InvokeComponent */
, function (op, _ref23) {
  var expr = _ref23[1],
      positional = _ref23[2],
      named = _ref23[3],
      blocks = _ref23[4];

  if (isGetFreeComponent(expr)) {
    op(1004
    /* ResolveComponent */
    , expr, function (component) {
      InvokeComponent(op, component, null, positional, hashToArgs(named), blocks);
    });
  } else {
    InvokeDynamicComponent(op, expr, null, positional, named, blocks, false, false);
  }
});

function hashToArgs(hash) {
  if (hash === null) return null;
  var names = hash[0].map(function (key) {
    return "@" + key;
  });
  return [names, hash[1]];
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL29wY29kZS1jb21waWxlci9saWIvc3ludGF4L3N0YXRlbWVudHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBYUEsU0FBQSxHQUFBLEVBQUEsR0FBQSxRQUFBLGFBQUE7QUFDQSxTQUFBLGlCQUFBLEVBQUEsMEJBQUEsRUFBQSxVQUFBLFFBQUEsa0NBQUE7QUFLQSxTQUFBLGVBQUEsRUFBQSxzQkFBQSxFQUFBLHdCQUFBLFFBQUEsc0NBQUE7QUFLQSxTQUFBLFdBQUEsRUFBQSxVQUFBLEVBQUEsWUFBQSxRQUFBLHVDQUFBO0FBQ0EsU0FBQSxJQUFBLFFBQUEsZ0NBQUE7QUFDQSxTQUFBLGlCQUFBLEVBQUEsVUFBQSxRQUFBLGtDQUFBO0FBQ0EsU0FBQSxJQUFBLEVBQUEsV0FBQSxFQUFBLFlBQUEsRUFBQSxzQkFBQSxRQUFBLDhCQUFBO0FBTUEsU0FBQSxrQkFBQSxFQUFBLFlBQUEsRUFBQSxhQUFBLFFBQUEsNEJBQUE7QUFDQSxTQUFBLFNBQUEsUUFBQSxhQUFBO0FBQ0EsU0FBQSxrQkFBQSxFQUFBLDBCQUFBLEVBQUEsaUJBQUEsRUFBQSxrQ0FBQSxRQUFBLHNDQUFBO0FBTUEsU0FBQSxXQUFBLFFBQUEsVUFBQTtBQUVBLE9BQU8sSUFBTSxVQUFVLEdBQUcsSUFBbkIsU0FBbUIsRUFBbkI7QUFFUCxJQUFNLGtCQUFrQixHQUVwQixDQUFBLE9BQUEsRUFBQSxJQUFBLEVBQUEsT0FBQSxFQUFBLE1BQUEsRUFBQSxNQUFBLEVBQUEsT0FBQSxFQUZKLE1BRUksQ0FGSjtBQUdBLElBQU0saUJBQWlCLEdBRW5CLENBQUEsS0FBQSxFQUFBLE1BQUEsRUFBQSxHQUFBLEVBRkosR0FFSSxDQUZKO0FBSUEsT0FBTSxTQUFBLGNBQUEsQ0FBQSxPQUFBLEVBQTJEO0FBQy9ELFNBQU8sT0FBQSxPQUFBLEtBQUEsUUFBQSxHQUFBLE9BQUEsR0FBd0MsaUJBQWlCLENBQWhFLE9BQWdFLENBQWhFO0FBQ0Q7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QUFBLE1BT087QUFDTCxJQUFBLGlCQUFpQixDQUFBLEVBQUEsRUFBakIsS0FBaUIsQ0FBakI7QUFDRDtBQVZILENBQUE7QUFhQSxVQUFVLENBQVYsR0FBQSxDQUFjO0FBQUE7QUFBZCxFQUE0QyxVQUFBLEVBQUEsVUFBNEM7QUFBQSxNQUF2QyxJQUF1QztBQUFBLE1BQXZDLFVBQXVDO0FBQUEsTUFBdkMsS0FBdUM7QUFBQSxNQUE1QyxNQUE0Qzs7QUFDdEYsTUFBSSxrQkFBa0IsQ0FBdEIsSUFBc0IsQ0FBdEIsRUFBOEI7QUFDNUIsSUFBQSxFQUFFLENBQUE7QUFBQTtBQUFBLE1BQUEsSUFBQSxFQUFvRCxVQUFBLFNBQUQsRUFBb0M7QUFDdkYsTUFBQSxlQUFlLENBQUEsRUFBQSxFQUFBLFNBQUEsRUFBQSxJQUFBLEVBQUEsVUFBQSxFQUFrQyxVQUFVLENBQTVDLEtBQTRDLENBQTVDLEVBQWYsTUFBZSxDQUFmO0FBREYsS0FBRSxDQUFGO0FBREYsR0FBQSxNQUlPO0FBQ0wsSUFBQSxzQkFBc0IsQ0FBQSxFQUFBLEVBQUEsSUFBQSxFQUFBLElBQUEsRUFBQSxVQUFBLEVBQUEsS0FBQSxFQUFBLE1BQUEsRUFBQSxLQUFBLEVBQXRCLEtBQXNCLENBQXRCO0FBQ0Q7QUFQSCxDQUFBOztBQVVBLFNBQUEsVUFBQSxDQUFBLElBQUEsRUFBcUQ7QUFDbkQsTUFBSSxJQUFJLEtBQVIsSUFBQSxFQUFtQixPQUFBLElBQUE7QUFDbkIsTUFBSSxLQUFLLEdBQUcsSUFBSSxDQUFKLENBQUksQ0FBSixDQUFBLEdBQUEsQ0FBYSxVQUFBLEdBQUQ7QUFBQSxpQkFBeEIsR0FBd0I7QUFBQSxHQUFaLENBQVo7QUFDQSxTQUFPLENBQUEsS0FBQSxFQUFpQyxJQUFJLENBQTVDLENBQTRDLENBQXJDLENBQVA7QUFDRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIENvbXBpbGVUaW1lQ29tcG9uZW50LFxuICBDb250ZW50VHlwZSxcbiAgSGlnaExldmVsQnVpbGRlck9wY29kZSxcbiAgSGlnaExldmVsUmVzb2x1dGlvbk9wY29kZSxcbiAgTWFjaGluZU9wLFxuICBPcCxcbiAgU2V4cE9wY29kZXMsXG4gIFN0YXRlbWVudFNleHBPcGNvZGUsXG4gIFdlbGxLbm93bkF0dHJOYW1lLFxuICBXZWxsS25vd25UYWdOYW1lLFxuICBXaXJlRm9ybWF0LFxufSBmcm9tICdAZ2xpbW1lci9pbnRlcmZhY2VzJztcbmltcG9ydCB7ICRmcCwgJHNwIH0gZnJvbSAnQGdsaW1tZXIvdm0nO1xuaW1wb3J0IHtcbiAgSW52b2tlU3RhdGljQmxvY2ssXG4gIEludm9rZVN0YXRpY0Jsb2NrV2l0aFN0YWNrLFxuICBZaWVsZEJsb2NrLFxufSBmcm9tICcuLi9vcGNvZGUtYnVpbGRlci9oZWxwZXJzL2Jsb2Nrcyc7XG5pbXBvcnQge1xuICBJbnZva2VDb21wb25lbnQsXG4gIEludm9rZUR5bmFtaWNDb21wb25lbnQsXG4gIEludm9rZU5vblN0YXRpY0NvbXBvbmVudCxcbn0gZnJvbSAnLi4vb3Bjb2RlLWJ1aWxkZXIvaGVscGVycy9jb21wb25lbnRzJztcbmltcG9ydCB7IFN3aXRjaENhc2VzLCBSZXBsYXlhYmxlLCBSZXBsYXlhYmxlSWYgfSBmcm9tICcuLi9vcGNvZGUtYnVpbGRlci9oZWxwZXJzL2NvbmRpdGlvbmFsJztcbmltcG9ydCB7IGV4cHIgfSBmcm9tICcuLi9vcGNvZGUtYnVpbGRlci9oZWxwZXJzL2V4cHInO1xuaW1wb3J0IHsgQ29tcGlsZVBvc2l0aW9uYWwsIFNpbXBsZUFyZ3MgfSBmcm9tICcuLi9vcGNvZGUtYnVpbGRlci9oZWxwZXJzL3NoYXJlZCc7XG5pbXBvcnQge1xuICBDYWxsLFxuICBDYWxsRHluYW1pYyxcbiAgRHluYW1pY1Njb3BlLFxuICBQdXNoUHJpbWl0aXZlUmVmZXJlbmNlLFxufSBmcm9tICcuLi9vcGNvZGUtYnVpbGRlci9oZWxwZXJzL3ZtJztcbmltcG9ydCB7IGV2YWxTeW1ib2xzT3BlcmFuZCwgbGFiZWxPcGVyYW5kLCBzdGRsaWJPcGVyYW5kIH0gZnJvbSAnLi4vb3Bjb2RlLWJ1aWxkZXIvb3BlcmFuZHMnO1xuaW1wb3J0IHsgQ29tcGlsZXJzLCBQdXNoU3RhdGVtZW50T3AgfSBmcm9tICcuL2NvbXBpbGVycyc7XG5pbXBvcnQge1xuICBpc0dldEZyZWVDb21wb25lbnQsXG4gIGlzR2V0RnJlZUNvbXBvbmVudE9ySGVscGVyLFxuICBpc0dldEZyZWVNb2RpZmllcixcbiAgaXNHZXRGcmVlT3B0aW9uYWxDb21wb25lbnRPckhlbHBlcixcbn0gZnJvbSAnLi4vb3Bjb2RlLWJ1aWxkZXIvaGVscGVycy9yZXNvbHV0aW9uJztcbmltcG9ydCB7IG5hbWVkQmxvY2tzIH0gZnJvbSAnLi4vdXRpbHMnO1xuXG5leHBvcnQgY29uc3QgU1RBVEVNRU5UUyA9IG5ldyBDb21waWxlcnM8UHVzaFN0YXRlbWVudE9wLCBTdGF0ZW1lbnRTZXhwT3Bjb2RlPigpO1xuXG5jb25zdCBJTkZMQVRFX0FUVFJfVEFCTEU6IHtcbiAgW0kgaW4gV2VsbEtub3duQXR0ck5hbWVdOiBzdHJpbmc7XG59ID0gWydjbGFzcycsICdpZCcsICd2YWx1ZScsICduYW1lJywgJ3R5cGUnLCAnc3R5bGUnLCAnaHJlZiddO1xuY29uc3QgSU5GTEFURV9UQUdfVEFCTEU6IHtcbiAgW0kgaW4gV2VsbEtub3duVGFnTmFtZV06IHN0cmluZztcbn0gPSBbJ2RpdicsICdzcGFuJywgJ3AnLCAnYSddO1xuXG5leHBvcnQgZnVuY3Rpb24gaW5mbGF0ZVRhZ05hbWUodGFnTmFtZTogc3RyaW5nIHwgV2VsbEtub3duVGFnTmFtZSk6IHN0cmluZyB7XG4gIHJldHVybiB0eXBlb2YgdGFnTmFtZSA9PT0gJ3N0cmluZycgPyB0YWdOYW1lIDogSU5GTEFURV9UQUdfVEFCTEVbdGFnTmFtZV07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpbmZsYXRlQXR0ck5hbWUoYXR0ck5hbWU6IHN0cmluZyB8IFdlbGxLbm93bkF0dHJOYW1lKTogc3RyaW5nIHtcbiAgcmV0dXJuIHR5cGVvZiBhdHRyTmFtZSA9PT0gJ3N0cmluZycgPyBhdHRyTmFtZSA6IElORkxBVEVfQVRUUl9UQUJMRVthdHRyTmFtZV07XG59XG5cblNUQVRFTUVOVFMuYWRkKFNleHBPcGNvZGVzLkNvbW1lbnQsIChvcCwgc2V4cCkgPT4gb3AoT3AuQ29tbWVudCwgc2V4cFsxXSkpO1xuU1RBVEVNRU5UUy5hZGQoU2V4cE9wY29kZXMuQ2xvc2VFbGVtZW50LCAob3ApID0+IG9wKE9wLkNsb3NlRWxlbWVudCkpO1xuU1RBVEVNRU5UUy5hZGQoU2V4cE9wY29kZXMuRmx1c2hFbGVtZW50LCAob3ApID0+IG9wKE9wLkZsdXNoRWxlbWVudCkpO1xuXG5TVEFURU1FTlRTLmFkZChTZXhwT3Bjb2Rlcy5Nb2RpZmllciwgKG9wLCBbLCBleHByZXNzaW9uLCBwb3NpdGlvbmFsLCBuYW1lZF0pID0+IHtcbiAgaWYgKGlzR2V0RnJlZU1vZGlmaWVyKGV4cHJlc3Npb24pKSB7XG4gICAgb3AoSGlnaExldmVsUmVzb2x1dGlvbk9wY29kZS5SZXNvbHZlTW9kaWZpZXIsIGV4cHJlc3Npb24sIChoYW5kbGU6IG51bWJlcikgPT4ge1xuICAgICAgb3AoTWFjaGluZU9wLlB1c2hGcmFtZSk7XG4gICAgICBTaW1wbGVBcmdzKG9wLCBwb3NpdGlvbmFsLCBuYW1lZCwgZmFsc2UpO1xuICAgICAgb3AoT3AuTW9kaWZpZXIsIGhhbmRsZSk7XG4gICAgICBvcChNYWNoaW5lT3AuUG9wRnJhbWUpO1xuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIGV4cHIob3AsIGV4cHJlc3Npb24pO1xuICAgIG9wKE1hY2hpbmVPcC5QdXNoRnJhbWUpO1xuICAgIFNpbXBsZUFyZ3Mob3AsIHBvc2l0aW9uYWwsIG5hbWVkLCBmYWxzZSk7XG4gICAgb3AoT3AuRHVwLCAkZnAsIDEpO1xuICAgIG9wKE9wLkR5bmFtaWNNb2RpZmllcik7XG4gICAgb3AoTWFjaGluZU9wLlBvcEZyYW1lKTtcbiAgfVxufSk7XG5cblNUQVRFTUVOVFMuYWRkKFNleHBPcGNvZGVzLlN0YXRpY0F0dHIsIChvcCwgWywgbmFtZSwgdmFsdWUsIG5hbWVzcGFjZV0pID0+IHtcbiAgb3AoT3AuU3RhdGljQXR0ciwgaW5mbGF0ZUF0dHJOYW1lKG5hbWUpLCB2YWx1ZSBhcyBzdHJpbmcsIG5hbWVzcGFjZSA/PyBudWxsKTtcbn0pO1xuXG5TVEFURU1FTlRTLmFkZChTZXhwT3Bjb2Rlcy5TdGF0aWNDb21wb25lbnRBdHRyLCAob3AsIFssIG5hbWUsIHZhbHVlLCBuYW1lc3BhY2VdKSA9PiB7XG4gIG9wKE9wLlN0YXRpY0NvbXBvbmVudEF0dHIsIGluZmxhdGVBdHRyTmFtZShuYW1lKSwgdmFsdWUgYXMgc3RyaW5nLCBuYW1lc3BhY2UgPz8gbnVsbCk7XG59KTtcblxuU1RBVEVNRU5UUy5hZGQoU2V4cE9wY29kZXMuRHluYW1pY0F0dHIsIChvcCwgWywgbmFtZSwgdmFsdWUsIG5hbWVzcGFjZV0pID0+IHtcbiAgZXhwcihvcCwgdmFsdWUpO1xuICBvcChPcC5EeW5hbWljQXR0ciwgaW5mbGF0ZUF0dHJOYW1lKG5hbWUpLCBmYWxzZSwgbmFtZXNwYWNlID8/IG51bGwpO1xufSk7XG5cblNUQVRFTUVOVFMuYWRkKFNleHBPcGNvZGVzLlRydXN0aW5nRHluYW1pY0F0dHIsIChvcCwgWywgbmFtZSwgdmFsdWUsIG5hbWVzcGFjZV0pID0+IHtcbiAgZXhwcihvcCwgdmFsdWUpO1xuICBvcChPcC5EeW5hbWljQXR0ciwgaW5mbGF0ZUF0dHJOYW1lKG5hbWUpLCB0cnVlLCBuYW1lc3BhY2UgPz8gbnVsbCk7XG59KTtcblxuU1RBVEVNRU5UUy5hZGQoU2V4cE9wY29kZXMuQ29tcG9uZW50QXR0ciwgKG9wLCBbLCBuYW1lLCB2YWx1ZSwgbmFtZXNwYWNlXSkgPT4ge1xuICBleHByKG9wLCB2YWx1ZSk7XG4gIG9wKE9wLkNvbXBvbmVudEF0dHIsIGluZmxhdGVBdHRyTmFtZShuYW1lKSwgZmFsc2UsIG5hbWVzcGFjZSA/PyBudWxsKTtcbn0pO1xuXG5TVEFURU1FTlRTLmFkZChTZXhwT3Bjb2Rlcy5UcnVzdGluZ0NvbXBvbmVudEF0dHIsIChvcCwgWywgbmFtZSwgdmFsdWUsIG5hbWVzcGFjZV0pID0+IHtcbiAgZXhwcihvcCwgdmFsdWUpO1xuICBvcChPcC5Db21wb25lbnRBdHRyLCBpbmZsYXRlQXR0ck5hbWUobmFtZSksIHRydWUsIG5hbWVzcGFjZSA/PyBudWxsKTtcbn0pO1xuXG5TVEFURU1FTlRTLmFkZChTZXhwT3Bjb2Rlcy5PcGVuRWxlbWVudCwgKG9wLCBbLCB0YWddKSA9PiB7XG4gIG9wKE9wLk9wZW5FbGVtZW50LCBpbmZsYXRlVGFnTmFtZSh0YWcpKTtcbn0pO1xuXG5TVEFURU1FTlRTLmFkZChTZXhwT3Bjb2Rlcy5PcGVuRWxlbWVudFdpdGhTcGxhdCwgKG9wLCBbLCB0YWddKSA9PiB7XG4gIG9wKE9wLlB1dENvbXBvbmVudE9wZXJhdGlvbnMpO1xuICBvcChPcC5PcGVuRWxlbWVudCwgaW5mbGF0ZVRhZ05hbWUodGFnKSk7XG59KTtcblxuU1RBVEVNRU5UUy5hZGQoU2V4cE9wY29kZXMuQ29tcG9uZW50LCAob3AsIFssIGV4cHIsIGVsZW1lbnRCbG9jaywgbmFtZWQsIGJsb2Nrc10pID0+IHtcbiAgaWYgKGlzR2V0RnJlZUNvbXBvbmVudChleHByKSkge1xuICAgIG9wKEhpZ2hMZXZlbFJlc29sdXRpb25PcGNvZGUuUmVzb2x2ZUNvbXBvbmVudCwgZXhwciwgKGNvbXBvbmVudDogQ29tcGlsZVRpbWVDb21wb25lbnQpID0+IHtcbiAgICAgIEludm9rZUNvbXBvbmVudChvcCwgY29tcG9uZW50LCBlbGVtZW50QmxvY2ssIG51bGwsIG5hbWVkLCBibG9ja3MpO1xuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIC8vIG90aGVyd2lzZSwgdGhlIGNvbXBvbmVudCBuYW1lIHdhcyBhbiBleHByZXNzaW9uLCBzbyByZXNvbHZlIHRoZSBleHByZXNzaW9uXG4gICAgLy8gYW5kIGludm9rZSBpdCBhcyBhIGR5bmFtaWMgY29tcG9uZW50XG4gICAgSW52b2tlRHluYW1pY0NvbXBvbmVudChvcCwgZXhwciwgZWxlbWVudEJsb2NrLCBudWxsLCBuYW1lZCwgYmxvY2tzLCB0cnVlLCB0cnVlKTtcbiAgfVxufSk7XG5cblNUQVRFTUVOVFMuYWRkKFNleHBPcGNvZGVzLllpZWxkLCAob3AsIFssIHRvLCBwYXJhbXNdKSA9PiBZaWVsZEJsb2NrKG9wLCB0bywgcGFyYW1zKSk7XG5cblNUQVRFTUVOVFMuYWRkKFNleHBPcGNvZGVzLkF0dHJTcGxhdCwgKG9wLCBbLCB0b10pID0+IFlpZWxkQmxvY2sob3AsIHRvLCBudWxsKSk7XG5cblNUQVRFTUVOVFMuYWRkKFNleHBPcGNvZGVzLkRlYnVnZ2VyLCAob3AsIFssIGV2YWxJbmZvXSkgPT5cbiAgb3AoT3AuRGVidWdnZXIsIGV2YWxTeW1ib2xzT3BlcmFuZCgpLCBldmFsSW5mbylcbik7XG5cblNUQVRFTUVOVFMuYWRkKFNleHBPcGNvZGVzLkFwcGVuZCwgKG9wLCBbLCB2YWx1ZV0pID0+IHtcbiAgLy8gU3BlY2lhbCBjYXNlIGZvciBzdGF0aWMgdmFsdWVzXG4gIGlmICghQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICBvcChPcC5UZXh0LCB2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkID8gJycgOiBTdHJpbmcodmFsdWUpKTtcbiAgfSBlbHNlIGlmIChpc0dldEZyZWVPcHRpb25hbENvbXBvbmVudE9ySGVscGVyKHZhbHVlKSkge1xuICAgIG9wKEhpZ2hMZXZlbFJlc29sdXRpb25PcGNvZGUuUmVzb2x2ZU9wdGlvbmFsQ29tcG9uZW50T3JIZWxwZXIsIHZhbHVlLCB7XG4gICAgICBpZkNvbXBvbmVudChjb21wb25lbnQ6IENvbXBpbGVUaW1lQ29tcG9uZW50KSB7XG4gICAgICAgIEludm9rZUNvbXBvbmVudChvcCwgY29tcG9uZW50LCBudWxsLCBudWxsLCBudWxsLCBudWxsKTtcbiAgICAgIH0sXG5cbiAgICAgIGlmSGVscGVyKGhhbmRsZTogbnVtYmVyKSB7XG4gICAgICAgIG9wKE1hY2hpbmVPcC5QdXNoRnJhbWUpO1xuICAgICAgICBDYWxsKG9wLCBoYW5kbGUsIG51bGwsIG51bGwpO1xuICAgICAgICBvcChNYWNoaW5lT3AuSW52b2tlU3RhdGljLCBzdGRsaWJPcGVyYW5kKCdjYXV0aW91cy1ub24tZHluYW1pYy1hcHBlbmQnKSk7XG4gICAgICAgIG9wKE1hY2hpbmVPcC5Qb3BGcmFtZSk7XG4gICAgICB9LFxuXG4gICAgICBpZlZhbHVlKGhhbmRsZTogbnVtYmVyKSB7XG4gICAgICAgIG9wKE1hY2hpbmVPcC5QdXNoRnJhbWUpO1xuICAgICAgICBvcChPcC5Db25zdGFudFJlZmVyZW5jZSwgaGFuZGxlKTtcbiAgICAgICAgb3AoTWFjaGluZU9wLkludm9rZVN0YXRpYywgc3RkbGliT3BlcmFuZCgnY2F1dGlvdXMtbm9uLWR5bmFtaWMtYXBwZW5kJykpO1xuICAgICAgICBvcChNYWNoaW5lT3AuUG9wRnJhbWUpO1xuICAgICAgfSxcbiAgICB9KTtcbiAgfSBlbHNlIGlmICh2YWx1ZVswXSA9PT0gU2V4cE9wY29kZXMuQ2FsbCkge1xuICAgIGxldCBbLCBleHByZXNzaW9uLCBwb3NpdGlvbmFsLCBuYW1lZF0gPSB2YWx1ZTtcblxuICAgIGlmIChpc0dldEZyZWVDb21wb25lbnRPckhlbHBlcihleHByZXNzaW9uKSkge1xuICAgICAgb3AoSGlnaExldmVsUmVzb2x1dGlvbk9wY29kZS5SZXNvbHZlQ29tcG9uZW50T3JIZWxwZXIsIGV4cHJlc3Npb24sIHtcbiAgICAgICAgaWZDb21wb25lbnQoY29tcG9uZW50OiBDb21waWxlVGltZUNvbXBvbmVudCkge1xuICAgICAgICAgIEludm9rZUNvbXBvbmVudChvcCwgY29tcG9uZW50LCBudWxsLCBwb3NpdGlvbmFsLCBoYXNoVG9BcmdzKG5hbWVkKSwgbnVsbCk7XG4gICAgICAgIH0sXG4gICAgICAgIGlmSGVscGVyKGhhbmRsZTogbnVtYmVyKSB7XG4gICAgICAgICAgb3AoTWFjaGluZU9wLlB1c2hGcmFtZSk7XG4gICAgICAgICAgQ2FsbChvcCwgaGFuZGxlLCBwb3NpdGlvbmFsLCBuYW1lZCk7XG4gICAgICAgICAgb3AoTWFjaGluZU9wLkludm9rZVN0YXRpYywgc3RkbGliT3BlcmFuZCgnY2F1dGlvdXMtbm9uLWR5bmFtaWMtYXBwZW5kJykpO1xuICAgICAgICAgIG9wKE1hY2hpbmVPcC5Qb3BGcmFtZSk7XG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgU3dpdGNoQ2FzZXMoXG4gICAgICAgIG9wLFxuICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgZXhwcihvcCwgZXhwcmVzc2lvbik7XG4gICAgICAgICAgb3AoT3AuRHluYW1pY0NvbnRlbnRUeXBlKTtcbiAgICAgICAgfSxcbiAgICAgICAgKHdoZW4pID0+IHtcbiAgICAgICAgICB3aGVuKENvbnRlbnRUeXBlLkNvbXBvbmVudCwgKCkgPT4ge1xuICAgICAgICAgICAgb3AoT3AuUmVzb2x2ZUN1cnJpZWRDb21wb25lbnQpO1xuICAgICAgICAgICAgb3AoT3AuUHVzaER5bmFtaWNDb21wb25lbnRJbnN0YW5jZSk7XG4gICAgICAgICAgICBJbnZva2VOb25TdGF0aWNDb21wb25lbnQob3AsIHtcbiAgICAgICAgICAgICAgY2FwYWJpbGl0aWVzOiB0cnVlLFxuICAgICAgICAgICAgICBlbGVtZW50QmxvY2s6IG51bGwsXG4gICAgICAgICAgICAgIHBvc2l0aW9uYWwsXG4gICAgICAgICAgICAgIG5hbWVkLFxuICAgICAgICAgICAgICBhdE5hbWVzOiBmYWxzZSxcbiAgICAgICAgICAgICAgYmxvY2tzOiBuYW1lZEJsb2NrcyhudWxsKSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgd2hlbihDb250ZW50VHlwZS5IZWxwZXIsICgpID0+IHtcbiAgICAgICAgICAgIENhbGxEeW5hbWljKG9wLCBwb3NpdGlvbmFsLCBuYW1lZCwgKCkgPT4ge1xuICAgICAgICAgICAgICBvcChNYWNoaW5lT3AuSW52b2tlU3RhdGljLCBzdGRsaWJPcGVyYW5kKCdjYXV0aW91cy1ub24tZHluYW1pYy1hcHBlbmQnKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgb3AoTWFjaGluZU9wLlB1c2hGcmFtZSk7XG4gICAgZXhwcihvcCwgdmFsdWUpO1xuICAgIG9wKE1hY2hpbmVPcC5JbnZva2VTdGF0aWMsIHN0ZGxpYk9wZXJhbmQoJ2NhdXRpb3VzLWFwcGVuZCcpKTtcbiAgICBvcChNYWNoaW5lT3AuUG9wRnJhbWUpO1xuICB9XG59KTtcblxuU1RBVEVNRU5UUy5hZGQoU2V4cE9wY29kZXMuVHJ1c3RpbmdBcHBlbmQsIChvcCwgWywgdmFsdWVdKSA9PiB7XG4gIGlmICghQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICBvcChPcC5UZXh0LCB2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkID8gJycgOiBTdHJpbmcodmFsdWUpKTtcbiAgfSBlbHNlIHtcbiAgICBvcChNYWNoaW5lT3AuUHVzaEZyYW1lKTtcbiAgICBleHByKG9wLCB2YWx1ZSk7XG4gICAgb3AoTWFjaGluZU9wLkludm9rZVN0YXRpYywgc3RkbGliT3BlcmFuZCgndHJ1c3RpbmctYXBwZW5kJykpO1xuICAgIG9wKE1hY2hpbmVPcC5Qb3BGcmFtZSk7XG4gIH1cbn0pO1xuXG5TVEFURU1FTlRTLmFkZChTZXhwT3Bjb2Rlcy5CbG9jaywgKG9wLCBbLCBleHByLCBwb3NpdGlvbmFsLCBuYW1lZCwgYmxvY2tzXSkgPT4ge1xuICBpZiAoaXNHZXRGcmVlQ29tcG9uZW50KGV4cHIpKSB7XG4gICAgb3AoSGlnaExldmVsUmVzb2x1dGlvbk9wY29kZS5SZXNvbHZlQ29tcG9uZW50LCBleHByLCAoY29tcG9uZW50OiBDb21waWxlVGltZUNvbXBvbmVudCkgPT4ge1xuICAgICAgSW52b2tlQ29tcG9uZW50KG9wLCBjb21wb25lbnQsIG51bGwsIHBvc2l0aW9uYWwsIGhhc2hUb0FyZ3MobmFtZWQpLCBibG9ja3MpO1xuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIEludm9rZUR5bmFtaWNDb21wb25lbnQob3AsIGV4cHIsIG51bGwsIHBvc2l0aW9uYWwsIG5hbWVkLCBibG9ja3MsIGZhbHNlLCBmYWxzZSk7XG4gIH1cbn0pO1xuXG5TVEFURU1FTlRTLmFkZChTZXhwT3Bjb2Rlcy5JbkVsZW1lbnQsIChvcCwgWywgYmxvY2ssIGd1aWQsIGRlc3RpbmF0aW9uLCBpbnNlcnRCZWZvcmVdKSA9PiB7XG4gIFJlcGxheWFibGVJZihcbiAgICBvcCxcblxuICAgICgpID0+IHtcbiAgICAgIGV4cHIob3AsIGd1aWQpO1xuXG4gICAgICBpZiAoaW5zZXJ0QmVmb3JlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgUHVzaFByaW1pdGl2ZVJlZmVyZW5jZShvcCwgdW5kZWZpbmVkKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGV4cHIob3AsIGluc2VydEJlZm9yZSk7XG4gICAgICB9XG5cbiAgICAgIGV4cHIob3AsIGRlc3RpbmF0aW9uKTtcbiAgICAgIG9wKE9wLkR1cCwgJHNwLCAwKTtcblxuICAgICAgcmV0dXJuIDQ7XG4gICAgfSxcblxuICAgICgpID0+IHtcbiAgICAgIG9wKE9wLlB1c2hSZW1vdGVFbGVtZW50KTtcbiAgICAgIEludm9rZVN0YXRpY0Jsb2NrKG9wLCBibG9jayk7XG4gICAgICBvcChPcC5Qb3BSZW1vdGVFbGVtZW50KTtcbiAgICB9XG4gICk7XG59KTtcblxuU1RBVEVNRU5UUy5hZGQoU2V4cE9wY29kZXMuSWYsIChvcCwgWywgY29uZGl0aW9uLCBibG9jaywgaW52ZXJzZV0pID0+XG4gIFJlcGxheWFibGVJZihcbiAgICBvcCxcbiAgICAoKSA9PiB7XG4gICAgICBleHByKG9wLCBjb25kaXRpb24pO1xuICAgICAgb3AoT3AuVG9Cb29sZWFuKTtcblxuICAgICAgcmV0dXJuIDE7XG4gICAgfSxcblxuICAgICgpID0+IHtcbiAgICAgIEludm9rZVN0YXRpY0Jsb2NrKG9wLCBibG9jayk7XG4gICAgfSxcblxuICAgIGludmVyc2VcbiAgICAgID8gKCkgPT4ge1xuICAgICAgICAgIEludm9rZVN0YXRpY0Jsb2NrKG9wLCBpbnZlcnNlKTtcbiAgICAgICAgfVxuICAgICAgOiB1bmRlZmluZWRcbiAgKVxuKTtcblxuU1RBVEVNRU5UUy5hZGQoU2V4cE9wY29kZXMuRWFjaCwgKG9wLCBbLCB2YWx1ZSwga2V5LCBibG9jaywgaW52ZXJzZV0pID0+XG4gIFJlcGxheWFibGUoXG4gICAgb3AsXG5cbiAgICAoKSA9PiB7XG4gICAgICBpZiAoa2V5KSB7XG4gICAgICAgIGV4cHIob3AsIGtleSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBQdXNoUHJpbWl0aXZlUmVmZXJlbmNlKG9wLCBudWxsKTtcbiAgICAgIH1cblxuICAgICAgZXhwcihvcCwgdmFsdWUpO1xuXG4gICAgICByZXR1cm4gMjtcbiAgICB9LFxuXG4gICAgKCkgPT4ge1xuICAgICAgb3AoT3AuRW50ZXJMaXN0LCBsYWJlbE9wZXJhbmQoJ0JPRFknKSwgbGFiZWxPcGVyYW5kKCdFTFNFJykpO1xuICAgICAgb3AoTWFjaGluZU9wLlB1c2hGcmFtZSk7XG4gICAgICBvcChPcC5EdXAsICRmcCwgMSk7XG4gICAgICBvcChNYWNoaW5lT3AuUmV0dXJuVG8sIGxhYmVsT3BlcmFuZCgnSVRFUicpKTtcbiAgICAgIG9wKEhpZ2hMZXZlbEJ1aWxkZXJPcGNvZGUuTGFiZWwsICdJVEVSJyk7XG4gICAgICBvcChPcC5JdGVyYXRlLCBsYWJlbE9wZXJhbmQoJ0JSRUFLJykpO1xuICAgICAgb3AoSGlnaExldmVsQnVpbGRlck9wY29kZS5MYWJlbCwgJ0JPRFknKTtcbiAgICAgIEludm9rZVN0YXRpY0Jsb2NrV2l0aFN0YWNrKG9wLCBibG9jaywgMik7XG4gICAgICBvcChPcC5Qb3AsIDIpO1xuICAgICAgb3AoTWFjaGluZU9wLkp1bXAsIGxhYmVsT3BlcmFuZCgnRklOQUxMWScpKTtcbiAgICAgIG9wKEhpZ2hMZXZlbEJ1aWxkZXJPcGNvZGUuTGFiZWwsICdCUkVBSycpO1xuICAgICAgb3AoTWFjaGluZU9wLlBvcEZyYW1lKTtcbiAgICAgIG9wKE9wLkV4aXRMaXN0KTtcbiAgICAgIG9wKE1hY2hpbmVPcC5KdW1wLCBsYWJlbE9wZXJhbmQoJ0ZJTkFMTFknKSk7XG4gICAgICBvcChIaWdoTGV2ZWxCdWlsZGVyT3Bjb2RlLkxhYmVsLCAnRUxTRScpO1xuXG4gICAgICBpZiAoaW52ZXJzZSkge1xuICAgICAgICBJbnZva2VTdGF0aWNCbG9jayhvcCwgaW52ZXJzZSk7XG4gICAgICB9XG4gICAgfVxuICApXG4pO1xuXG5TVEFURU1FTlRTLmFkZChTZXhwT3Bjb2Rlcy5XaXRoLCAob3AsIFssIHZhbHVlLCBibG9jaywgaW52ZXJzZV0pID0+IHtcbiAgUmVwbGF5YWJsZUlmKFxuICAgIG9wLFxuXG4gICAgKCkgPT4ge1xuICAgICAgZXhwcihvcCwgdmFsdWUpO1xuICAgICAgb3AoT3AuRHVwLCAkc3AsIDApO1xuICAgICAgb3AoT3AuVG9Cb29sZWFuKTtcblxuICAgICAgcmV0dXJuIDI7XG4gICAgfSxcblxuICAgICgpID0+IHtcbiAgICAgIEludm9rZVN0YXRpY0Jsb2NrV2l0aFN0YWNrKG9wLCBibG9jaywgMSk7XG4gICAgfSxcblxuICAgICgpID0+IHtcbiAgICAgIGlmIChpbnZlcnNlKSB7XG4gICAgICAgIEludm9rZVN0YXRpY0Jsb2NrKG9wLCBpbnZlcnNlKTtcbiAgICAgIH1cbiAgICB9XG4gICk7XG59KTtcblxuU1RBVEVNRU5UUy5hZGQoU2V4cE9wY29kZXMuTGV0LCAob3AsIFssIHBvc2l0aW9uYWwsIGJsb2NrXSkgPT4ge1xuICBsZXQgY291bnQgPSBDb21waWxlUG9zaXRpb25hbChvcCwgcG9zaXRpb25hbCk7XG4gIEludm9rZVN0YXRpY0Jsb2NrV2l0aFN0YWNrKG9wLCBibG9jaywgY291bnQpO1xufSk7XG5cblNUQVRFTUVOVFMuYWRkKFNleHBPcGNvZGVzLldpdGhEeW5hbWljVmFycywgKG9wLCBbLCBuYW1lZCwgYmxvY2tdKSA9PiB7XG4gIGlmIChuYW1lZCkge1xuICAgIGxldCBbbmFtZXMsIGV4cHJlc3Npb25zXSA9IG5hbWVkO1xuXG4gICAgQ29tcGlsZVBvc2l0aW9uYWwob3AsIGV4cHJlc3Npb25zKTtcbiAgICBEeW5hbWljU2NvcGUob3AsIG5hbWVzLCAoKSA9PiB7XG4gICAgICBJbnZva2VTdGF0aWNCbG9jayhvcCwgYmxvY2spO1xuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIEludm9rZVN0YXRpY0Jsb2NrKG9wLCBibG9jayk7XG4gIH1cbn0pO1xuXG5TVEFURU1FTlRTLmFkZChTZXhwT3Bjb2Rlcy5JbnZva2VDb21wb25lbnQsIChvcCwgWywgZXhwciwgcG9zaXRpb25hbCwgbmFtZWQsIGJsb2Nrc10pID0+IHtcbiAgaWYgKGlzR2V0RnJlZUNvbXBvbmVudChleHByKSkge1xuICAgIG9wKEhpZ2hMZXZlbFJlc29sdXRpb25PcGNvZGUuUmVzb2x2ZUNvbXBvbmVudCwgZXhwciwgKGNvbXBvbmVudDogQ29tcGlsZVRpbWVDb21wb25lbnQpID0+IHtcbiAgICAgIEludm9rZUNvbXBvbmVudChvcCwgY29tcG9uZW50LCBudWxsLCBwb3NpdGlvbmFsLCBoYXNoVG9BcmdzKG5hbWVkKSwgYmxvY2tzKTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBJbnZva2VEeW5hbWljQ29tcG9uZW50KG9wLCBleHByLCBudWxsLCBwb3NpdGlvbmFsLCBuYW1lZCwgYmxvY2tzLCBmYWxzZSwgZmFsc2UpO1xuICB9XG59KTtcblxuZnVuY3Rpb24gaGFzaFRvQXJncyhoYXNoOiBXaXJlRm9ybWF0LkNvcmUuSGFzaCB8IG51bGwpOiBXaXJlRm9ybWF0LkNvcmUuSGFzaCB8IG51bGwge1xuICBpZiAoaGFzaCA9PT0gbnVsbCkgcmV0dXJuIG51bGw7XG4gIGxldCBuYW1lcyA9IGhhc2hbMF0ubWFwKChrZXkpID0+IGBAJHtrZXl9YCk7XG4gIHJldHVybiBbbmFtZXMgYXMgW3N0cmluZywgLi4uc3RyaW5nW11dLCBoYXNoWzFdXTtcbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=