import { $fp, $sp } from '@glimmer/vm';
import { InvokeStaticBlock, InvokeStaticBlockWithStack, YieldBlock } from '../opcode-builder/helpers/blocks';
import { InvokeComponent, InvokeDynamicComponent, InvokeNonStaticComponent } from '../opcode-builder/helpers/components';
import { SwitchCases, Replayable, ReplayableIf } from '../opcode-builder/helpers/conditional';
import { expr } from '../opcode-builder/helpers/expr';
import { CompilePositional, SimpleArgs } from '../opcode-builder/helpers/shared';
import { Call, CallDynamic, DynamicScope, PushPrimitiveReference } from '../opcode-builder/helpers/vm';
import { evalSymbolsOperand, labelOperand, stdlibOperand } from '../opcode-builder/operands';
import { Compilers } from './compilers';
import { isGetFreeComponent, isGetFreeComponentOrHelper, isGetFreeModifier, isGetFreeOptionalComponentOrHelper } from '../opcode-builder/helpers/resolution';
import { namedBlocks } from '../utils';
export const STATEMENTS = new Compilers();
const INFLATE_ATTR_TABLE = ['class', 'id', 'value', 'name', 'type', 'style', 'href'];
const INFLATE_TAG_TABLE = ['div', 'span', 'p', 'a'];
export function inflateTagName(tagName) {
  return typeof tagName === 'string' ? tagName : INFLATE_TAG_TABLE[tagName];
}
export function inflateAttrName(attrName) {
  return typeof attrName === 'string' ? attrName : INFLATE_ATTR_TABLE[attrName];
}
STATEMENTS.add(3
/* Comment */
, (op, sexp) => op(42
/* Comment */
, sexp[1]));
STATEMENTS.add(13
/* CloseElement */
, op => op(55
/* CloseElement */
));
STATEMENTS.add(12
/* FlushElement */
, op => op(54
/* FlushElement */
));
STATEMENTS.add(4
/* Modifier */
, (op, [, expression, positional, named]) => {
  if (isGetFreeModifier(expression)) {
    op(1003
    /* ResolveModifier */
    , expression, handle => {
      op(0
      /* PushFrame */
      );
      SimpleArgs(op, positional, named, false);
      op(57
      /* Modifier */
      , handle);
      op(1
      /* PopFrame */
      );
    });
  } else {
    expr(op, expression);
    op(0
    /* PushFrame */
    );
    SimpleArgs(op, positional, named, false);
    op(33
    /* Dup */
    , $fp, 1);
    op(108
    /* DynamicModifier */
    );
    op(1
    /* PopFrame */
    );
  }
});
STATEMENTS.add(14
/* StaticAttr */
, (op, [, name, value, namespace]) => {
  op(51
  /* StaticAttr */
  , inflateAttrName(name), value, namespace !== null && namespace !== void 0 ? namespace : null);
});
STATEMENTS.add(24
/* StaticComponentAttr */
, (op, [, name, value, namespace]) => {
  op(105
  /* StaticComponentAttr */
  , inflateAttrName(name), value, namespace !== null && namespace !== void 0 ? namespace : null);
});
STATEMENTS.add(15
/* DynamicAttr */
, (op, [, name, value, namespace]) => {
  expr(op, value);
  op(52
  /* DynamicAttr */
  , inflateAttrName(name), false, namespace !== null && namespace !== void 0 ? namespace : null);
});
STATEMENTS.add(22
/* TrustingDynamicAttr */
, (op, [, name, value, namespace]) => {
  expr(op, value);
  op(52
  /* DynamicAttr */
  , inflateAttrName(name), true, namespace !== null && namespace !== void 0 ? namespace : null);
});
STATEMENTS.add(16
/* ComponentAttr */
, (op, [, name, value, namespace]) => {
  expr(op, value);
  op(53
  /* ComponentAttr */
  , inflateAttrName(name), false, namespace !== null && namespace !== void 0 ? namespace : null);
});
STATEMENTS.add(23
/* TrustingComponentAttr */
, (op, [, name, value, namespace]) => {
  expr(op, value);
  op(53
  /* ComponentAttr */
  , inflateAttrName(name), true, namespace !== null && namespace !== void 0 ? namespace : null);
});
STATEMENTS.add(10
/* OpenElement */
, (op, [, tag]) => {
  op(48
  /* OpenElement */
  , inflateTagName(tag));
});
STATEMENTS.add(11
/* OpenElementWithSplat */
, (op, [, tag]) => {
  op(89
  /* PutComponentOperations */
  );
  op(48
  /* OpenElement */
  , inflateTagName(tag));
});
STATEMENTS.add(8
/* Component */
, (op, [, expr, elementBlock, named, blocks]) => {
  if (isGetFreeComponent(expr)) {
    op(1004
    /* ResolveComponent */
    , expr, component => {
      InvokeComponent(op, component, elementBlock, null, named, blocks);
    });
  } else {
    // otherwise, the component name was an expression, so resolve the expression
    // and invoke it as a dynamic component
    InvokeDynamicComponent(op, expr, elementBlock, null, named, blocks, true, true);
  }
});
STATEMENTS.add(18
/* Yield */
, (op, [, to, params]) => YieldBlock(op, to, params));
STATEMENTS.add(17
/* AttrSplat */
, (op, [, to]) => YieldBlock(op, to, null));
STATEMENTS.add(26
/* Debugger */
, (op, [, evalInfo]) => op(103
/* Debugger */
, evalSymbolsOperand(), evalInfo));
STATEMENTS.add(1
/* Append */
, (op, [, value]) => {
  // Special case for static values
  if (!Array.isArray(value)) {
    op(41
    /* Text */
    , value === null || value === undefined ? '' : String(value));
  } else if (isGetFreeOptionalComponentOrHelper(value)) {
    op(1008
    /* ResolveOptionalComponentOrHelper */
    , value, {
      ifComponent(component) {
        InvokeComponent(op, component, null, null, null, null);
      },

      ifHelper(handle) {
        op(0
        /* PushFrame */
        );
        Call(op, handle, null, null);
        op(3
        /* InvokeStatic */
        , stdlibOperand('cautious-non-dynamic-append'));
        op(1
        /* PopFrame */
        );
      },

      ifValue(handle) {
        op(0
        /* PushFrame */
        );
        op(29
        /* ConstantReference */
        , handle);
        op(3
        /* InvokeStatic */
        , stdlibOperand('cautious-non-dynamic-append'));
        op(1
        /* PopFrame */
        );
      }

    });
  } else if (value[0] === 28
  /* Call */
  ) {
      let [, expression, positional, named] = value;

      if (isGetFreeComponentOrHelper(expression)) {
        op(1007
        /* ResolveComponentOrHelper */
        , expression, {
          ifComponent(component) {
            InvokeComponent(op, component, null, positional, hashToArgs(named), null);
          },

          ifHelper(handle) {
            op(0
            /* PushFrame */
            );
            Call(op, handle, positional, named);
            op(3
            /* InvokeStatic */
            , stdlibOperand('cautious-non-dynamic-append'));
            op(1
            /* PopFrame */
            );
          }

        });
      } else {
        SwitchCases(op, () => {
          expr(op, expression);
          op(106
          /* DynamicContentType */
          );
        }, when => {
          when(0
          /* Component */
          , () => {
            op(81
            /* ResolveCurriedComponent */
            );
            op(79
            /* PushDynamicComponentInstance */
            );
            InvokeNonStaticComponent(op, {
              capabilities: true,
              elementBlock: null,
              positional,
              named,
              atNames: false,
              blocks: namedBlocks(null)
            });
          });
          when(1
          /* Helper */
          , () => {
            CallDynamic(op, positional, named, () => {
              op(3
              /* InvokeStatic */
              , stdlibOperand('cautious-non-dynamic-append'));
            });
          });
        });
      }
    } else {
    op(0
    /* PushFrame */
    );
    expr(op, value);
    op(3
    /* InvokeStatic */
    , stdlibOperand('cautious-append'));
    op(1
    /* PopFrame */
    );
  }
});
STATEMENTS.add(2
/* TrustingAppend */
, (op, [, value]) => {
  if (!Array.isArray(value)) {
    op(41
    /* Text */
    , value === null || value === undefined ? '' : String(value));
  } else {
    op(0
    /* PushFrame */
    );
    expr(op, value);
    op(3
    /* InvokeStatic */
    , stdlibOperand('trusting-append'));
    op(1
    /* PopFrame */
    );
  }
});
STATEMENTS.add(6
/* Block */
, (op, [, expr, positional, named, blocks]) => {
  if (isGetFreeComponent(expr)) {
    op(1004
    /* ResolveComponent */
    , expr, component => {
      InvokeComponent(op, component, null, positional, hashToArgs(named), blocks);
    });
  } else {
    InvokeDynamicComponent(op, expr, null, positional, named, blocks, false, false);
  }
});
STATEMENTS.add(40
/* InElement */
, (op, [, block, guid, destination, insertBefore]) => {
  ReplayableIf(op, () => {
    expr(op, guid);

    if (insertBefore === undefined) {
      PushPrimitiveReference(op, undefined);
    } else {
      expr(op, insertBefore);
    }

    expr(op, destination);
    op(33
    /* Dup */
    , $sp, 0);
    return 4;
  }, () => {
    op(50
    /* PushRemoteElement */
    );
    InvokeStaticBlock(op, block);
    op(56
    /* PopRemoteElement */
    );
  });
});
STATEMENTS.add(41
/* If */
, (op, [, condition, block, inverse]) => ReplayableIf(op, () => {
  expr(op, condition);
  op(71
  /* ToBoolean */
  );
  return 1;
}, () => {
  InvokeStaticBlock(op, block);
}, inverse ? () => {
  InvokeStaticBlock(op, inverse);
} : undefined));
STATEMENTS.add(42
/* Each */
, (op, [, value, key, block, inverse]) => Replayable(op, () => {
  if (key) {
    expr(op, key);
  } else {
    PushPrimitiveReference(op, null);
  }

  expr(op, value);
  return 2;
}, () => {
  op(72
  /* EnterList */
  , labelOperand('BODY'), labelOperand('ELSE'));
  op(0
  /* PushFrame */
  );
  op(33
  /* Dup */
  , $fp, 1);
  op(6
  /* ReturnTo */
  , labelOperand('ITER'));
  op(1000
  /* Label */
  , 'ITER');
  op(74
  /* Iterate */
  , labelOperand('BREAK'));
  op(1000
  /* Label */
  , 'BODY');
  InvokeStaticBlockWithStack(op, block, 2);
  op(34
  /* Pop */
  , 2);
  op(4
  /* Jump */
  , labelOperand('FINALLY'));
  op(1000
  /* Label */
  , 'BREAK');
  op(1
  /* PopFrame */
  );
  op(73
  /* ExitList */
  );
  op(4
  /* Jump */
  , labelOperand('FINALLY'));
  op(1000
  /* Label */
  , 'ELSE');

  if (inverse) {
    InvokeStaticBlock(op, inverse);
  }
}));
STATEMENTS.add(43
/* With */
, (op, [, value, block, inverse]) => {
  ReplayableIf(op, () => {
    expr(op, value);
    op(33
    /* Dup */
    , $sp, 0);
    op(71
    /* ToBoolean */
    );
    return 2;
  }, () => {
    InvokeStaticBlockWithStack(op, block, 1);
  }, () => {
    if (inverse) {
      InvokeStaticBlock(op, inverse);
    }
  });
});
STATEMENTS.add(44
/* Let */
, (op, [, positional, block]) => {
  let count = CompilePositional(op, positional);
  InvokeStaticBlockWithStack(op, block, count);
});
STATEMENTS.add(45
/* WithDynamicVars */
, (op, [, named, block]) => {
  if (named) {
    let [names, expressions] = named;
    CompilePositional(op, expressions);
    DynamicScope(op, names, () => {
      InvokeStaticBlock(op, block);
    });
  } else {
    InvokeStaticBlock(op, block);
  }
});
STATEMENTS.add(46
/* InvokeComponent */
, (op, [, expr, positional, named, blocks]) => {
  if (isGetFreeComponent(expr)) {
    op(1004
    /* ResolveComponent */
    , expr, component => {
      InvokeComponent(op, component, null, positional, hashToArgs(named), blocks);
    });
  } else {
    InvokeDynamicComponent(op, expr, null, positional, named, blocks, false, false);
  }
});

function hashToArgs(hash) {
  if (hash === null) return null;
  let names = hash[0].map(key => `@${key}`);
  return [names, hash[1]];
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL29wY29kZS1jb21waWxlci9saWIvc3ludGF4L3N0YXRlbWVudHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBYUEsU0FBUyxHQUFULEVBQWMsR0FBZCxRQUF5QixhQUF6QjtBQUNBLFNBQ0UsaUJBREYsRUFFRSwwQkFGRixFQUdFLFVBSEYsUUFJTyxrQ0FKUDtBQUtBLFNBQ0UsZUFERixFQUVFLHNCQUZGLEVBR0Usd0JBSEYsUUFJTyxzQ0FKUDtBQUtBLFNBQVMsV0FBVCxFQUFzQixVQUF0QixFQUFrQyxZQUFsQyxRQUFzRCx1Q0FBdEQ7QUFDQSxTQUFTLElBQVQsUUFBcUIsZ0NBQXJCO0FBQ0EsU0FBUyxpQkFBVCxFQUE0QixVQUE1QixRQUE4QyxrQ0FBOUM7QUFDQSxTQUNFLElBREYsRUFFRSxXQUZGLEVBR0UsWUFIRixFQUlFLHNCQUpGLFFBS08sOEJBTFA7QUFNQSxTQUFTLGtCQUFULEVBQTZCLFlBQTdCLEVBQTJDLGFBQTNDLFFBQWdFLDRCQUFoRTtBQUNBLFNBQVMsU0FBVCxRQUEyQyxhQUEzQztBQUNBLFNBQ0Usa0JBREYsRUFFRSwwQkFGRixFQUdFLGlCQUhGLEVBSUUsa0NBSkYsUUFLTyxzQ0FMUDtBQU1BLFNBQVMsV0FBVCxRQUE0QixVQUE1QjtBQUVBLE9BQU8sTUFBTSxVQUFVLEdBQUcsSUFBSSxTQUFKLEVBQW5CO0FBRVAsTUFBTSxrQkFBa0IsR0FFcEIsQ0FBQyxPQUFELEVBQVUsSUFBVixFQUFnQixPQUFoQixFQUF5QixNQUF6QixFQUFpQyxNQUFqQyxFQUF5QyxPQUF6QyxFQUFrRCxNQUFsRCxDQUZKO0FBR0EsTUFBTSxpQkFBaUIsR0FFbkIsQ0FBQyxLQUFELEVBQVEsTUFBUixFQUFnQixHQUFoQixFQUFxQixHQUFyQixDQUZKO0FBSUEsT0FBTSxTQUFVLGNBQVYsQ0FBeUIsT0FBekIsRUFBMkQ7QUFDL0QsU0FBTyxPQUFPLE9BQVAsS0FBbUIsUUFBbkIsR0FBOEIs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LEVBQUQsRUFBSyxTQUFMLEVBQWdCLElBQWhCLEVBQXNCLFVBQXRCLEVBQWtDLFVBQVUsQ0FBQyxLQUFELENBQTVDLEVBQXFELE1BQXJELENBQWY7QUFDRCxLQUZDLENBQUY7QUFHRCxHQUpELE1BSU87QUFDTCxJQUFBLHNCQUFzQixDQUFDLEVBQUQsRUFBSyxJQUFMLEVBQVcsSUFBWCxFQUFpQixVQUFqQixFQUE2QixLQUE3QixFQUFvQyxNQUFwQyxFQUE0QyxLQUE1QyxFQUFtRCxLQUFuRCxDQUF0QjtBQUNEO0FBQ0YsQ0FSRDs7QUFVQSxTQUFTLFVBQVQsQ0FBb0IsSUFBcEIsRUFBcUQ7QUFDbkQsTUFBSSxJQUFJLEtBQUssSUFBYixFQUFtQixPQUFPLElBQVA7QUFDbkIsTUFBSSxLQUFLLEdBQUcsSUFBSSxDQUFDLENBQUQsQ0FBSixDQUFRLEdBQVIsQ0FBYSxHQUFELElBQVMsSUFBSSxHQUFHLEVBQTVCLENBQVo7QUFDQSxTQUFPLENBQUMsS0FBRCxFQUFpQyxJQUFJLENBQUMsQ0FBRCxDQUFyQyxDQUFQO0FBQ0QiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBDb21waWxlVGltZUNvbXBvbmVudCxcbiAgQ29udGVudFR5cGUsXG4gIEhpZ2hMZXZlbEJ1aWxkZXJPcGNvZGUsXG4gIEhpZ2hMZXZlbFJlc29sdXRpb25PcGNvZGUsXG4gIE1hY2hpbmVPcCxcbiAgT3AsXG4gIFNleHBPcGNvZGVzLFxuICBTdGF0ZW1lbnRTZXhwT3Bjb2RlLFxuICBXZWxsS25vd25BdHRyTmFtZSxcbiAgV2VsbEtub3duVGFnTmFtZSxcbiAgV2lyZUZvcm1hdCxcbn0gZnJvbSAnQGdsaW1tZXIvaW50ZXJmYWNlcyc7XG5pbXBvcnQgeyAkZnAsICRzcCB9IGZyb20gJ0BnbGltbWVyL3ZtJztcbmltcG9ydCB7XG4gIEludm9rZVN0YXRpY0Jsb2NrLFxuICBJbnZva2VTdGF0aWNCbG9ja1dpdGhTdGFjayxcbiAgWWllbGRCbG9jayxcbn0gZnJvbSAnLi4vb3Bjb2RlLWJ1aWxkZXIvaGVscGVycy9ibG9ja3MnO1xuaW1wb3J0IHtcbiAgSW52b2tlQ29tcG9uZW50LFxuICBJbnZva2VEeW5hbWljQ29tcG9uZW50LFxuICBJbnZva2VOb25TdGF0aWNDb21wb25lbnQsXG59IGZyb20gJy4uL29wY29kZS1idWlsZGVyL2hlbHBlcnMvY29tcG9uZW50cyc7XG5pbXBvcnQgeyBTd2l0Y2hDYXNlcywgUmVwbGF5YWJsZSwgUmVwbGF5YWJsZUlmIH0gZnJvbSAnLi4vb3Bjb2RlLWJ1aWxkZXIvaGVscGVycy9jb25kaXRpb25hbCc7XG5pbXBvcnQgeyBleHByIH0gZnJvbSAnLi4vb3Bjb2RlLWJ1aWxkZXIvaGVscGVycy9leHByJztcbmltcG9ydCB7IENvbXBpbGVQb3NpdGlvbmFsLCBTaW1wbGVBcmdzIH0gZnJvbSAnLi4vb3Bjb2RlLWJ1aWxkZXIvaGVscGVycy9zaGFyZWQnO1xuaW1wb3J0IHtcbiAgQ2FsbCxcbiAgQ2FsbER5bmFtaWMsXG4gIER5bmFtaWNTY29wZSxcbiAgUHVzaFByaW1pdGl2ZVJlZmVyZW5jZSxcbn0gZnJvbSAnLi4vb3Bjb2RlLWJ1aWxkZXIvaGVscGVycy92bSc7XG5pbXBvcnQgeyBldmFsU3ltYm9sc09wZXJhbmQsIGxhYmVsT3BlcmFuZCwgc3RkbGliT3BlcmFuZCB9IGZyb20gJy4uL29wY29kZS1idWlsZGVyL29wZXJhbmRzJztcbmltcG9ydCB7IENvbXBpbGVycywgUHVzaFN0YXRlbWVudE9wIH0gZnJvbSAnLi9jb21waWxlcnMnO1xuaW1wb3J0IHtcbiAgaXNHZXRGcmVlQ29tcG9uZW50LFxuICBpc0dldEZyZWVDb21wb25lbnRPckhlbHBlcixcbiAgaXNHZXRGcmVlTW9kaWZpZXIsXG4gIGlzR2V0RnJlZU9wdGlvbmFsQ29tcG9uZW50T3JIZWxwZXIsXG59IGZyb20gJy4uL29wY29kZS1idWlsZGVyL2hlbHBlcnMvcmVzb2x1dGlvbic7XG5pbXBvcnQgeyBuYW1lZEJsb2NrcyB9IGZyb20gJy4uL3V0aWxzJztcblxuZXhwb3J0IGNvbnN0IFNUQVRFTUVOVFMgPSBuZXcgQ29tcGlsZXJzPFB1c2hTdGF0ZW1lbnRPcCwgU3RhdGVtZW50U2V4cE9wY29kZT4oKTtcblxuY29uc3QgSU5GTEFURV9BVFRSX1RBQkxFOiB7XG4gIFtJIGluIFdlbGxLbm93bkF0dHJOYW1lXTogc3RyaW5nO1xufSA9IFsnY2xhc3MnLCAnaWQnLCAndmFsdWUnLCAnbmFtZScsICd0eXBlJywgJ3N0eWxlJywgJ2hyZWYnXTtcbmNvbnN0IElORkxBVEVfVEFHX1RBQkxFOiB7XG4gIFtJIGluIFdlbGxLbm93blRhZ05hbWVdOiBzdHJpbmc7XG59ID0gWydkaXYnLCAnc3BhbicsICdwJywgJ2EnXTtcblxuZXhwb3J0IGZ1bmN0aW9uIGluZmxhdGVUYWdOYW1lKHRhZ05hbWU6IHN0cmluZyB8IFdlbGxLbm93blRhZ05hbWUpOiBzdHJpbmcge1xuICByZXR1cm4gdHlwZW9mIHRhZ05hbWUgPT09ICdzdHJpbmcnID8gdGFnTmFtZSA6IElORkxBVEVfVEFHX1RBQkxFW3RhZ05hbWVdO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaW5mbGF0ZUF0dHJOYW1lKGF0dHJOYW1lOiBzdHJpbmcgfCBXZWxsS25vd25BdHRyTmFtZSk6IHN0cmluZyB7XG4gIHJldHVybiB0eXBlb2YgYXR0ck5hbWUgPT09ICdzdHJpbmcnID8gYXR0ck5hbWUgOiBJTkZMQVRFX0FUVFJfVEFCTEVbYXR0ck5hbWVdO1xufVxuXG5TVEFURU1FTlRTLmFkZChTZXhwT3Bjb2Rlcy5Db21tZW50LCAob3AsIHNleHApID0+IG9wKE9wLkNvbW1lbnQsIHNleHBbMV0pKTtcblNUQVRFTUVOVFMuYWRkKFNleHBPcGNvZGVzLkNsb3NlRWxlbWVudCwgKG9wKSA9PiBvcChPcC5DbG9zZUVsZW1lbnQpKTtcblNUQVRFTUVOVFMuYWRkKFNleHBPcGNvZGVzLkZsdXNoRWxlbWVudCwgKG9wKSA9PiBvcChPcC5GbHVzaEVsZW1lbnQpKTtcblxuU1RBVEVNRU5UUy5hZGQoU2V4cE9wY29kZXMuTW9kaWZpZXIsIChvcCwgWywgZXhwcmVzc2lvbiwgcG9zaXRpb25hbCwgbmFtZWRdKSA9PiB7XG4gIGlmIChpc0dldEZyZWVNb2RpZmllcihleHByZXNzaW9uKSkge1xuICAgIG9wKEhpZ2hMZXZlbFJlc29sdXRpb25PcGNvZGUuUmVzb2x2ZU1vZGlmaWVyLCBleHByZXNzaW9uLCAoaGFuZGxlOiBudW1iZXIpID0+IHtcbiAgICAgIG9wKE1hY2hpbmVPcC5QdXNoRnJhbWUpO1xuICAgICAgU2ltcGxlQXJncyhvcCwgcG9zaXRpb25hbCwgbmFtZWQsIGZhbHNlKTtcbiAgICAgIG9wKE9wLk1vZGlmaWVyLCBoYW5kbGUpO1xuICAgICAgb3AoTWFjaGluZU9wLlBvcEZyYW1lKTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBleHByKG9wLCBleHByZXNzaW9uKTtcbiAgICBvcChNYWNoaW5lT3AuUHVzaEZyYW1lKTtcbiAgICBTaW1wbGVBcmdzKG9wLCBwb3NpdGlvbmFsLCBuYW1lZCwgZmFsc2UpO1xuICAgIG9wKE9wLkR1cCwgJGZwLCAxKTtcbiAgICBvcChPcC5EeW5hbWljTW9kaWZpZXIpO1xuICAgIG9wKE1hY2hpbmVPcC5Qb3BGcmFtZSk7XG4gIH1cbn0pO1xuXG5TVEFURU1FTlRTLmFkZChTZXhwT3Bjb2Rlcy5TdGF0aWNBdHRyLCAob3AsIFssIG5hbWUsIHZhbHVlLCBuYW1lc3BhY2VdKSA9PiB7XG4gIG9wKE9wLlN0YXRpY0F0dHIsIGluZmxhdGVBdHRyTmFtZShuYW1lKSwgdmFsdWUgYXMgc3RyaW5nLCBuYW1lc3BhY2UgPz8gbnVsbCk7XG59KTtcblxuU1RBVEVNRU5UUy5hZGQoU2V4cE9wY29kZXMuU3RhdGljQ29tcG9uZW50QXR0ciwgKG9wLCBbLCBuYW1lLCB2YWx1ZSwgbmFtZXNwYWNlXSkgPT4ge1xuICBvcChPcC5TdGF0aWNDb21wb25lbnRBdHRyLCBpbmZsYXRlQXR0ck5hbWUobmFtZSksIHZhbHVlIGFzIHN0cmluZywgbmFtZXNwYWNlID8/IG51bGwpO1xufSk7XG5cblNUQVRFTUVOVFMuYWRkKFNleHBPcGNvZGVzLkR5bmFtaWNBdHRyLCAob3AsIFssIG5hbWUsIHZhbHVlLCBuYW1lc3BhY2VdKSA9PiB7XG4gIGV4cHIob3AsIHZhbHVlKTtcbiAgb3AoT3AuRHluYW1pY0F0dHIsIGluZmxhdGVBdHRyTmFtZShuYW1lKSwgZmFsc2UsIG5hbWVzcGFjZSA/PyBudWxsKTtcbn0pO1xuXG5TVEFURU1FTlRTLmFkZChTZXhwT3Bjb2Rlcy5UcnVzdGluZ0R5bmFtaWNBdHRyLCAob3AsIFssIG5hbWUsIHZhbHVlLCBuYW1lc3BhY2VdKSA9PiB7XG4gIGV4cHIob3AsIHZhbHVlKTtcbiAgb3AoT3AuRHluYW1pY0F0dHIsIGluZmxhdGVBdHRyTmFtZShuYW1lKSwgdHJ1ZSwgbmFtZXNwYWNlID8/IG51bGwpO1xufSk7XG5cblNUQVRFTUVOVFMuYWRkKFNleHBPcGNvZGVzLkNvbXBvbmVudEF0dHIsIChvcCwgWywgbmFtZSwgdmFsdWUsIG5hbWVzcGFjZV0pID0+IHtcbiAgZXhwcihvcCwgdmFsdWUpO1xuICBvcChPcC5Db21wb25lbnRBdHRyLCBpbmZsYXRlQXR0ck5hbWUobmFtZSksIGZhbHNlLCBuYW1lc3BhY2UgPz8gbnVsbCk7XG59KTtcblxuU1RBVEVNRU5UUy5hZGQoU2V4cE9wY29kZXMuVHJ1c3RpbmdDb21wb25lbnRBdHRyLCAob3AsIFssIG5hbWUsIHZhbHVlLCBuYW1lc3BhY2VdKSA9PiB7XG4gIGV4cHIob3AsIHZhbHVlKTtcbiAgb3AoT3AuQ29tcG9uZW50QXR0ciwgaW5mbGF0ZUF0dHJOYW1lKG5hbWUpLCB0cnVlLCBuYW1lc3BhY2UgPz8gbnVsbCk7XG59KTtcblxuU1RBVEVNRU5UUy5hZGQoU2V4cE9wY29kZXMuT3BlbkVsZW1lbnQsIChvcCwgWywgdGFnXSkgPT4ge1xuICBvcChPcC5PcGVuRWxlbWVudCwgaW5mbGF0ZVRhZ05hbWUodGFnKSk7XG59KTtcblxuU1RBVEVNRU5UUy5hZGQoU2V4cE9wY29kZXMuT3BlbkVsZW1lbnRXaXRoU3BsYXQsIChvcCwgWywgdGFnXSkgPT4ge1xuICBvcChPcC5QdXRDb21wb25lbnRPcGVyYXRpb25zKTtcbiAgb3AoT3AuT3BlbkVsZW1lbnQsIGluZmxhdGVUYWdOYW1lKHRhZykpO1xufSk7XG5cblNUQVRFTUVOVFMuYWRkKFNleHBPcGNvZGVzLkNvbXBvbmVudCwgKG9wLCBbLCBleHByLCBlbGVtZW50QmxvY2ssIG5hbWVkLCBibG9ja3NdKSA9PiB7XG4gIGlmIChpc0dldEZyZWVDb21wb25lbnQoZXhwcikpIHtcbiAgICBvcChIaWdoTGV2ZWxSZXNvbHV0aW9uT3Bjb2RlLlJlc29sdmVDb21wb25lbnQsIGV4cHIsIChjb21wb25lbnQ6IENvbXBpbGVUaW1lQ29tcG9uZW50KSA9PiB7XG4gICAgICBJbnZva2VDb21wb25lbnQob3AsIGNvbXBvbmVudCwgZWxlbWVudEJsb2NrLCBudWxsLCBuYW1lZCwgYmxvY2tzKTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICAvLyBvdGhlcndpc2UsIHRoZSBjb21wb25lbnQgbmFtZSB3YXMgYW4gZXhwcmVzc2lvbiwgc28gcmVzb2x2ZSB0aGUgZXhwcmVzc2lvblxuICAgIC8vIGFuZCBpbnZva2UgaXQgYXMgYSBkeW5hbWljIGNvbXBvbmVudFxuICAgIEludm9rZUR5bmFtaWNDb21wb25lbnQob3AsIGV4cHIsIGVsZW1lbnRCbG9jaywgbnVsbCwgbmFtZWQsIGJsb2NrcywgdHJ1ZSwgdHJ1ZSk7XG4gIH1cbn0pO1xuXG5TVEFURU1FTlRTLmFkZChTZXhwT3Bjb2Rlcy5ZaWVsZCwgKG9wLCBbLCB0bywgcGFyYW1zXSkgPT4gWWllbGRCbG9jayhvcCwgdG8sIHBhcmFtcykpO1xuXG5TVEFURU1FTlRTLmFkZChTZXhwT3Bjb2Rlcy5BdHRyU3BsYXQsIChvcCwgWywgdG9dKSA9PiBZaWVsZEJsb2NrKG9wLCB0bywgbnVsbCkpO1xuXG5TVEFURU1FTlRTLmFkZChTZXhwT3Bjb2Rlcy5EZWJ1Z2dlciwgKG9wLCBbLCBldmFsSW5mb10pID0+XG4gIG9wKE9wLkRlYnVnZ2VyLCBldmFsU3ltYm9sc09wZXJhbmQoKSwgZXZhbEluZm8pXG4pO1xuXG5TVEFURU1FTlRTLmFkZChTZXhwT3Bjb2Rlcy5BcHBlbmQsIChvcCwgWywgdmFsdWVdKSA9PiB7XG4gIC8vIFNwZWNpYWwgY2FzZSBmb3Igc3RhdGljIHZhbHVlc1xuICBpZiAoIUFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgb3AoT3AuVGV4dCwgdmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCA/ICcnIDogU3RyaW5nKHZhbHVlKSk7XG4gIH0gZWxzZSBpZiAoaXNHZXRGcmVlT3B0aW9uYWxDb21wb25lbnRPckhlbHBlcih2YWx1ZSkpIHtcbiAgICBvcChIaWdoTGV2ZWxSZXNvbHV0aW9uT3Bjb2RlLlJlc29sdmVPcHRpb25hbENvbXBvbmVudE9ySGVscGVyLCB2YWx1ZSwge1xuICAgICAgaWZDb21wb25lbnQoY29tcG9uZW50OiBDb21waWxlVGltZUNvbXBvbmVudCkge1xuICAgICAgICBJbnZva2VDb21wb25lbnQob3AsIGNvbXBvbmVudCwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCk7XG4gICAgICB9LFxuXG4gICAgICBpZkhlbHBlcihoYW5kbGU6IG51bWJlcikge1xuICAgICAgICBvcChNYWNoaW5lT3AuUHVzaEZyYW1lKTtcbiAgICAgICAgQ2FsbChvcCwgaGFuZGxlLCBudWxsLCBudWxsKTtcbiAgICAgICAgb3AoTWFjaGluZU9wLkludm9rZVN0YXRpYywgc3RkbGliT3BlcmFuZCgnY2F1dGlvdXMtbm9uLWR5bmFtaWMtYXBwZW5kJykpO1xuICAgICAgICBvcChNYWNoaW5lT3AuUG9wRnJhbWUpO1xuICAgICAgfSxcblxuICAgICAgaWZWYWx1ZShoYW5kbGU6IG51bWJlcikge1xuICAgICAgICBvcChNYWNoaW5lT3AuUHVzaEZyYW1lKTtcbiAgICAgICAgb3AoT3AuQ29uc3RhbnRSZWZlcmVuY2UsIGhhbmRsZSk7XG4gICAgICAgIG9wKE1hY2hpbmVPcC5JbnZva2VTdGF0aWMsIHN0ZGxpYk9wZXJhbmQoJ2NhdXRpb3VzLW5vbi1keW5hbWljLWFwcGVuZCcpKTtcbiAgICAgICAgb3AoTWFjaGluZU9wLlBvcEZyYW1lKTtcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0gZWxzZSBpZiAodmFsdWVbMF0gPT09IFNleHBPcGNvZGVzLkNhbGwpIHtcbiAgICBsZXQgWywgZXhwcmVzc2lvbiwgcG9zaXRpb25hbCwgbmFtZWRdID0gdmFsdWU7XG5cbiAgICBpZiAoaXNHZXRGcmVlQ29tcG9uZW50T3JIZWxwZXIoZXhwcmVzc2lvbikpIHtcbiAgICAgIG9wKEhpZ2hMZXZlbFJlc29sdXRpb25PcGNvZGUuUmVzb2x2ZUNvbXBvbmVudE9ySGVscGVyLCBleHByZXNzaW9uLCB7XG4gICAgICAgIGlmQ29tcG9uZW50KGNvbXBvbmVudDogQ29tcGlsZVRpbWVDb21wb25lbnQpIHtcbiAgICAgICAgICBJbnZva2VDb21wb25lbnQob3AsIGNvbXBvbmVudCwgbnVsbCwgcG9zaXRpb25hbCwgaGFzaFRvQXJncyhuYW1lZCksIG51bGwpO1xuICAgICAgICB9LFxuICAgICAgICBpZkhlbHBlcihoYW5kbGU6IG51bWJlcikge1xuICAgICAgICAgIG9wKE1hY2hpbmVPcC5QdXNoRnJhbWUpO1xuICAgICAgICAgIENhbGwob3AsIGhhbmRsZSwgcG9zaXRpb25hbCwgbmFtZWQpO1xuICAgICAgICAgIG9wKE1hY2hpbmVPcC5JbnZva2VTdGF0aWMsIHN0ZGxpYk9wZXJhbmQoJ2NhdXRpb3VzLW5vbi1keW5hbWljLWFwcGVuZCcpKTtcbiAgICAgICAgICBvcChNYWNoaW5lT3AuUG9wRnJhbWUpO1xuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIFN3aXRjaENhc2VzKFxuICAgICAgICBvcCxcbiAgICAgICAgKCkgPT4ge1xuICAgICAgICAgIGV4cHIob3AsIGV4cHJlc3Npb24pO1xuICAgICAgICAgIG9wKE9wLkR5bmFtaWNDb250ZW50VHlwZSk7XG4gICAgICAgIH0sXG4gICAgICAgICh3aGVuKSA9PiB7XG4gICAgICAgICAgd2hlbihDb250ZW50VHlwZS5Db21wb25lbnQsICgpID0+IHtcbiAgICAgICAgICAgIG9wKE9wLlJlc29sdmVDdXJyaWVkQ29tcG9uZW50KTtcbiAgICAgICAgICAgIG9wKE9wLlB1c2hEeW5hbWljQ29tcG9uZW50SW5zdGFuY2UpO1xuICAgICAgICAgICAgSW52b2tlTm9uU3RhdGljQ29tcG9uZW50KG9wLCB7XG4gICAgICAgICAgICAgIGNhcGFiaWxpdGllczogdHJ1ZSxcbiAgICAgICAgICAgICAgZWxlbWVudEJsb2NrOiBudWxsLFxuICAgICAgICAgICAgICBwb3NpdGlvbmFsLFxuICAgICAgICAgICAgICBuYW1lZCxcbiAgICAgICAgICAgICAgYXROYW1lczogZmFsc2UsXG4gICAgICAgICAgICAgIGJsb2NrczogbmFtZWRCbG9ja3MobnVsbCksXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHdoZW4oQ29udGVudFR5cGUuSGVscGVyLCAoKSA9PiB7XG4gICAgICAgICAgICBDYWxsRHluYW1pYyhvcCwgcG9zaXRpb25hbCwgbmFtZWQsICgpID0+IHtcbiAgICAgICAgICAgICAgb3AoTWFjaGluZU9wLkludm9rZVN0YXRpYywgc3RkbGliT3BlcmFuZCgnY2F1dGlvdXMtbm9uLWR5bmFtaWMtYXBwZW5kJykpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIG9wKE1hY2hpbmVPcC5QdXNoRnJhbWUpO1xuICAgIGV4cHIob3AsIHZhbHVlKTtcbiAgICBvcChNYWNoaW5lT3AuSW52b2tlU3RhdGljLCBzdGRsaWJPcGVyYW5kKCdjYXV0aW91cy1hcHBlbmQnKSk7XG4gICAgb3AoTWFjaGluZU9wLlBvcEZyYW1lKTtcbiAgfVxufSk7XG5cblNUQVRFTUVOVFMuYWRkKFNleHBPcGNvZGVzLlRydXN0aW5nQXBwZW5kLCAob3AsIFssIHZhbHVlXSkgPT4ge1xuICBpZiAoIUFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgb3AoT3AuVGV4dCwgdmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCA/ICcnIDogU3RyaW5nKHZhbHVlKSk7XG4gIH0gZWxzZSB7XG4gICAgb3AoTWFjaGluZU9wLlB1c2hGcmFtZSk7XG4gICAgZXhwcihvcCwgdmFsdWUpO1xuICAgIG9wKE1hY2hpbmVPcC5JbnZva2VTdGF0aWMsIHN0ZGxpYk9wZXJhbmQoJ3RydXN0aW5nLWFwcGVuZCcpKTtcbiAgICBvcChNYWNoaW5lT3AuUG9wRnJhbWUpO1xuICB9XG59KTtcblxuU1RBVEVNRU5UUy5hZGQoU2V4cE9wY29kZXMuQmxvY2ssIChvcCwgWywgZXhwciwgcG9zaXRpb25hbCwgbmFtZWQsIGJsb2Nrc10pID0+IHtcbiAgaWYgKGlzR2V0RnJlZUNvbXBvbmVudChleHByKSkge1xuICAgIG9wKEhpZ2hMZXZlbFJlc29sdXRpb25PcGNvZGUuUmVzb2x2ZUNvbXBvbmVudCwgZXhwciwgKGNvbXBvbmVudDogQ29tcGlsZVRpbWVDb21wb25lbnQpID0+IHtcbiAgICAgIEludm9rZUNvbXBvbmVudChvcCwgY29tcG9uZW50LCBudWxsLCBwb3NpdGlvbmFsLCBoYXNoVG9BcmdzKG5hbWVkKSwgYmxvY2tzKTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBJbnZva2VEeW5hbWljQ29tcG9uZW50KG9wLCBleHByLCBudWxsLCBwb3NpdGlvbmFsLCBuYW1lZCwgYmxvY2tzLCBmYWxzZSwgZmFsc2UpO1xuICB9XG59KTtcblxuU1RBVEVNRU5UUy5hZGQoU2V4cE9wY29kZXMuSW5FbGVtZW50LCAob3AsIFssIGJsb2NrLCBndWlkLCBkZXN0aW5hdGlvbiwgaW5zZXJ0QmVmb3JlXSkgPT4ge1xuICBSZXBsYXlhYmxlSWYoXG4gICAgb3AsXG5cbiAgICAoKSA9PiB7XG4gICAgICBleHByKG9wLCBndWlkKTtcblxuICAgICAgaWYgKGluc2VydEJlZm9yZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIFB1c2hQcmltaXRpdmVSZWZlcmVuY2Uob3AsIHVuZGVmaW5lZCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBleHByKG9wLCBpbnNlcnRCZWZvcmUpO1xuICAgICAgfVxuXG4gICAgICBleHByKG9wLCBkZXN0aW5hdGlvbik7XG4gICAgICBvcChPcC5EdXAsICRzcCwgMCk7XG5cbiAgICAgIHJldHVybiA0O1xuICAgIH0sXG5cbiAgICAoKSA9PiB7XG4gICAgICBvcChPcC5QdXNoUmVtb3RlRWxlbWVudCk7XG4gICAgICBJbnZva2VTdGF0aWNCbG9jayhvcCwgYmxvY2spO1xuICAgICAgb3AoT3AuUG9wUmVtb3RlRWxlbWVudCk7XG4gICAgfVxuICApO1xufSk7XG5cblNUQVRFTUVOVFMuYWRkKFNleHBPcGNvZGVzLklmLCAob3AsIFssIGNvbmRpdGlvbiwgYmxvY2ssIGludmVyc2VdKSA9PlxuICBSZXBsYXlhYmxlSWYoXG4gICAgb3AsXG4gICAgKCkgPT4ge1xuICAgICAgZXhwcihvcCwgY29uZGl0aW9uKTtcbiAgICAgIG9wKE9wLlRvQm9vbGVhbik7XG5cbiAgICAgIHJldHVybiAxO1xuICAgIH0sXG5cbiAgICAoKSA9PiB7XG4gICAgICBJbnZva2VTdGF0aWNCbG9jayhvcCwgYmxvY2spO1xuICAgIH0sXG5cbiAgICBpbnZlcnNlXG4gICAgICA/ICgpID0+IHtcbiAgICAgICAgICBJbnZva2VTdGF0aWNCbG9jayhvcCwgaW52ZXJzZSk7XG4gICAgICAgIH1cbiAgICAgIDogdW5kZWZpbmVkXG4gIClcbik7XG5cblNUQVRFTUVOVFMuYWRkKFNleHBPcGNvZGVzLkVhY2gsIChvcCwgWywgdmFsdWUsIGtleSwgYmxvY2ssIGludmVyc2VdKSA9PlxuICBSZXBsYXlhYmxlKFxuICAgIG9wLFxuXG4gICAgKCkgPT4ge1xuICAgICAgaWYgKGtleSkge1xuICAgICAgICBleHByKG9wLCBrZXkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgUHVzaFByaW1pdGl2ZVJlZmVyZW5jZShvcCwgbnVsbCk7XG4gICAgICB9XG5cbiAgICAgIGV4cHIob3AsIHZhbHVlKTtcblxuICAgICAgcmV0dXJuIDI7XG4gICAgfSxcblxuICAgICgpID0+IHtcbiAgICAgIG9wKE9wLkVudGVyTGlzdCwgbGFiZWxPcGVyYW5kKCdCT0RZJyksIGxhYmVsT3BlcmFuZCgnRUxTRScpKTtcbiAgICAgIG9wKE1hY2hpbmVPcC5QdXNoRnJhbWUpO1xuICAgICAgb3AoT3AuRHVwLCAkZnAsIDEpO1xuICAgICAgb3AoTWFjaGluZU9wLlJldHVyblRvLCBsYWJlbE9wZXJhbmQoJ0lURVInKSk7XG4gICAgICBvcChIaWdoTGV2ZWxCdWlsZGVyT3Bjb2RlLkxhYmVsLCAnSVRFUicpO1xuICAgICAgb3AoT3AuSXRlcmF0ZSwgbGFiZWxPcGVyYW5kKCdCUkVBSycpKTtcbiAgICAgIG9wKEhpZ2hMZXZlbEJ1aWxkZXJPcGNvZGUuTGFiZWwsICdCT0RZJyk7XG4gICAgICBJbnZva2VTdGF0aWNCbG9ja1dpdGhTdGFjayhvcCwgYmxvY2ssIDIpO1xuICAgICAgb3AoT3AuUG9wLCAyKTtcbiAgICAgIG9wKE1hY2hpbmVPcC5KdW1wLCBsYWJlbE9wZXJhbmQoJ0ZJTkFMTFknKSk7XG4gICAgICBvcChIaWdoTGV2ZWxCdWlsZGVyT3Bjb2RlLkxhYmVsLCAnQlJFQUsnKTtcbiAgICAgIG9wKE1hY2hpbmVPcC5Qb3BGcmFtZSk7XG4gICAgICBvcChPcC5FeGl0TGlzdCk7XG4gICAgICBvcChNYWNoaW5lT3AuSnVtcCwgbGFiZWxPcGVyYW5kKCdGSU5BTExZJykpO1xuICAgICAgb3AoSGlnaExldmVsQnVpbGRlck9wY29kZS5MYWJlbCwgJ0VMU0UnKTtcblxuICAgICAgaWYgKGludmVyc2UpIHtcbiAgICAgICAgSW52b2tlU3RhdGljQmxvY2sob3AsIGludmVyc2UpO1xuICAgICAgfVxuICAgIH1cbiAgKVxuKTtcblxuU1RBVEVNRU5UUy5hZGQoU2V4cE9wY29kZXMuV2l0aCwgKG9wLCBbLCB2YWx1ZSwgYmxvY2ssIGludmVyc2VdKSA9PiB7XG4gIFJlcGxheWFibGVJZihcbiAgICBvcCxcblxuICAgICgpID0+IHtcbiAgICAgIGV4cHIob3AsIHZhbHVlKTtcbiAgICAgIG9wKE9wLkR1cCwgJHNwLCAwKTtcbiAgICAgIG9wKE9wLlRvQm9vbGVhbik7XG5cbiAgICAgIHJldHVybiAyO1xuICAgIH0sXG5cbiAgICAoKSA9PiB7XG4gICAgICBJbnZva2VTdGF0aWNCbG9ja1dpdGhTdGFjayhvcCwgYmxvY2ssIDEpO1xuICAgIH0sXG5cbiAgICAoKSA9PiB7XG4gICAgICBpZiAoaW52ZXJzZSkge1xuICAgICAgICBJbnZva2VTdGF0aWNCbG9jayhvcCwgaW52ZXJzZSk7XG4gICAgICB9XG4gICAgfVxuICApO1xufSk7XG5cblNUQVRFTUVOVFMuYWRkKFNleHBPcGNvZGVzLkxldCwgKG9wLCBbLCBwb3NpdGlvbmFsLCBibG9ja10pID0+IHtcbiAgbGV0IGNvdW50ID0gQ29tcGlsZVBvc2l0aW9uYWwob3AsIHBvc2l0aW9uYWwpO1xuICBJbnZva2VTdGF0aWNCbG9ja1dpdGhTdGFjayhvcCwgYmxvY2ssIGNvdW50KTtcbn0pO1xuXG5TVEFURU1FTlRTLmFkZChTZXhwT3Bjb2Rlcy5XaXRoRHluYW1pY1ZhcnMsIChvcCwgWywgbmFtZWQsIGJsb2NrXSkgPT4ge1xuICBpZiAobmFtZWQpIHtcbiAgICBsZXQgW25hbWVzLCBleHByZXNzaW9uc10gPSBuYW1lZDtcblxuICAgIENvbXBpbGVQb3NpdGlvbmFsKG9wLCBleHByZXNzaW9ucyk7XG4gICAgRHluYW1pY1Njb3BlKG9wLCBuYW1lcywgKCkgPT4ge1xuICAgICAgSW52b2tlU3RhdGljQmxvY2sob3AsIGJsb2NrKTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBJbnZva2VTdGF0aWNCbG9jayhvcCwgYmxvY2spO1xuICB9XG59KTtcblxuU1RBVEVNRU5UUy5hZGQoU2V4cE9wY29kZXMuSW52b2tlQ29tcG9uZW50LCAob3AsIFssIGV4cHIsIHBvc2l0aW9uYWwsIG5hbWVkLCBibG9ja3NdKSA9PiB7XG4gIGlmIChpc0dldEZyZWVDb21wb25lbnQoZXhwcikpIHtcbiAgICBvcChIaWdoTGV2ZWxSZXNvbHV0aW9uT3Bjb2RlLlJlc29sdmVDb21wb25lbnQsIGV4cHIsIChjb21wb25lbnQ6IENvbXBpbGVUaW1lQ29tcG9uZW50KSA9PiB7XG4gICAgICBJbnZva2VDb21wb25lbnQob3AsIGNvbXBvbmVudCwgbnVsbCwgcG9zaXRpb25hbCwgaGFzaFRvQXJncyhuYW1lZCksIGJsb2Nrcyk7XG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgSW52b2tlRHluYW1pY0NvbXBvbmVudChvcCwgZXhwciwgbnVsbCwgcG9zaXRpb25hbCwgbmFtZWQsIGJsb2NrcywgZmFsc2UsIGZhbHNlKTtcbiAgfVxufSk7XG5cbmZ1bmN0aW9uIGhhc2hUb0FyZ3MoaGFzaDogV2lyZUZvcm1hdC5Db3JlLkhhc2ggfCBudWxsKTogV2lyZUZvcm1hdC5Db3JlLkhhc2ggfCBudWxsIHtcbiAgaWYgKGhhc2ggPT09IG51bGwpIHJldHVybiBudWxsO1xuICBsZXQgbmFtZXMgPSBoYXNoWzBdLm1hcCgoa2V5KSA9PiBgQCR7a2V5fWApO1xuICByZXR1cm4gW25hbWVzIGFzIFtzdHJpbmcsIC4uLnN0cmluZ1tdXSwgaGFzaFsxXV07XG59XG4iXSwic291cmNlUm9vdCI6IiJ9